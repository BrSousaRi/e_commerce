[0m14:13:16.194207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022346E4EFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022346B439E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022346B42570>]}


============================== 14:13:16.211796 | c7ba3fdf-0db6-49f8-8cd4-a8bb9c1d52f8 ==============================
[0m14:13:16.211796 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:13:16.213318 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --models dim_customers', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt'}
[0m14:13:16.214319 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:13:16.217319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c7ba3fdf-0db6-49f8-8cd4-a8bb9c1d52f8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223476F9760>]}
[0m14:13:16.220330 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  C:\Users\p-rsousa\Documents\Nova pasta\dbt/profiles.yml
  
[0m14:13:16.227371 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:13:16.291425 [debug] [MainThread]: Command `dbt run` failed at 14:13:16.291425 after 0.63 seconds
[0m14:13:16.292434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223471F1F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022346B70B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223476F9970>]}
[0m14:13:16.293574 [debug] [MainThread]: Flushing usage events
[0m14:13:16.851242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:11.706721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002076CC2FF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002076CB6DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020769528CB0>]}


============================== 14:18:11.715243 | fa75d609-b17d-41a2-b386-46aba0dc0b39 ==============================
[0m14:18:11.715243 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:18:11.715243 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:18:11.789666 [info ] [MainThread]: dbt version: 1.10.11
[0m14:18:11.793667 [info ] [MainThread]: python version: 3.12.8
[0m14:18:11.794664 [info ] [MainThread]: python path: C:\Users\p-rsousa\AppData\Local\Programs\Python\Python312\python.exe
[0m14:18:11.796663 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:18:11.956843 [info ] [MainThread]: Using profiles dir at C:\Users\p-rsousa\Documents\Nova pasta\dbt
[0m14:18:11.956843 [info ] [MainThread]: Using profiles.yml file at C:\Users\p-rsousa\Documents\Nova pasta\dbt\profiles.yml
[0m14:18:11.962234 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\p-rsousa\Documents\Nova pasta\dbt\dbt_project.yml
[0m14:18:11.963233 [info ] [MainThread]: adapter type: postgres
[0m14:18:11.963233 [info ] [MainThread]: adapter version: 1.9.1
[0m14:18:12.235651 [info ] [MainThread]: Configuration:
[0m14:18:12.235651 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:18:12.235651 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:18:12.235651 [info ] [MainThread]: Required dependencies:
[0m14:18:12.235651 [debug] [MainThread]: Executing "git --help"
[0m14:18:12.612320 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:18:12.612320 [debug] [MainThread]: STDERR: "b''"
[0m14:18:12.612320 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:18:12.618830 [info ] [MainThread]: Connection:
[0m14:18:12.621851 [info ] [MainThread]:   host: localhost
[0m14:18:12.625191 [info ] [MainThread]:   port: 5433
[0m14:18:12.626841 [info ] [MainThread]:   user: dbt
[0m14:18:12.630107 [info ] [MainThread]:   database: warehouse
[0m14:18:12.631615 [info ] [MainThread]:   schema: public
[0m14:18:12.632868 [info ] [MainThread]:   connect_timeout: 10
[0m14:18:12.633809 [info ] [MainThread]:   role: None
[0m14:18:12.634587 [info ] [MainThread]:   search_path: None
[0m14:18:12.635516 [info ] [MainThread]:   keepalives_idle: 0
[0m14:18:12.636520 [info ] [MainThread]:   sslmode: None
[0m14:18:12.637435 [info ] [MainThread]:   sslcert: None
[0m14:18:12.640510 [info ] [MainThread]:   sslkey: None
[0m14:18:12.641652 [info ] [MainThread]:   sslrootcert: None
[0m14:18:12.642956 [info ] [MainThread]:   application_name: dbt
[0m14:18:12.643534 [info ] [MainThread]:   retries: 1
[0m14:18:12.645004 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:18:13.111587 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:18:13.458006 [debug] [MainThread]: Using postgres connection "debug"
[0m14:18:13.458006 [debug] [MainThread]: On debug: select 1 as id
[0m14:18:13.458006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:13.488225 [debug] [MainThread]: SQL status: SELECT 1 in 0.032 seconds
[0m14:18:13.488225 [debug] [MainThread]: On debug: Close
[0m14:18:13.488225 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:18:13.488225 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:18:13.498757 [debug] [MainThread]: Command `dbt debug` succeeded at 14:18:13.498757 after 2.04 seconds
[0m14:18:13.499757 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:18:13.499757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002076C5DC3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002076E0F0A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002076CBC58B0>]}
[0m14:18:13.500757 [debug] [MainThread]: Flushing usage events
[0m14:18:13.550445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:28.828851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE74162A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE74167B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE7415F40>]}


============================== 14:18:28.831800 | 5044b712-21d4-4e0f-8494-690c00cbae76 ==============================
[0m14:18:28.831800 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:18:28.839036 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select dim_customers', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m14:18:29.542128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5044b712-21d4-4e0f-8494-690c00cbae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE3044170>]}
[0m14:18:29.781380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5044b712-21d4-4e0f-8494-690c00cbae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE753B290>]}
[0m14:18:29.781380 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:18:30.313314 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:18:30.313314 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:18:30.313314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5044b712-21d4-4e0f-8494-690c00cbae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE78721B0>]}
[0m14:18:32.829039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
[0m14:18:32.849119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5044b712-21d4-4e0f-8494-690c00cbae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE5BF13A0>]}
[0m14:18:32.933431 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m14:18:32.936431 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m14:18:32.973644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5044b712-21d4-4e0f-8494-690c00cbae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE7B78140>]}
[0m14:18:32.973644 [info ] [MainThread]: Found 1 model, 6 sources, 434 macros
[0m14:18:32.973644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5044b712-21d4-4e0f-8494-690c00cbae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE7E5D160>]}
[0m14:18:32.973644 [info ] [MainThread]: 
[0m14:18:32.973644 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:18:32.973644 [info ] [MainThread]: 
[0m14:18:32.984415 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:18:32.987095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:18:33.152298 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:18:33.152298 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:18:33.152298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:33.182220 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.023 seconds
[0m14:18:33.183290 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:18:33.183290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m14:18:33.192424 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:18:33.192962 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m14:18:33.192962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:33.202546 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:18:33.202546 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:18:33.202546 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:18:33.202546 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m14:18:33.212994 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m14:18:33.214994 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m14:18:33.222995 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:33.222995 [debug] [MainThread]: On master: BEGIN
[0m14:18:33.223996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:33.233656 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m14:18:33.233656 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:33.233656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:18:33.233656 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m14:18:33.244263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5044b712-21d4-4e0f-8494-690c00cbae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE74B7710>]}
[0m14:18:33.244263 [debug] [MainThread]: On master: ROLLBACK
[0m14:18:33.244263 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:33.244263 [debug] [MainThread]: On master: BEGIN
[0m14:18:33.244263 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:18:33.244263 [debug] [MainThread]: On master: COMMIT
[0m14:18:33.244263 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:33.244263 [debug] [MainThread]: On master: COMMIT
[0m14:18:33.244263 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:18:33.244263 [debug] [MainThread]: On master: Close
[0m14:18:33.253846 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.dim_customers
[0m14:18:33.253846 [info ] [Thread-1 (]: 1 of 1 START sql table model public.dim_customers .............................. [RUN]
[0m14:18:33.253846 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.dim_customers'
[0m14:18:33.253846 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.dim_customers
[0m14:18:33.264633 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.dim_customers"
[0m14:18:33.264633 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.dim_customers
[0m14:18:33.323897 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.dim_customers"
[0m14:18:33.325898 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:18:33.325898 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: BEGIN
[0m14:18:33.326897 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:18:33.341551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:18:33.342579 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:18:33.342579 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */

  
    

  create  table "warehouse"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT * FROM "warehouse"."public"."olist_customers_dataset"
  );
  
[0m14:18:33.492810 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.149 seconds
[0m14:18:33.515328 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:18:33.523505 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
alter table "warehouse"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:18:33.523505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:18:33.584747 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m14:18:33.585890 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:18:33.586888 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m14:18:33.622961 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m14:18:33.637274 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."dim_customers__dbt_backup"
[0m14:18:33.646948 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:18:33.647463 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
drop table if exists "warehouse"."public"."dim_customers__dbt_backup" cascade
[0m14:18:33.649339 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:18:33.652469 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: Close
[0m14:18:33.657140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5044b712-21d4-4e0f-8494-690c00cbae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE74B7710>]}
[0m14:18:33.658734 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.dim_customers ......................... [[32mSELECT 99441[0m in 0.40s]
[0m14:18:33.658734 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.dim_customers
[0m14:18:33.658734 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:33.658734 [debug] [MainThread]: On master: BEGIN
[0m14:18:33.658734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:33.683901 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m14:18:33.683901 [debug] [MainThread]: On master: COMMIT
[0m14:18:33.683901 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:33.684902 [debug] [MainThread]: On master: COMMIT
[0m14:18:33.685902 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:18:33.685902 [debug] [MainThread]: On master: Close
[0m14:18:33.687904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:33.687904 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m14:18:33.688906 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m14:18:33.689907 [debug] [MainThread]: Connection 'model.olist_ecommerce.dim_customers' was properly closed.
[0m14:18:33.690901 [info ] [MainThread]: 
[0m14:18:33.690901 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m14:18:33.692899 [debug] [MainThread]: Command end result
[0m14:18:33.731015 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m14:18:33.734209 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m14:18:33.768996 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m14:18:33.768996 [info ] [MainThread]: 
[0m14:18:33.771720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:33.773719 [info ] [MainThread]: 
[0m14:18:33.774717 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:18:33.778734 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:33.777720 after 5.18 seconds
[0m14:18:33.779736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE559CA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE7B78140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE55F8410>]}
[0m14:18:33.780720 [debug] [MainThread]: Flushing usage events
[0m14:18:33.814831 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:15.555803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F2F0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3610E4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F1E3EF0>]}


============================== 14:20:15.565676 | efd925a6-ade6-426c-aeac-b2ad0b6afd74 ==============================
[0m14:20:15.565676 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:20:15.565676 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --models dim_customers', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m14:20:15.565676 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:20:15.575684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'efd925a6-ade6-426c-aeac-b2ad0b6afd74', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F85B230>]}
[0m14:20:16.239551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efd925a6-ade6-426c-aeac-b2ad0b6afd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3614117F0>]}
[0m14:20:16.415701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efd925a6-ade6-426c-aeac-b2ad0b6afd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35FE69DF0>]}
[0m14:20:16.415701 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:20:16.901179 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:20:17.146631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:17.146631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:17.146631 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m14:20:17.186678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efd925a6-ade6-426c-aeac-b2ad0b6afd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3613EB5F0>]}
[0m14:20:17.273129 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m14:20:17.279208 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m14:20:17.311686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efd925a6-ade6-426c-aeac-b2ad0b6afd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C361800320>]}
[0m14:20:17.311686 [info ] [MainThread]: Found 1 model, 6 sources, 434 macros
[0m14:20:17.311686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efd925a6-ade6-426c-aeac-b2ad0b6afd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C36180B110>]}
[0m14:20:17.311686 [info ] [MainThread]: 
[0m14:20:17.311686 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:17.319748 [info ] [MainThread]: 
[0m14:20:17.321575 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:20:17.323670 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:20:17.500700 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:20:17.500700 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:20:17.500700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:17.521459 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m14:20:17.521459 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:20:17.529392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m14:20:17.531454 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:20:17.531454 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m14:20:17.531454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:17.552189 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:20:17.552189 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:20:17.552189 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:20:17.552189 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m14:20:17.552189 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m14:20:17.552189 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m14:20:17.562890 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:17.562890 [debug] [MainThread]: On master: BEGIN
[0m14:20:17.569027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:17.583460 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m14:20:17.583460 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:17.583460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:20:17.583460 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m14:20:17.583460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efd925a6-ade6-426c-aeac-b2ad0b6afd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C361096210>]}
[0m14:20:17.583460 [debug] [MainThread]: On master: ROLLBACK
[0m14:20:17.583460 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:17.583460 [debug] [MainThread]: On master: BEGIN
[0m14:20:17.593560 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:20:17.593560 [debug] [MainThread]: On master: COMMIT
[0m14:20:17.593560 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:17.593560 [debug] [MainThread]: On master: COMMIT
[0m14:20:17.593560 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:20:17.593560 [debug] [MainThread]: On master: Close
[0m14:20:17.593560 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.dim_customers
[0m14:20:17.593560 [info ] [Thread-1 (]: 1 of 1 START sql table model public.dim_customers .............................. [RUN]
[0m14:20:17.604787 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.dim_customers'
[0m14:20:17.604787 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.dim_customers
[0m14:20:17.613786 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.dim_customers"
[0m14:20:17.614787 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.dim_customers
[0m14:20:17.680297 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.dim_customers"
[0m14:20:17.681896 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:20:17.681896 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: BEGIN
[0m14:20:17.682922 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:20:17.690467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:20:17.690467 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:20:17.690467 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */

  
    

  create  table "warehouse"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT * FROM "warehouse"."public"."olist_customers_dataset"
  );
  
[0m14:20:17.811498 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.115 seconds
[0m14:20:17.827636 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:20:17.827636 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
alter table "warehouse"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:20:17.827636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:20:17.841178 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:20:17.841178 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
alter table "warehouse"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:20:17.847351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:20:17.887277 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m14:20:17.887277 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:20:17.889302 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m14:20:17.929363 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m14:20:17.947709 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."dim_customers__dbt_backup"
[0m14:20:17.959831 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:20:17.960826 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
drop table if exists "warehouse"."public"."dim_customers__dbt_backup" cascade
[0m14:20:17.965692 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:20:17.969284 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: Close
[0m14:20:17.969284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efd925a6-ade6-426c-aeac-b2ad0b6afd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35F1A49E0>]}
[0m14:20:17.969284 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.dim_customers ......................... [[32mSELECT 99441[0m in 0.37s]
[0m14:20:17.969284 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.dim_customers
[0m14:20:17.969284 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:17.979342 [debug] [MainThread]: On master: BEGIN
[0m14:20:17.979342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:20:17.991259 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m14:20:17.998783 [debug] [MainThread]: On master: COMMIT
[0m14:20:17.999791 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:18.000189 [debug] [MainThread]: On master: COMMIT
[0m14:20:18.002108 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:20:18.002108 [debug] [MainThread]: On master: Close
[0m14:20:18.002108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:18.002108 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m14:20:18.002108 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m14:20:18.002108 [debug] [MainThread]: Connection 'model.olist_ecommerce.dim_customers' was properly closed.
[0m14:20:18.002108 [info ] [MainThread]: 
[0m14:20:18.002108 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m14:20:18.002108 [debug] [MainThread]: Command end result
[0m14:20:18.022463 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m14:20:18.022463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m14:20:18.043858 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m14:20:18.044860 [info ] [MainThread]: 
[0m14:20:18.044860 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:18.045860 [info ] [MainThread]: 
[0m14:20:18.045860 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:20:18.046859 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:20:18.049566 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:18.049566 after 2.70 seconds
[0m14:20:18.050566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35FF01BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35CA423C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3610E45C0>]}
[0m14:20:18.051566 [debug] [MainThread]: Flushing usage events
[0m14:20:18.184080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:33.531151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C28D7260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C4EEA870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C2CAF9E0>]}


============================== 14:22:33.536277 | 68f75aad-766e-4003-bc22-5acead9b8a98 ==============================
[0m14:22:33.536277 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:22:33.537383 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select silver', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt'}
[0m14:22:34.644289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68f75aad-766e-4003-bc22-5acead9b8a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C6EE4680>]}
[0m14:22:34.935694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68f75aad-766e-4003-bc22-5acead9b8a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C57D4140>]}
[0m14:22:34.938698 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:22:35.572471 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:22:35.802406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:22:35.803408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:22:35.810405 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m14:22:35.860547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68f75aad-766e-4003-bc22-5acead9b8a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C6E46330>]}
[0m14:22:35.958465 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m14:22:35.961437 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m14:22:35.996282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68f75aad-766e-4003-bc22-5acead9b8a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C75B84A0>]}
[0m14:22:35.997307 [info ] [MainThread]: Found 1 model, 6 sources, 434 macros
[0m14:22:35.997307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68f75aad-766e-4003-bc22-5acead9b8a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C7259430>]}
[0m14:22:35.998309 [warn ] [MainThread]: The selection criterion 'silver' does not match any enabled nodes
[0m14:22:36.000762 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:22:36.007770 [debug] [MainThread]: Command end result
[0m14:22:36.032931 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m14:22:36.039294 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m14:22:36.045319 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m14:22:36.047343 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:36.047343 after 2.84 seconds
[0m14:22:36.047343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C2802600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C4F9D4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C6B19A60>]}
[0m14:22:36.048344 [debug] [MainThread]: Flushing usage events
[0m14:22:36.081327 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:24.225273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001992FA371D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019932659880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019932659970>]}


============================== 14:50:24.234268 | b48c39fa-fff7-4fd6-923a-14201562f520 ==============================
[0m14:50:24.234268 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:50:24.235268 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt ls', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m14:50:24.948491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b48c39fa-fff7-4fd6-923a-14201562f520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019931BE8200>]}
[0m14:50:25.335493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b48c39fa-fff7-4fd6-923a-14201562f520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199340CA810>]}
[0m14:50:25.339803 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:50:26.117452 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:50:26.493759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:26.494759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:26.501757 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
[0m14:50:26.548982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b48c39fa-fff7-4fd6-923a-14201562f520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001993443D880>]}
[0m14:50:26.681601 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m14:50:26.687605 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m14:50:26.781324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b48c39fa-fff7-4fd6-923a-14201562f520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019934769850>]}
[0m14:50:26.782326 [info ] [MainThread]: Found 1 model, 6 sources, 434 macros
[0m14:50:26.783323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b48c39fa-fff7-4fd6-923a-14201562f520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199343E8380>]}
[0m14:50:26.784324 [info ] [MainThread]: olist_ecommerce.02 silver.dim_customers
[0m14:50:26.785321 [info ] [MainThread]: source:olist_ecommerce.raw_data.olist_customers_dataset
[0m14:50:26.786180 [info ] [MainThread]: source:olist_ecommerce.raw_data.olist_order_items_dataset
[0m14:50:26.787183 [info ] [MainThread]: source:olist_ecommerce.raw_data.olist_order_payments_dataset
[0m14:50:26.789320 [info ] [MainThread]: source:olist_ecommerce.raw_data.olist_orders_dataset
[0m14:50:26.789320 [info ] [MainThread]: source:olist_ecommerce.raw_data.olist_products_dataset
[0m14:50:26.790979 [info ] [MainThread]: source:olist_ecommerce.raw_data.product_category_name_translation
[0m14:50:26.791981 [debug] [MainThread]: Command `dbt ls` succeeded at 14:50:26.791981 after 2.87 seconds
[0m14:50:26.792980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019933DE1BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019933B8DCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019933C75E20>]}
[0m14:50:26.792980 [debug] [MainThread]: Flushing usage events
[0m14:50:26.848489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:46.860366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF0FF4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF1A63C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF1A62A80>]}


============================== 14:50:46.860366 | dd52026f-41dc-4fce-bf21-44163e2512f4 ==============================
[0m14:50:46.860366 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:50:46.860366 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select dim_customers', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m14:50:47.384488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd52026f-41dc-4fce-bf21-44163e2512f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF31D1610>]}
[0m14:50:47.575370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd52026f-41dc-4fce-bf21-44163e2512f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF1AD30E0>]}
[0m14:50:47.575370 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:50:48.023553 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:50:48.208067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:48.208067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:48.208067 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
[0m14:50:48.264048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd52026f-41dc-4fce-bf21-44163e2512f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF3621DF0>]}
[0m14:50:48.335157 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m14:50:48.344725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m14:50:48.384865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd52026f-41dc-4fce-bf21-44163e2512f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF37B5820>]}
[0m14:50:48.385865 [info ] [MainThread]: Found 1 model, 6 sources, 434 macros
[0m14:50:48.386866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd52026f-41dc-4fce-bf21-44163e2512f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF394F200>]}
[0m14:50:48.389370 [info ] [MainThread]: 
[0m14:50:48.389442 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:48.390375 [info ] [MainThread]: 
[0m14:50:48.390375 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:48.393294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:50:49.225985 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:50:49.225985 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:50:49.225985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:49.258018 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m14:50:49.267689 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:50:49.272257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m14:50:49.277826 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:50:49.277826 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m14:50:49.277826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:49.290664 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m14:50:49.290664 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m14:50:49.290664 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:50:49.298213 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m14:50:49.298213 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m14:50:49.298213 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m14:50:49.309001 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:49.309001 [debug] [MainThread]: On master: BEGIN
[0m14:50:49.309001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:49.319061 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m14:50:49.319061 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:49.319061 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:50:49.329719 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m14:50:49.329719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd52026f-41dc-4fce-bf21-44163e2512f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF3E3A690>]}
[0m14:50:49.329719 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:49.329719 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:49.329719 [debug] [MainThread]: On master: BEGIN
[0m14:50:49.329719 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:50:49.329719 [debug] [MainThread]: On master: COMMIT
[0m14:50:49.329719 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:49.329719 [debug] [MainThread]: On master: COMMIT
[0m14:50:49.329719 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:50:49.329719 [debug] [MainThread]: On master: Close
[0m14:50:49.339820 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.dim_customers
[0m14:50:49.339820 [info ] [Thread-1 (]: 1 of 1 START sql table model public.dim_customers .............................. [RUN]
[0m14:50:49.349828 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.dim_customers'
[0m14:50:49.350564 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.dim_customers
[0m14:50:49.360151 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.dim_customers"
[0m14:50:49.360151 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.dim_customers
[0m14:50:49.416458 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.dim_customers"
[0m14:50:49.418448 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:50:49.418448 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: BEGIN
[0m14:50:49.419447 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:49.436424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m14:50:49.437424 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:50:49.437424 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */

  
    

  create  table "warehouse"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT * FROM "warehouse"."public"."olist_customers_dataset"
  );
  
[0m14:50:49.515920 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.082 seconds
[0m14:50:49.532637 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:50:49.533639 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
alter table "warehouse"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:50:49.534638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:49.538638 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:50:49.538638 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
alter table "warehouse"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:50:49.540406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:49.559052 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m14:50:49.559574 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:50:49.559574 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m14:50:49.620802 [debug] [Thread-1 (]: SQL status: COMMIT in 0.059 seconds
[0m14:50:49.628802 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."dim_customers__dbt_backup"
[0m14:50:49.634924 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m14:50:49.636022 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
drop table if exists "warehouse"."public"."dim_customers__dbt_backup" cascade
[0m14:50:49.641013 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:50:49.643014 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: Close
[0m14:50:49.648494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd52026f-41dc-4fce-bf21-44163e2512f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF4258BF0>]}
[0m14:50:49.649519 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.dim_customers ......................... [[32mSELECT 99441[0m in 0.30s]
[0m14:50:49.650521 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.dim_customers
[0m14:50:49.651493 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:49.651493 [debug] [MainThread]: On master: BEGIN
[0m14:50:49.652529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:49.662554 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m14:50:49.662554 [debug] [MainThread]: On master: COMMIT
[0m14:50:49.662554 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:49.662554 [debug] [MainThread]: On master: COMMIT
[0m14:50:49.662554 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:50:49.662554 [debug] [MainThread]: On master: Close
[0m14:50:49.662554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:49.662554 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m14:50:49.662554 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m14:50:49.662554 [debug] [MainThread]: Connection 'model.olist_ecommerce.dim_customers' was properly closed.
[0m14:50:49.672341 [info ] [MainThread]: 
[0m14:50:49.673423 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m14:50:49.674975 [debug] [MainThread]: Command end result
[0m14:50:49.694968 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m14:50:49.694968 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m14:50:49.713008 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m14:50:49.714008 [info ] [MainThread]: 
[0m14:50:49.715005 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:49.716008 [info ] [MainThread]: 
[0m14:50:49.716036 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:50:49.716036 [debug] [MainThread]: Command `dbt run` succeeded at 14:50:49.716036 after 3.08 seconds
[0m14:50:49.716036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF1B46540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF1FC9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF1656A80>]}
[0m14:50:49.716036 [debug] [MainThread]: Flushing usage events
[0m14:50:49.734256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:54:31.080772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1A4A86180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1A4A85F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1A4A86450>]}


============================== 14:54:31.080772 | b202673b-a2fd-4da2-932e-ad54b2414a75 ==============================
[0m14:54:31.080772 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:54:31.090371 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m14:54:31.903090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b202673b-a2fd-4da2-932e-ad54b2414a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1A37B7E60>]}
[0m14:54:32.644855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b202673b-a2fd-4da2-932e-ad54b2414a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1A2B4F1D0>]}
[0m14:54:32.647550 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:54:33.395685 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:54:33.651414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:54:33.651414 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\consulta.py
[0m14:54:34.207452 [error] [MainThread]: Encountered an error:
Parsing Error in model consulta (models\consulta.py)
  dbt allows exactly one model defined per python file, found 0
[0m14:54:34.208453 [debug] [MainThread]: Command `dbt run` failed at 14:54:34.208453 after 3.34 seconds
[0m14:54:34.209453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1A4AFB9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1A529CC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1A4E224B0>]}
[0m14:54:34.209453 [debug] [MainThread]: Flushing usage events
[0m14:54:34.261996 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:40.780810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C375CB1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3733938F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3761D8E00>]}


============================== 14:59:40.787809 | 4552ba22-edb3-46ec-8f3b-dab3bdbcaf69 ==============================
[0m14:59:40.787809 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:59:40.787809 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_customers', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m14:59:41.355400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4552ba22-edb3-46ec-8f3b-dab3bdbcaf69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C375D13D10>]}
[0m14:59:41.652300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4552ba22-edb3-46ec-8f3b-dab3bdbcaf69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C375FBD1C0>]}
[0m14:59:41.654303 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:59:42.348366 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:59:42.599891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:59:42.599891 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\consulta.py
[0m14:59:42.600891 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\02 silver\dim_customers.sql
[0m14:59:43.110437 [error] [MainThread]: Encountered an error:
Parsing Error in model consulta (models\consulta.py)
  dbt allows exactly one model defined per python file, found 0
[0m14:59:43.112357 [debug] [MainThread]: Command `dbt run` failed at 14:59:43.112357 after 2.60 seconds
[0m14:59:43.113356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C376274380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C378259AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C378274B30>]}
[0m14:59:43.113356 [debug] [MainThread]: Flushing usage events
[0m14:59:43.162177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:16.035017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013326E97170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013329BBF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013329BBF3E0>]}


============================== 15:03:16.039018 | e3b70a57-5a54-41d6-95bf-59dfe6f06be0 ==============================
[0m15:03:16.039018 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:03:16.040019 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_customers', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt'}
[0m15:03:16.539342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3b70a57-5a54-41d6-95bf-59dfe6f06be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001332B4030B0>]}
[0m15:03:16.828188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3b70a57-5a54-41d6-95bf-59dfe6f06be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001332A1569F0>]}
[0m15:03:16.830188 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:03:17.299092 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:03:17.600449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:03:17.601450 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\consulta.py
[0m15:03:17.601450 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\02 silver\dim_customers.sql
[0m15:03:18.297273 [error] [MainThread]: Encountered an error:
Parsing Error in model consulta (models\consulta.py)
  dbt allows exactly one model defined per python file, found 0
[0m15:03:18.299277 [debug] [MainThread]: Command `dbt run` failed at 15:03:18.299277 after 2.50 seconds
[0m15:03:18.300275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013329BBF3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001332BB5D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001332B6E3E00>]}
[0m15:03:18.300275 [debug] [MainThread]: Flushing usage events
[0m15:03:18.337228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:27.283813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949AC874D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949A0AB230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949A0AB0E0>]}


============================== 15:05:27.288810 | 7f44aad4-9cb9-4d9b-8bc3-9e5254075f36 ==============================
[0m15:05:27.288810 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:05:27.289811 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select dim_customers', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:05:27.836958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f44aad4-9cb9-4d9b-8bc3-9e5254075f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949CFF5370>]}
[0m15:05:28.018775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f44aad4-9cb9-4d9b-8bc3-9e5254075f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949BB6F830>]}
[0m15:05:28.019776 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:05:28.420780 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:05:28.635982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:28.636982 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\02 silver\dim_customers.sql
[0m15:05:29.505806 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
[0m15:05:29.541041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f44aad4-9cb9-4d9b-8bc3-9e5254075f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949D8BCE60>]}
[0m15:05:29.748412 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m15:05:29.753853 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m15:05:29.820826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f44aad4-9cb9-4d9b-8bc3-9e5254075f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949D0BA000>]}
[0m15:05:29.821344 [info ] [MainThread]: Found 1 model, 6 sources, 434 macros
[0m15:05:29.823345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f44aad4-9cb9-4d9b-8bc3-9e5254075f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949D5F06E0>]}
[0m15:05:29.827345 [info ] [MainThread]: 
[0m15:05:29.830350 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:29.831346 [info ] [MainThread]: 
[0m15:05:29.832346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:29.834345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:05:30.136598 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:05:30.136598 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:05:30.137598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:30.207863 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.070 seconds
[0m15:05:30.209864 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:05:30.214862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m15:05:30.227072 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m15:05:30.228072 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m15:05:30.229070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:30.250533 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m15:05:30.251534 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m15:05:30.252534 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:05:30.257534 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m15:05:30.259533 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m15:05:30.261533 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m15:05:30.273706 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:30.274705 [debug] [MainThread]: On master: BEGIN
[0m15:05:30.275704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:30.307920 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m15:05:30.308918 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:30.309919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:05:30.316921 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m15:05:30.318919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f44aad4-9cb9-4d9b-8bc3-9e5254075f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949DC4D100>]}
[0m15:05:30.319919 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:30.321918 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:30.321918 [debug] [MainThread]: On master: BEGIN
[0m15:05:30.323918 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:05:30.324920 [debug] [MainThread]: On master: COMMIT
[0m15:05:30.325919 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:30.325919 [debug] [MainThread]: On master: COMMIT
[0m15:05:30.327919 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:05:30.327919 [debug] [MainThread]: On master: Close
[0m15:05:30.334919 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.dim_customers
[0m15:05:30.335920 [info ] [Thread-1 (]: 1 of 1 START sql table model public.dim_customers .............................. [RUN]
[0m15:05:30.337919 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.dim_customers'
[0m15:05:30.338921 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.dim_customers
[0m15:05:30.353812 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.dim_customers"
[0m15:05:30.354810 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.dim_customers
[0m15:05:30.455470 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.dim_customers"
[0m15:05:30.456469 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m15:05:30.457470 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: BEGIN
[0m15:05:30.458468 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:05:30.479876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m15:05:30.480879 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m15:05:30.481878 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */

  
    

  create  table "warehouse"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "warehouse"."public"."olist_customers_dataset"
  );
  
[0m15:05:30.654132 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.172 seconds
[0m15:05:30.666134 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m15:05:30.667380 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
alter table "warehouse"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m15:05:30.668894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:05:30.674895 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m15:05:30.675894 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
alter table "warehouse"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m15:05:30.676897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:05:30.713662 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m15:05:30.714179 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m15:05:30.714179 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m15:05:30.781319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.066 seconds
[0m15:05:30.789322 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."dim_customers__dbt_backup"
[0m15:05:30.796322 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m15:05:30.796322 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
drop table if exists "warehouse"."public"."dim_customers__dbt_backup" cascade
[0m15:05:30.801321 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:05:30.804324 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: Close
[0m15:05:30.809947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f44aad4-9cb9-4d9b-8bc3-9e5254075f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949DB160C0>]}
[0m15:05:30.810946 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.dim_customers ......................... [[32mSELECT 99441[0m in 0.47s]
[0m15:05:30.811945 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.dim_customers
[0m15:05:30.813945 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:30.813945 [debug] [MainThread]: On master: BEGIN
[0m15:05:30.814945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:30.832955 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m15:05:30.833950 [debug] [MainThread]: On master: COMMIT
[0m15:05:30.833950 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:30.833950 [debug] [MainThread]: On master: COMMIT
[0m15:05:30.834949 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:05:30.835947 [debug] [MainThread]: On master: Close
[0m15:05:30.836947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:30.838016 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m15:05:30.838532 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m15:05:30.839532 [debug] [MainThread]: Connection 'model.olist_ecommerce.dim_customers' was properly closed.
[0m15:05:30.839532 [info ] [MainThread]: 
[0m15:05:30.840530 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m15:05:30.842530 [debug] [MainThread]: Command end result
[0m15:05:30.881124 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m15:05:30.896232 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m15:05:30.923545 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m15:05:30.924548 [info ] [MainThread]: 
[0m15:05:30.928545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:30.929543 [info ] [MainThread]: 
[0m15:05:30.934545 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:05:30.937747 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:30.937747 after 3.87 seconds
[0m15:05:30.938745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949A0AB0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949D0B9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949A646870>]}
[0m15:05:30.939746 [debug] [MainThread]: Flushing usage events
[0m15:05:30.989647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:25.399308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427246F470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002426F652660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242724A2090>]}


============================== 16:35:25.406306 | f15b8a44-0def-4d49-b0ec-4e276b207e03 ==============================
[0m16:35:25.406306 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:35:25.407307 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --models silver', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt'}
[0m16:35:25.407307 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m16:35:25.408307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f15b8a44-0def-4d49-b0ec-4e276b207e03', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024272B45C10>]}
[0m16:35:26.042991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f15b8a44-0def-4d49-b0ec-4e276b207e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024273CA7770>]}
[0m16:35:26.267829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f15b8a44-0def-4d49-b0ec-4e276b207e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024271E4FBC0>]}
[0m16:35:26.269830 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:35:26.994033 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:35:27.401449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:27.402448 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\02 silver\dim_customers.sql
[0m16:35:28.101110 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_ecommerce.dim_customers' (models\02 silver\dim_customers.sql) depends on a source named 'raw_data.olist_sellers_dataset' which was not found
[0m16:35:28.102110 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:35:28.104116 [debug] [MainThread]: Command `dbt run` failed at 16:35:28.104116 after 2.96 seconds
[0m16:35:28.104116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242725F7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024274467F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242743C22D0>]}
[0m16:35:28.105112 [debug] [MainThread]: Flushing usage events
[0m16:35:28.429789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:16.837308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E436FA6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E439D0FC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E439F23F80>]}


============================== 16:36:16.846765 | 3a79a27e-0aba-4d39-ad61-7418185c379d ==============================
[0m16:36:16.846765 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:36:16.847930 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select dim_products', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m16:36:18.351577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a79a27e-0aba-4d39-ad61-7418185c379d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43B835520>]}
[0m16:36:18.818642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a79a27e-0aba-4d39-ad61-7418185c379d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4374C7AA0>]}
[0m16:36:18.820647 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:36:19.556806 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:36:20.031112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:36:20.032112 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\02 silver\dim_customers.sql
[0m16:36:20.867933 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_ecommerce.dim_customers' (models\02 silver\dim_customers.sql) depends on a source named 'raw_data.olist_geolocation_dataset' which was not found
[0m16:36:20.869935 [debug] [MainThread]: Command `dbt run` failed at 16:36:20.868933 after 4.40 seconds
[0m16:36:20.869935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43A4960C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43BF0CC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43B837770>]}
[0m16:36:20.870934 [debug] [MainThread]: Flushing usage events
[0m16:36:20.881556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:38.222826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBC180DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBA5B05C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBA369250>]}


============================== 16:38:38.227418 | 53093b16-6afa-4d51-a2e0-093382cdd099 ==============================
[0m16:38:38.227418 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:38:38.228418 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select dim_products', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m16:38:38.745778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53093b16-6afa-4d51-a2e0-093382cdd099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBC2C93A0>]}
[0m16:38:38.932768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53093b16-6afa-4d51-a2e0-093382cdd099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBC28AB10>]}
[0m16:38:38.933768 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:38:39.448340 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:38:39.731819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:38:39.731819 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\01 bronze\sources.yml
[0m16:38:39.732819 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\02 silver\dim_customers.sql
[0m16:38:40.638675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
[0m16:38:40.651600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53093b16-6afa-4d51-a2e0-093382cdd099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBC5D0800>]}
[0m16:38:40.781074 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:38:40.785073 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:38:40.838007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53093b16-6afa-4d51-a2e0-093382cdd099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBCB70EF0>]}
[0m16:38:40.839032 [info ] [MainThread]: Found 1 model, 9 sources, 434 macros
[0m16:38:40.839032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53093b16-6afa-4d51-a2e0-093382cdd099', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBCB69790>]}
[0m16:38:40.840007 [warn ] [MainThread]: The selection criterion 'dim_products' does not match any enabled nodes
[0m16:38:40.843078 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:38:40.843560 [debug] [MainThread]: Command end result
[0m16:38:40.867603 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:38:40.871605 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:38:40.879119 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m16:38:40.880126 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:40.880126 after 2.87 seconds
[0m16:38:40.881121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBA885AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBA22F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFB9DACB30>]}
[0m16:38:40.881121 [debug] [MainThread]: Flushing usage events
[0m16:38:40.961375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:18.215977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234FB59CFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234F93670E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234FBA3FB30>]}


============================== 16:39:18.224864 | 6ca279f3-a082-4d0e-b0eb-88a8f7f86657 ==============================
[0m16:39:18.224864 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:39:18.225945 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select dim_products', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m16:39:19.047949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ca279f3-a082-4d0e-b0eb-88a8f7f86657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234FDB82930>]}
[0m16:39:19.428260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ca279f3-a082-4d0e-b0eb-88a8f7f86657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234FD9263F0>]}
[0m16:39:19.430260 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:39:19.888665 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:39:20.092893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:20.092893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:20.100055 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m16:39:20.140415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ca279f3-a082-4d0e-b0eb-88a8f7f86657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234FD9E85C0>]}
[0m16:39:20.231548 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:39:20.236156 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:39:20.270927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ca279f3-a082-4d0e-b0eb-88a8f7f86657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234FE049250>]}
[0m16:39:20.271925 [info ] [MainThread]: Found 1 model, 9 sources, 434 macros
[0m16:39:20.273924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ca279f3-a082-4d0e-b0eb-88a8f7f86657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234FDD15190>]}
[0m16:39:20.273924 [warn ] [MainThread]: The selection criterion 'dim_products' does not match any enabled nodes
[0m16:39:20.279081 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:39:20.286076 [debug] [MainThread]: Command end result
[0m16:39:20.310069 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:39:20.315068 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:39:20.324804 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m16:39:20.325804 [debug] [MainThread]: Command `dbt run` succeeded at 16:39:20.325804 after 2.46 seconds
[0m16:39:20.325804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234FC0F7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234FA9FAF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234FB9DF6E0>]}
[0m16:39:20.326805 [debug] [MainThread]: Flushing usage events
[0m16:39:20.369441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:58.812109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5A99F7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AC548350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AC5483E0>]}


============================== 16:45:58.818690 | 184fac74-c368-42c9-bb03-48eb4b1c39ef ==============================
[0m16:45:58.818690 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:45:58.819690 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select dim_products', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:45:59.650299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '184fac74-c368-42c9-bb03-48eb4b1c39ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AE0B3590>]}
[0m16:45:59.844704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '184fac74-c368-42c9-bb03-48eb4b1c39ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AC33F830>]}
[0m16:45:59.846704 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:46:00.367075 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:46:00.560912 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:46:00.560912 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\02 silver\dim_products.sql
[0m16:46:00.560912 [debug] [MainThread]: Partial parsing: deleted file: olist_ecommerce://models\02 silver\dim_customers.sql
[0m16:46:01.218954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m16:46:01.237288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '184fac74-c368-42c9-bb03-48eb4b1c39ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AE4945F0>]}
[0m16:46:01.364583 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:46:01.375576 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:46:01.428020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '184fac74-c368-42c9-bb03-48eb4b1c39ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AE9E74A0>]}
[0m16:46:01.429098 [info ] [MainThread]: Found 1 model, 9 sources, 434 macros
[0m16:46:01.430159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '184fac74-c368-42c9-bb03-48eb4b1c39ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AE8B3CE0>]}
[0m16:46:01.433447 [info ] [MainThread]: 
[0m16:46:01.434628 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:46:01.435147 [info ] [MainThread]: 
[0m16:46:01.436278 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:46:01.439512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m16:46:01.812507 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m16:46:01.813508 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:46:01.813508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:01.840098 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m16:46:01.840098 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:46:01.852607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m16:46:01.864670 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:46:01.865667 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m16:46:01.866670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:01.885954 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m16:46:01.886955 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:46:01.886955 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:46:01.890959 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m16:46:01.892542 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m16:46:01.893472 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m16:46:01.901472 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:01.901472 [debug] [MainThread]: On master: BEGIN
[0m16:46:01.902475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:01.916482 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:46:01.916482 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:01.916482 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:46:01.921472 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m16:46:01.922475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '184fac74-c368-42c9-bb03-48eb4b1c39ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AE877050>]}
[0m16:46:01.922475 [debug] [MainThread]: On master: ROLLBACK
[0m16:46:01.923474 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:01.924472 [debug] [MainThread]: On master: BEGIN
[0m16:46:01.925472 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:46:01.925472 [debug] [MainThread]: On master: COMMIT
[0m16:46:01.926662 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:01.927179 [debug] [MainThread]: On master: COMMIT
[0m16:46:01.928176 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:46:01.928176 [debug] [MainThread]: On master: Close
[0m16:46:01.937179 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.dim_products
[0m16:46:01.938179 [info ] [Thread-1 (]: 1 of 1 START sql table model public.dim_products ............................... [RUN]
[0m16:46:01.939179 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.dim_products'
[0m16:46:01.939179 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.dim_products
[0m16:46:01.951424 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.dim_products"
[0m16:46:01.952423 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.dim_products
[0m16:46:02.020420 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.dim_products"
[0m16:46:02.022415 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_products"
[0m16:46:02.023419 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_products: BEGIN
[0m16:46:02.024414 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:46:02.039156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:46:02.039156 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_products"
[0m16:46:02.040154 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_products: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_products"} */

  
    

  create  table "warehouse"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

-- dim_products.sql
SELECT 
    p.product_id,
    p.product_category_name as category_pt,
    COALESCE(t.product_category_name_english, 'Unknown') as category_en,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm,
    -- Calcular volume do produto
    CASE 
        WHEN p.product_length_cm > 0 AND p.product_height_cm > 0 AND p.product_width_cm > 0
        THEN p.product_length_cm * p.product_height_cm * p.product_width_cm
        ELSE NULL
    END as product_volume_cm3,
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."olist_products_dataset" p
LEFT JOIN "warehouse"."public"."product_category_name_translation" t
    ON p.product_category_name = t.product_category_name
  );
  
[0m16:46:02.104548 [debug] [Thread-1 (]: SQL status: SELECT 32951 in 0.064 seconds
[0m16:46:02.119467 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_products"
[0m16:46:02.120494 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_products: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_products"} */
alter table "warehouse"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m16:46:02.121469 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:02.140296 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_products: COMMIT
[0m16:46:02.141297 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_products"
[0m16:46:02.141297 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_products: COMMIT
[0m16:46:02.159368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m16:46:02.175716 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."dim_products__dbt_backup"
[0m16:46:02.188719 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_products"
[0m16:46:02.188719 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_products: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_products"} */
drop table if exists "warehouse"."public"."dim_products__dbt_backup" cascade
[0m16:46:02.197126 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m16:46:02.202126 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_products: Close
[0m16:46:02.207126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '184fac74-c368-42c9-bb03-48eb4b1c39ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5A9B47380>]}
[0m16:46:02.208126 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.dim_products .......................... [[32mSELECT 32951[0m in 0.27s]
[0m16:46:02.211123 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.dim_products
[0m16:46:02.213126 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:02.214129 [debug] [MainThread]: On master: BEGIN
[0m16:46:02.215128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:02.239058 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m16:46:02.239577 [debug] [MainThread]: On master: COMMIT
[0m16:46:02.240103 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:02.240103 [debug] [MainThread]: On master: COMMIT
[0m16:46:02.241090 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:46:02.242092 [debug] [MainThread]: On master: Close
[0m16:46:02.243096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:02.244096 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m16:46:02.245094 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m16:46:02.245094 [debug] [MainThread]: Connection 'model.olist_ecommerce.dim_products' was properly closed.
[0m16:46:02.246092 [info ] [MainThread]: 
[0m16:46:02.247094 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m16:46:02.249092 [debug] [MainThread]: Command end result
[0m16:46:02.287031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:46:02.292805 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:46:02.310220 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m16:46:02.310220 [info ] [MainThread]: 
[0m16:46:02.311219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:02.312219 [info ] [MainThread]: 
[0m16:46:02.313217 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:46:02.315222 [debug] [MainThread]: Command `dbt run` succeeded at 16:46:02.315222 after 3.79 seconds
[0m16:46:02.316219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5A991E7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AC89C320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5ACE05A90>]}
[0m16:46:02.318220 [debug] [MainThread]: Flushing usage events
[0m16:46:02.591452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:54.730920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356592F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023562BE70E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023565FF43E0>]}


============================== 16:46:54.753443 | c80be9d3-c506-4c60-9383-b1f86cf28d60 ==============================
[0m16:46:54.753443 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:46:54.754442 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select dim_sellers', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m16:46:55.892360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c80be9d3-c506-4c60-9383-b1f86cf28d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235674521E0>]}
[0m16:46:56.267619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c80be9d3-c506-4c60-9383-b1f86cf28d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023565F9F4A0>]}
[0m16:46:56.269616 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:46:56.790399 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:46:57.133418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:46:57.134416 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\02 silver\dim_sellers.sql
[0m16:46:58.671558 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
[0m16:46:58.695605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c80be9d3-c506-4c60-9383-b1f86cf28d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023567B3AC90>]}
[0m16:46:58.804440 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:46:58.810188 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:46:58.892304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c80be9d3-c506-4c60-9383-b1f86cf28d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235678CE960>]}
[0m16:46:58.893304 [info ] [MainThread]: Found 2 models, 9 sources, 434 macros
[0m16:46:58.894302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c80be9d3-c506-4c60-9383-b1f86cf28d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023567AD65A0>]}
[0m16:46:58.897561 [info ] [MainThread]: 
[0m16:46:58.898600 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:46:58.898600 [info ] [MainThread]: 
[0m16:46:58.900610 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:46:58.902602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m16:46:59.509688 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m16:46:59.510720 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:46:59.510720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:59.544092 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m16:46:59.546087 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:46:59.554626 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m16:46:59.567625 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:46:59.568625 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m16:46:59.568625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:59.589908 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m16:46:59.590912 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:46:59.591911 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:46:59.596913 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m16:46:59.599909 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m16:46:59.600910 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m16:46:59.616002 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:59.617002 [debug] [MainThread]: On master: BEGIN
[0m16:46:59.618004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:59.638552 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m16:46:59.639549 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:59.640550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:46:59.647153 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m16:46:59.649671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c80be9d3-c506-4c60-9383-b1f86cf28d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023567DC2B40>]}
[0m16:46:59.649671 [debug] [MainThread]: On master: ROLLBACK
[0m16:46:59.651670 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:59.652673 [debug] [MainThread]: On master: BEGIN
[0m16:46:59.654833 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:46:59.655356 [debug] [MainThread]: On master: COMMIT
[0m16:46:59.656462 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:59.656979 [debug] [MainThread]: On master: COMMIT
[0m16:46:59.657976 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:46:59.658977 [debug] [MainThread]: On master: Close
[0m16:46:59.669000 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.dim_sellers
[0m16:46:59.671001 [info ] [Thread-1 (]: 1 of 1 START sql table model public.dim_sellers ................................ [RUN]
[0m16:46:59.672002 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.dim_sellers'
[0m16:46:59.673005 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.dim_sellers
[0m16:46:59.686518 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.dim_sellers"
[0m16:46:59.688516 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.dim_sellers
[0m16:46:59.782013 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.dim_sellers"
[0m16:46:59.784006 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_sellers"
[0m16:46:59.785013 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_sellers: BEGIN
[0m16:46:59.785013 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:46:59.802635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:46:59.803681 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_sellers"
[0m16:46:59.803681 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_sellers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_sellers"} */

  
    

  create  table "warehouse"."public"."dim_sellers__dbt_tmp"
  
  
    as
  
  (
    -- dim_sellers


SELECT 
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."olist_sellers_dataset"
  );
  
[0m16:46:59.815388 [debug] [Thread-1 (]: SQL status: SELECT 3095 in 0.011 seconds
[0m16:46:59.839795 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_sellers"
[0m16:46:59.840301 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_sellers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_sellers"} */
alter table "warehouse"."public"."dim_sellers__dbt_tmp" rename to "dim_sellers"
[0m16:46:59.841387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:59.866020 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_sellers: COMMIT
[0m16:46:59.867021 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_sellers"
[0m16:46:59.867021 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_sellers: COMMIT
[0m16:46:59.930024 [debug] [Thread-1 (]: SQL status: COMMIT in 0.062 seconds
[0m16:46:59.940284 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."dim_sellers__dbt_backup"
[0m16:46:59.949074 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_sellers"
[0m16:46:59.949074 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_sellers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_sellers"} */
drop table if exists "warehouse"."public"."dim_sellers__dbt_backup" cascade
[0m16:46:59.951064 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:46:59.954218 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_sellers: Close
[0m16:46:59.959733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c80be9d3-c506-4c60-9383-b1f86cf28d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023562D374D0>]}
[0m16:46:59.961082 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.dim_sellers ........................... [[32mSELECT 3095[0m in 0.28s]
[0m16:46:59.963072 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.dim_sellers
[0m16:46:59.964686 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:59.965215 [debug] [MainThread]: On master: BEGIN
[0m16:46:59.966270 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:59.983980 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m16:46:59.984982 [debug] [MainThread]: On master: COMMIT
[0m16:46:59.985625 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:59.985648 [debug] [MainThread]: On master: COMMIT
[0m16:46:59.986939 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:46:59.986939 [debug] [MainThread]: On master: Close
[0m16:46:59.988000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:59.988530 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m16:46:59.989045 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m16:46:59.989045 [debug] [MainThread]: Connection 'model.olist_ecommerce.dim_sellers' was properly closed.
[0m16:46:59.990047 [info ] [MainThread]: 
[0m16:46:59.991048 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m16:46:59.993047 [debug] [MainThread]: Command end result
[0m16:47:00.032504 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:47:00.037020 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:47:00.051166 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m16:47:00.051785 [info ] [MainThread]: 
[0m16:47:00.052825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:00.053826 [info ] [MainThread]: 
[0m16:47:00.055828 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:47:00.058401 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:00.058401 after 5.62 seconds
[0m16:47:00.059401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023562B12300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356565BC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023565659F70>]}
[0m16:47:00.060401 [debug] [MainThread]: Flushing usage events
[0m16:47:00.089900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:56.668479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE5D38F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE5D3BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE5D3AA80>]}


============================== 16:47:56.676924 | 7741bb34-d2dc-44a8-922d-11998c1fe0af ==============================
[0m16:47:56.676924 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:47:56.677924 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select fact_order_items', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m16:47:58.215898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7741bb34-d2dc-44a8-922d-11998c1fe0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE790F0B0>]}
[0m16:47:58.639258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7741bb34-d2dc-44a8-922d-11998c1fe0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE568A150>]}
[0m16:47:58.641259 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:47:59.247589 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:47:59.588930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:47:59.589929 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\02 silver\fact_order_items.sql
[0m16:48:00.789148 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
[0m16:48:00.823267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7741bb34-d2dc-44a8-922d-11998c1fe0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE7EA5760>]}
[0m16:48:01.068862 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:48:01.079145 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:48:01.171644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7741bb34-d2dc-44a8-922d-11998c1fe0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE7FCBC50>]}
[0m16:48:01.172643 [info ] [MainThread]: Found 3 models, 9 sources, 434 macros
[0m16:48:01.173643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7741bb34-d2dc-44a8-922d-11998c1fe0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE747FE90>]}
[0m16:48:01.178646 [info ] [MainThread]: 
[0m16:48:01.179645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:01.180643 [info ] [MainThread]: 
[0m16:48:01.182643 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:48:01.186643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m16:48:01.525628 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m16:48:01.526598 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:48:01.527598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:01.561827 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m16:48:01.563827 [debug] [ThreadPool]: On list_warehouse: Close
[0m16:48:01.579702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m16:48:01.598476 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:48:01.598476 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m16:48:01.599474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:01.631473 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m16:48:01.632474 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m16:48:01.633473 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:48:01.639473 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.005 seconds
[0m16:48:01.642474 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m16:48:01.643473 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m16:48:01.658741 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:01.659248 [debug] [MainThread]: On master: BEGIN
[0m16:48:01.660345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:01.683357 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m16:48:01.684353 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:01.685352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:48:01.693608 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m16:48:01.696610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7741bb34-d2dc-44a8-922d-11998c1fe0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE8275670>]}
[0m16:48:01.697603 [debug] [MainThread]: On master: ROLLBACK
[0m16:48:01.698603 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:01.699606 [debug] [MainThread]: On master: BEGIN
[0m16:48:01.701607 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:48:01.702605 [debug] [MainThread]: On master: COMMIT
[0m16:48:01.704612 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:01.704612 [debug] [MainThread]: On master: COMMIT
[0m16:48:01.706605 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:48:01.707604 [debug] [MainThread]: On master: Close
[0m16:48:01.716604 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.fact_order_items
[0m16:48:01.718660 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fact_order_items ........................... [RUN]
[0m16:48:01.720626 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.fact_order_items'
[0m16:48:01.721665 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.fact_order_items
[0m16:48:01.740803 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.fact_order_items"
[0m16:48:01.743801 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.fact_order_items
[0m16:48:01.848446 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.fact_order_items"
[0m16:48:01.850443 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m16:48:01.851442 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_order_items: BEGIN
[0m16:48:01.852442 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:48:01.875440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m16:48:01.876443 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m16:48:01.877441 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_order_items: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_order_items"} */

  
    

  create  table "warehouse"."public"."fact_order_items__dbt_tmp"
  
  
    as
  
  (
    -- fact_order_items



SELECT 
    oi.order_id,
    oi.order_item_id,
    oi.product_id,
    oi.seller_id,
    oi.shipping_limit_date::timestamp as shipping_limit_date,
    oi.price,
    oi.freight_value,
    -- Campos calculados
    oi.price + oi.freight_value as total_item_value,
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."olist_order_items_dataset" oi

-- fact_orders



WITH order_items_agg AS (
    SELECT 
        order_id,
        COUNT(*) as total_items,
        SUM(price) as total_product_value,
        SUM(freight_value) as total_freight_value,
        SUM(price + freight_value) as total_order_value,
        AVG(price) as avg_item_price,
        MAX(price) as max_item_price,
        MIN(price) as min_item_price
    FROM "warehouse"."public"."olist_order_items_dataset"
    GROUP BY order_id
),

order_payments_agg AS (
    SELECT 
        order_id,
        SUM(payment_value) as total_payment_value,
        COUNT(DISTINCT payment_type) as payment_methods_count,
        STRING_AGG(DISTINCT payment_type, ', ') as payment_types,
        AVG(payment_installments) as avg_installments
    FROM "warehouse"."public"."olist_order_payments_dataset"
    GROUP BY order_id
)

SELECT 
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp::timestamp as order_purchase_timestamp,
    o.order_approved_at::timestamp as order_approved_at,
    o.order_delivered_carrier_date::timestamp as order_delivered_carrier_date,
    o.order_delivered_customer_date::timestamp as order_delivered_customer_date,
    o.order_estimated_delivery_date::timestamp as order_estimated_delivery_date,
    
    -- Métricas de itens
    oi.total_items,
    oi.total_product_value,
    oi.total_freight_value,
    oi.total_order_value,
    oi.avg_item_price,
    oi.max_item_price,
    oi.min_item_price,
    
    -- Métricas de pagamento
    op.total_payment_value,
    op.payment_methods_count,
    op.payment_types,
    op.avg_installments,
    
    -- Métricas de tempo (em dias)
    CASE 
        WHEN o.order_delivered_customer_date IS NOT NULL AND o.order_purchase_timestamp IS NOT NULL
        THEN EXTRACT(DAYS FROM (o.order_delivered_customer_date::timestamp - o.order_purchase_timestamp::timestamp))
        ELSE NULL 
    END as delivery_days_actual,
    
    CASE 
        WHEN o.order_estimated_delivery_date IS NOT NULL AND o.order_purchase_timestamp IS NOT NULL
        THEN EXTRACT(DAYS FROM (o.order_estimated_delivery_date::timestamp - o.order_purchase_timestamp::timestamp))
        ELSE NULL 
    END as delivery_days_estimated,
    
    -- Indicadores de qualidade
    CASE 
        WHEN o.order_delivered_customer_date IS NOT NULL AND o.order_estimated_delivery_date IS NOT NULL
        THEN CASE 
            WHEN o.order_delivered_customer_date::timestamp <= o.order_estimated_delivery_date::timestamp 
            THEN 'On Time' 
            ELSE 'Late' 
        END
        ELSE NULL
    END as delivery_status,
    
    CURRENT_TIMESTAMP as created_at
    
FROM "warehouse"."public"."olist_orders_dataset" o
LEFT JOIN order_items_agg oi ON o.order_id = oi.order_id  
LEFT JOIN order_payments_agg op ON o.order_id = op.order_id
WHERE o.order_status IS NOT NULL
  );
  
[0m16:48:01.880439 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "WITH"
LINE 33: WITH order_items_agg AS (
         ^

[0m16:48:01.881443 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_order_items: ROLLBACK
[0m16:48:01.883441 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_order_items: Close
[0m16:48:01.930224 [debug] [Thread-1 (]: Database Error in model fact_order_items (models\02 silver\fact_order_items.sql)
  syntax error at or near "WITH"
  LINE 33: WITH order_items_agg AS (
           ^
  compiled code at target\run\olist_ecommerce\models\02 silver\fact_order_items.sql
[0m16:48:01.934682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7741bb34-d2dc-44a8-922d-11998c1fe0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE7A8CE90>]}
[0m16:48:01.935770 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.fact_order_items .................. [[31mERROR[0m in 0.21s]
[0m16:48:01.937576 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.fact_order_items
[0m16:48:01.938629 [debug] [Thread-7 (]: Marking all children of 'model.olist_ecommerce.fact_order_items' to be skipped because of status 'error'.  Reason: Database Error in model fact_order_items (models\02 silver\fact_order_items.sql)
  syntax error at or near "WITH"
  LINE 33: WITH order_items_agg AS (
           ^
  compiled code at target\run\olist_ecommerce\models\02 silver\fact_order_items.sql.
[0m16:48:01.942629 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:01.943158 [debug] [MainThread]: On master: BEGIN
[0m16:48:01.943687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:01.966183 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m16:48:01.967143 [debug] [MainThread]: On master: COMMIT
[0m16:48:01.967675 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:01.968208 [debug] [MainThread]: On master: COMMIT
[0m16:48:01.969971 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:48:01.970522 [debug] [MainThread]: On master: Close
[0m16:48:01.971570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:01.972553 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m16:48:01.973183 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m16:48:01.974261 [debug] [MainThread]: Connection 'model.olist_ecommerce.fact_order_items' was properly closed.
[0m16:48:01.975099 [info ] [MainThread]: 
[0m16:48:01.976377 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m16:48:01.978048 [debug] [MainThread]: Command end result
[0m16:48:02.027087 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:48:02.032369 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:48:02.054959 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m16:48:02.055735 [info ] [MainThread]: 
[0m16:48:02.057589 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:48:02.058929 [info ] [MainThread]: 
[0m16:48:02.060156 [error] [MainThread]: [31mFailure in model fact_order_items (models\02 silver\fact_order_items.sql)[0m
[0m16:48:02.062254 [error] [MainThread]:   Database Error in model fact_order_items (models\02 silver\fact_order_items.sql)
  syntax error at or near "WITH"
  LINE 33: WITH order_items_agg AS (
           ^
  compiled code at target\run\olist_ecommerce\models\02 silver\fact_order_items.sql
[0m16:48:02.065923 [info ] [MainThread]: 
[0m16:48:02.070517 [info ] [MainThread]:   compiled code at target\compiled\olist_ecommerce\models\02 silver\fact_order_items.sql
[0m16:48:02.071566 [info ] [MainThread]: 
[0m16:48:02.072556 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:48:02.076045 [debug] [MainThread]: Command `dbt run` failed at 16:48:02.076045 after 5.72 seconds
[0m16:48:02.077303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE5B44FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE7FB69F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022AE7DBB380>]}
[0m16:48:02.078305 [debug] [MainThread]: Flushing usage events
[0m16:48:02.919963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:36.009464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4DE90E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4E917D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4E916BA0>]}


============================== 16:48:36.017463 | 308682b1-e0ee-4ca2-9fa2-66b99a793a6a ==============================
[0m16:48:36.017463 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:48:36.019463 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select fact_payments', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m16:48:36.727750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '308682b1-e0ee-4ca2-9fa2-66b99a793a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D504DC1A0>]}
[0m16:48:36.962666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '308682b1-e0ee-4ca2-9fa2-66b99a793a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4BE1A510>]}
[0m16:48:36.964670 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:48:37.394227 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:48:37.782917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:48:37.783917 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\02 silver\fact_orders.sql
[0m16:48:38.895789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
[0m16:48:38.918195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '308682b1-e0ee-4ca2-9fa2-66b99a793a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D50BAF860>]}
[0m16:48:39.052327 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:48:39.056328 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:48:39.110843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '308682b1-e0ee-4ca2-9fa2-66b99a793a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D5093E930>]}
[0m16:48:39.111843 [info ] [MainThread]: Found 4 models, 9 sources, 434 macros
[0m16:48:39.111843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '308682b1-e0ee-4ca2-9fa2-66b99a793a6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D50B817C0>]}
[0m16:48:39.112844 [warn ] [MainThread]: The selection criterion 'fact_payments' does not match any enabled nodes
[0m16:48:39.114842 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:48:39.115841 [debug] [MainThread]: Command end result
[0m16:48:39.188387 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m16:48:39.191386 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m16:48:39.198389 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m16:48:39.200389 [debug] [MainThread]: Command `dbt run` succeeded at 16:48:39.199391 after 3.53 seconds
[0m16:48:39.200389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D50BA2540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4E7CD5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D4E7CDA60>]}
[0m16:48:39.201389 [debug] [MainThread]: Flushing usage events
[0m16:48:39.213387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:49.268895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F478AE42C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4785C7D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4785C73B0>]}


============================== 19:26:49.278218 | ec9c24d6-f3a0-46ac-91b6-dc88652ee883 ==============================
[0m19:26:49.278218 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:26:49.279217 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select fact_payments', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:26:50.397013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec9c24d6-f3a0-46ac-91b6-dc88652ee883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47A1A1430>]}
[0m19:26:50.702022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec9c24d6-f3a0-46ac-91b6-dc88652ee883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F478B263F0>]}
[0m19:26:50.704020 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:26:51.378394 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:26:51.817332 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m19:26:51.817332 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\02 silver\fact_payments.sql
[0m19:26:51.819262 [debug] [MainThread]: Partial parsing: deleted file: olist_ecommerce://models\02 silver\fact_orders.sql
[0m19:26:52.883758 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
[0m19:26:52.942780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec9c24d6-f3a0-46ac-91b6-dc88652ee883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47A80B560>]}
[0m19:26:53.135868 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:26:53.146528 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:26:53.204984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec9c24d6-f3a0-46ac-91b6-dc88652ee883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47A5A27E0>]}
[0m19:26:53.205983 [info ] [MainThread]: Found 4 models, 9 sources, 434 macros
[0m19:26:53.206982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec9c24d6-f3a0-46ac-91b6-dc88652ee883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47A47BFE0>]}
[0m19:26:53.211500 [info ] [MainThread]: 
[0m19:26:53.212496 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:26:53.213888 [info ] [MainThread]: 
[0m19:26:53.215346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:26:53.217325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:26:53.690828 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:26:53.690828 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:26:53.690828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:53.734735 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.039 seconds
[0m19:26:53.736736 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:26:53.748444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:26:53.761851 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:26:53.761851 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:26:53.761851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:53.781992 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m19:26:53.781992 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:26:53.781992 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:26:53.792047 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.005 seconds
[0m19:26:53.792047 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:26:53.792047 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:26:53.808863 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:53.810866 [debug] [MainThread]: On master: BEGIN
[0m19:26:53.811864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:26:53.828877 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m19:26:53.828877 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:53.828877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:26:53.835060 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:26:53.838577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec9c24d6-f3a0-46ac-91b6-dc88652ee883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47A7F9C70>]}
[0m19:26:53.838577 [debug] [MainThread]: On master: ROLLBACK
[0m19:26:53.840983 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:53.842985 [debug] [MainThread]: On master: BEGIN
[0m19:26:53.844985 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:26:53.845985 [debug] [MainThread]: On master: COMMIT
[0m19:26:53.845985 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:53.845985 [debug] [MainThread]: On master: COMMIT
[0m19:26:53.845985 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:26:53.845985 [debug] [MainThread]: On master: Close
[0m19:26:53.855548 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.fact_payments
[0m19:26:53.855548 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fact_payments .............................. [RUN]
[0m19:26:53.855548 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.fact_payments'
[0m19:26:53.855548 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.fact_payments
[0m19:26:53.877692 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.fact_payments"
[0m19:26:53.880692 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.fact_payments
[0m19:26:53.957908 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.fact_payments"
[0m19:26:53.961301 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_payments"
[0m19:26:53.962305 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: BEGIN
[0m19:26:53.963301 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:53.986710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m19:26:53.987709 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_payments"
[0m19:26:53.988708 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_payments"} */

  
    

  create  table "warehouse"."public"."fact_payments__dbt_tmp"
  
  
    as
  
  (
    -- fact_payments


SELECT 
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value,
    -- Categorizar tipos de pagamento
    CASE 
        WHEN payment_type = 'credit_card' THEN 'Credit Card'
        WHEN payment_type = 'boleto' THEN 'Bank Slip'
        WHEN payment_type = 'voucher' THEN 'Voucher'
        WHEN payment_type = 'debit_card' THEN 'Debit Card'
        ELSE 'Other'
    END as payment_type_clean,
    
    -- Categorizar parcelamento
    CASE 
        WHEN payment_installments = 1 THEN 'Single Payment'
        WHEN payment_installments BETWEEN 2 AND 6 THEN 'Short Term (2-6x)'
        WHEN payment_installments BETWEEN 7 AND 12 THEN 'Medium Term (7-12x)'
        WHEN payment_installments > 12 THEN 'Long Term (12x+)'
        ELSE 'Unknown'
    END as installment_category,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."olist_order_payments_dataset"
  );
  
[0m19:26:54.364478 [debug] [Thread-1 (]: SQL status: SELECT 103886 in 0.375 seconds
[0m19:26:54.387502 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_payments"
[0m19:26:54.387502 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_payments"} */
alter table "warehouse"."public"."fact_payments__dbt_tmp" rename to "fact_payments"
[0m19:26:54.389500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:26:54.420102 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: COMMIT
[0m19:26:54.421101 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_payments"
[0m19:26:54.422101 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: COMMIT
[0m19:26:54.638861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.216 seconds
[0m19:26:54.649860 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."fact_payments__dbt_backup"
[0m19:26:54.662971 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_payments"
[0m19:26:54.663971 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_payments"} */
drop table if exists "warehouse"."public"."fact_payments__dbt_backup" cascade
[0m19:26:54.664969 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m19:26:54.669971 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: Close
[0m19:26:54.677970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec9c24d6-f3a0-46ac-91b6-dc88652ee883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F475A03680>]}
[0m19:26:54.679971 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fact_payments ......................... [[32mSELECT 103886[0m in 0.82s]
[0m19:26:54.684458 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.fact_payments
[0m19:26:54.687455 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:54.688455 [debug] [MainThread]: On master: BEGIN
[0m19:26:54.689459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:26:54.714348 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m19:26:54.715347 [debug] [MainThread]: On master: COMMIT
[0m19:26:54.715347 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:54.716348 [debug] [MainThread]: On master: COMMIT
[0m19:26:54.718348 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:26:54.718348 [debug] [MainThread]: On master: Close
[0m19:26:54.720352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:54.720352 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:26:54.721374 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m19:26:54.722483 [debug] [MainThread]: Connection 'model.olist_ecommerce.fact_payments' was properly closed.
[0m19:26:54.723416 [info ] [MainThread]: 
[0m19:26:54.724416 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m19:26:54.726669 [debug] [MainThread]: Command end result
[0m19:26:54.770012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:26:54.775011 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:26:54.793063 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:26:54.794066 [info ] [MainThread]: 
[0m19:26:54.795069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:26:54.796063 [info ] [MainThread]: 
[0m19:26:54.797064 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:26:54.798063 [debug] [MainThread]: Command `dbt run` succeeded at 19:26:54.798063 after 5.85 seconds
[0m19:26:54.799062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4785C7D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F478B54CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47A28C530>]}
[0m19:26:54.799062 [debug] [MainThread]: Flushing usage events
[0m19:26:55.126453 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:15.881088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330D315820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330B54BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330B663980>]}


============================== 19:28:15.887088 | 10df5c74-5dbd-4268-b130-1a1b1d9806a6 ==============================
[0m19:28:15.887088 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:28:15.888088 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_geolocation', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m19:28:16.569874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10df5c74-5dbd-4268-b130-1a1b1d9806a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233090B0380>]}
[0m19:28:16.824870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10df5c74-5dbd-4268-b130-1a1b1d9806a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330BA86000>]}
[0m19:28:16.826456 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:28:17.477973 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:28:17.781585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:28:17.781585 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\02 silver\dim_geolocation.sql
[0m19:28:18.882855 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m19:28:18.918576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10df5c74-5dbd-4268-b130-1a1b1d9806a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330D7CF6E0>]}
[0m19:28:19.106802 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:28:19.111803 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:28:19.162179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10df5c74-5dbd-4268-b130-1a1b1d9806a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330DC269F0>]}
[0m19:28:19.163174 [info ] [MainThread]: Found 5 models, 9 sources, 434 macros
[0m19:28:19.164175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10df5c74-5dbd-4268-b130-1a1b1d9806a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330D314DA0>]}
[0m19:28:19.169174 [info ] [MainThread]: 
[0m19:28:19.170177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:28:19.175179 [info ] [MainThread]: 
[0m19:28:19.177185 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:19.179184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:28:19.613275 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:28:19.614438 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:28:19.614957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:19.674896 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.060 seconds
[0m19:28:19.676896 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:28:19.712844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:28:19.726914 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:28:19.727909 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:28:19.727909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:19.752529 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m19:28:19.752862 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:28:19.753864 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:28:19.759860 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.005 seconds
[0m19:28:19.762863 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:28:19.764861 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:28:19.780685 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:19.781783 [debug] [MainThread]: On master: BEGIN
[0m19:28:19.782987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:19.805969 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m19:28:19.806494 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:19.807521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:28:19.815795 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:28:19.818798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10df5c74-5dbd-4268-b130-1a1b1d9806a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330ABC5E80>]}
[0m19:28:19.819785 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:19.820791 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:19.822404 [debug] [MainThread]: On master: BEGIN
[0m19:28:19.823923 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:28:19.825315 [debug] [MainThread]: On master: COMMIT
[0m19:28:19.825833 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:19.826830 [debug] [MainThread]: On master: COMMIT
[0m19:28:19.828351 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:28:19.828913 [debug] [MainThread]: On master: Close
[0m19:28:19.840315 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.dim_geolocation
[0m19:28:19.841518 [info ] [Thread-1 (]: 1 of 1 START sql table model public.dim_geolocation ............................ [RUN]
[0m19:28:19.842496 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.dim_geolocation'
[0m19:28:19.843640 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.dim_geolocation
[0m19:28:19.862323 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.dim_geolocation"
[0m19:28:19.863322 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.dim_geolocation
[0m19:28:19.976036 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.dim_geolocation"
[0m19:28:19.979033 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_geolocation"
[0m19:28:19.980088 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_geolocation: BEGIN
[0m19:28:19.980088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:20.023938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m19:28:20.024941 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_geolocation"
[0m19:28:20.025938 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_geolocation"} */

  
    

  create  table "warehouse"."public"."dim_geolocation__dbt_tmp"
  
  
    as
  
  (
    --dim_geolocation



WITH geo_clean AS (
    SELECT DISTINCT
        geolocation_zip_code_prefix,
        geolocation_lat,
        geolocation_lng,
        geolocation_city,
        geolocation_state
    FROM "warehouse"."public"."olist_geolocation_dataset"
    WHERE geolocation_lat BETWEEN -35 AND 5  -- Filtrar coordenadas válidas do Brasil
      AND geolocation_lng BETWEEN -75 AND -30
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY geolocation_zip_code_prefix) as geo_id,
    geolocation_zip_code_prefix as zip_code_prefix,
    geolocation_lat as latitude,
    geolocation_lng as longitude,
    geolocation_city as city,
    geolocation_state as state,
    CURRENT_TIMESTAMP as created_at
FROM geo_clean
  );
  
[0m19:28:25.339207 [debug] [Thread-1 (]: SQL status: SELECT 738307 in 5.312 seconds
[0m19:28:25.355781 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_geolocation"
[0m19:28:25.355781 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_geolocation"} */
alter table "warehouse"."public"."dim_geolocation__dbt_tmp" rename to "dim_geolocation"
[0m19:28:25.358018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:28:25.387016 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_geolocation: COMMIT
[0m19:28:25.388577 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_geolocation"
[0m19:28:25.388577 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_geolocation: COMMIT
[0m19:28:25.416796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m19:28:25.430705 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."dim_geolocation__dbt_backup"
[0m19:28:25.450010 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_geolocation"
[0m19:28:25.450010 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_geolocation"} */
drop table if exists "warehouse"."public"."dim_geolocation__dbt_backup" cascade
[0m19:28:25.454266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m19:28:25.459030 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_geolocation: Close
[0m19:28:25.463775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10df5c74-5dbd-4268-b130-1a1b1d9806a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233090835F0>]}
[0m19:28:25.465769 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.dim_geolocation ....................... [[32mSELECT 738307[0m in 5.62s]
[0m19:28:25.468765 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.dim_geolocation
[0m19:28:25.470766 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:25.470766 [debug] [MainThread]: On master: BEGIN
[0m19:28:25.471767 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:25.488470 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:28:25.489463 [debug] [MainThread]: On master: COMMIT
[0m19:28:25.489463 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:25.490464 [debug] [MainThread]: On master: COMMIT
[0m19:28:25.491466 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:28:25.492464 [debug] [MainThread]: On master: Close
[0m19:28:25.494468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:25.494468 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:28:25.495466 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m19:28:25.497463 [debug] [MainThread]: Connection 'model.olist_ecommerce.dim_geolocation' was properly closed.
[0m19:28:25.498462 [info ] [MainThread]: 
[0m19:28:25.501128 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.32 seconds (6.32s).
[0m19:28:25.502881 [debug] [MainThread]: Command end result
[0m19:28:25.546027 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:28:25.550024 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:28:25.568105 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:28:25.568105 [info ] [MainThread]: 
[0m19:28:25.570102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:25.570102 [info ] [MainThread]: 
[0m19:28:25.571101 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:28:25.573101 [debug] [MainThread]: Command `dbt run` succeeded at 19:28:25.573101 after 9.99 seconds
[0m19:28:25.573101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330B942540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330B181EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330BC43C20>]}
[0m19:28:25.574103 [debug] [MainThread]: Flushing usage events
[0m19:28:25.817900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:35:25.008550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E5FA42C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E64920C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E64920F0>]}


============================== 19:35:25.015721 | 61e464de-1131-4155-b5dd-e84cb0aaa415 ==============================
[0m19:35:25.015721 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:35:25.017315 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select dim_order_items', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt'}
[0m19:35:25.583608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61e464de-1131-4155-b5dd-e84cb0aaa415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E769BE30>]}
[0m19:35:25.762141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61e464de-1131-4155-b5dd-e84cb0aaa415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E5A97830>]}
[0m19:35:25.769444 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:35:26.185956 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:35:26.398665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:35:26.400666 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\02 silver\fact_order_items.sql
[0m19:35:27.094008 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
[0m19:35:27.117232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61e464de-1131-4155-b5dd-e84cb0aaa415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E80BF9E0>]}
[0m19:35:27.251657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:35:27.256367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:35:27.304231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61e464de-1131-4155-b5dd-e84cb0aaa415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E7E5B200>]}
[0m19:35:27.304752 [info ] [MainThread]: Found 5 models, 9 sources, 434 macros
[0m19:35:27.304752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61e464de-1131-4155-b5dd-e84cb0aaa415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E8090050>]}
[0m19:35:27.304752 [warn ] [MainThread]: The selection criterion 'dim_order_items' does not match any enabled nodes
[0m19:35:27.311782 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:35:27.311782 [debug] [MainThread]: Command end result
[0m19:35:27.400219 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:35:27.403858 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:35:27.409458 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:35:27.411460 [debug] [MainThread]: Command `dbt run` succeeded at 19:35:27.411460 after 2.64 seconds
[0m19:35:27.411460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E7D4BCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E5736720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E772FEF0>]}
[0m19:35:27.412458 [debug] [MainThread]: Flushing usage events
[0m19:35:27.490205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:44.933568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FCF85A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FA5EE900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FD5D9910>]}


============================== 19:36:44.939143 | fb756710-2bff-4c69-8d3e-1d4ba000eef5 ==============================
[0m19:36:44.939143 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:36:44.939143 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_order', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt'}
[0m19:36:45.446037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb756710-2bff-4c69-8d3e-1d4ba000eef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FEF82900>]}
[0m19:36:45.635857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb756710-2bff-4c69-8d3e-1d4ba000eef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FD5FD130>]}
[0m19:36:45.636859 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:36:46.097839 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:36:46.303996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:36:46.304995 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\02 silver\fact_orders.sql
[0m19:36:47.069250 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
[0m19:36:47.087607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb756710-2bff-4c69-8d3e-1d4ba000eef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FF66FEF0>]}
[0m19:36:47.190234 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:36:47.196322 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:36:47.236337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb756710-2bff-4c69-8d3e-1d4ba000eef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FF280290>]}
[0m19:36:47.237401 [info ] [MainThread]: Found 6 models, 9 sources, 434 macros
[0m19:36:47.237401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb756710-2bff-4c69-8d3e-1d4ba000eef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FF584DA0>]}
[0m19:36:47.237401 [warn ] [MainThread]: The selection criterion 'dim_order' does not match any enabled nodes
[0m19:36:47.239961 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:36:47.243998 [debug] [MainThread]: Command end result
[0m19:36:47.317615 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:36:47.320615 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:36:47.326615 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:36:47.327615 [debug] [MainThread]: Command `dbt run` succeeded at 19:36:47.327615 after 2.62 seconds
[0m19:36:47.328615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FD5D9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FD5FD1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FD39BA40>]}
[0m19:36:47.328615 [debug] [MainThread]: Flushing usage events
[0m19:36:47.425723 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:20.629880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2ADDC3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AD6DB5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AD6DA3F0>]}


============================== 19:40:20.634878 | 57c487d9-711e-46cc-ab99-9df52a214985 ==============================
[0m19:40:20.634878 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:40:20.634878 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select fact_order_items', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m19:40:21.301160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57c487d9-711e-46cc-ab99-9df52a214985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AF668E00>]}
[0m19:40:21.486949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57c487d9-711e-46cc-ab99-9df52a214985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AF577830>]}
[0m19:40:21.488948 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:40:21.936070 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:40:22.179758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:40:22.180761 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\02 silver\fact_order_items.sql
[0m19:40:22.943255 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m19:40:22.980618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57c487d9-711e-46cc-ab99-9df52a214985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AFFDFD10>]}
[0m19:40:23.109608 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:40:23.113865 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:40:23.155094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57c487d9-711e-46cc-ab99-9df52a214985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AFBF74A0>]}
[0m19:40:23.155634 [info ] [MainThread]: Found 6 models, 9 sources, 434 macros
[0m19:40:23.156150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57c487d9-711e-46cc-ab99-9df52a214985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AFFBD460>]}
[0m19:40:23.159153 [info ] [MainThread]: 
[0m19:40:23.160151 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:40:23.161151 [info ] [MainThread]: 
[0m19:40:23.162151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:23.163150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:40:23.587268 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:40:23.587827 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:40:23.588788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:23.628332 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m19:40:23.631332 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:40:23.641756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:40:23.652552 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:40:23.653627 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:40:23.653969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:23.674657 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:40:23.674657 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:40:23.674657 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:40:23.678657 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.004 seconds
[0m19:40:23.681985 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:40:23.683008 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:40:23.693362 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:23.693362 [debug] [MainThread]: On master: BEGIN
[0m19:40:23.693362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:23.718915 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m19:40:23.718915 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:23.719915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:40:23.725319 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:40:23.726374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57c487d9-711e-46cc-ab99-9df52a214985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AFFD1A60>]}
[0m19:40:23.726374 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:23.728342 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:23.728342 [debug] [MainThread]: On master: BEGIN
[0m19:40:23.729832 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:40:23.730532 [debug] [MainThread]: On master: COMMIT
[0m19:40:23.732030 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:23.732565 [debug] [MainThread]: On master: COMMIT
[0m19:40:23.735414 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:23.736414 [debug] [MainThread]: On master: Close
[0m19:40:23.744621 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.fact_order_items
[0m19:40:23.745672 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fact_order_items ........................... [RUN]
[0m19:40:23.747733 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.fact_order_items'
[0m19:40:23.748265 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.fact_order_items
[0m19:40:23.769214 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.fact_order_items"
[0m19:40:23.770784 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.fact_order_items
[0m19:40:23.826852 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.fact_order_items"
[0m19:40:23.826852 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m19:40:23.826852 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_order_items: BEGIN
[0m19:40:23.829952 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:40:23.845991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:40:23.846991 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m19:40:23.846991 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_order_items: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_order_items"} */

  
    

  create  table "warehouse"."public"."fact_order_items__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    oi.order_id,
    oi.order_item_id,
    oi.product_id,
    oi.seller_id,
    oi.shipping_limit_date::timestamp as shipping_limit_date,
    oi.price,
    oi.freight_value,
    oi.price + oi.freight_value as total_item_value,
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."olist_order_items_dataset" oi
  );
  
[0m19:40:24.199412 [debug] [Thread-1 (]: SQL status: SELECT 112650 in 0.351 seconds
[0m19:40:24.222537 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m19:40:24.222537 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_order_items: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_order_items"} */
alter table "warehouse"."public"."fact_order_items__dbt_tmp" rename to "fact_order_items"
[0m19:40:24.225062 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:40:24.252222 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_order_items: COMMIT
[0m19:40:24.252222 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m19:40:24.252222 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_order_items: COMMIT
[0m19:40:24.320103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.063 seconds
[0m19:40:24.334625 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."fact_order_items__dbt_backup"
[0m19:40:24.348021 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m19:40:24.349020 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_order_items: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_order_items"} */
drop table if exists "warehouse"."public"."fact_order_items__dbt_backup" cascade
[0m19:40:24.351021 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m19:40:24.356024 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_order_items: Close
[0m19:40:24.361722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57c487d9-711e-46cc-ab99-9df52a214985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AB1C3500>]}
[0m19:40:24.363237 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fact_order_items ...................... [[32mSELECT 112650[0m in 0.61s]
[0m19:40:24.365772 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.fact_order_items
[0m19:40:24.367690 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:24.368208 [debug] [MainThread]: On master: BEGIN
[0m19:40:24.369208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:24.397793 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m19:40:24.398325 [debug] [MainThread]: On master: COMMIT
[0m19:40:24.398852 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:24.398852 [debug] [MainThread]: On master: COMMIT
[0m19:40:24.400422 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:24.400982 [debug] [MainThread]: On master: Close
[0m19:40:24.402026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:24.403142 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:40:24.404238 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m19:40:24.404771 [debug] [MainThread]: Connection 'model.olist_ecommerce.fact_order_items' was properly closed.
[0m19:40:24.405303 [info ] [MainThread]: 
[0m19:40:24.406361 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m19:40:24.410685 [debug] [MainThread]: Command end result
[0m19:40:24.440437 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:40:24.446068 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:40:24.466233 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:40:24.467236 [info ] [MainThread]: 
[0m19:40:24.468233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:24.471236 [info ] [MainThread]: 
[0m19:40:24.474244 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:40:24.481411 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:24.481411 after 4.13 seconds
[0m19:40:24.482445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AD6DB5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2AD6AE600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2ADE64FE0>]}
[0m19:40:24.483526 [debug] [MainThread]: Flushing usage events
[0m19:40:24.518319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:36.577702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C489B0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C51342C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C260F5F0>]}


============================== 19:44:36.581701 | 4e06f5dd-2c5a-40fe-8f16-e806783cfb54 ==============================
[0m19:44:36.581701 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:44:36.582702 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart_summary', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:44:37.229400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e06f5dd-2c5a-40fe-8f16-e806783cfb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C6804140>]}
[0m19:44:37.419622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e06f5dd-2c5a-40fe-8f16-e806783cfb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C54469F0>]}
[0m19:44:37.420622 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:44:37.990507 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:44:38.271278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:44:38.271278 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_sales_summary.sql
[0m19:44:39.101359 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
[0m19:44:39.128561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e06f5dd-2c5a-40fe-8f16-e806783cfb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C71CC710>]}
[0m19:44:39.325939 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:44:39.330937 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:44:39.386259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e06f5dd-2c5a-40fe-8f16-e806783cfb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C72110D0>]}
[0m19:44:39.387260 [info ] [MainThread]: Found 7 models, 9 sources, 434 macros
[0m19:44:39.389369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e06f5dd-2c5a-40fe-8f16-e806783cfb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C71B78C0>]}
[0m19:44:39.390455 [warn ] [MainThread]: The selection criterion 'mart_summary' does not match any enabled nodes
[0m19:44:39.393953 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:44:39.398042 [debug] [MainThread]: Command end result
[0m19:44:39.548538 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:44:39.553540 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:44:39.562247 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:44:39.564245 [debug] [MainThread]: Command `dbt run` succeeded at 19:44:39.564245 after 3.25 seconds
[0m19:44:39.565607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C260F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C4EC6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C4EC57C0>]}
[0m19:44:39.566621 [debug] [MainThread]: Flushing usage events
[0m19:44:39.616383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:33.144494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BB4EBEF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BB4065A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BB207E990>]}


============================== 19:45:33.144494 | 0882495e-dc5a-4866-8e8b-4c2e9ef15071 ==============================
[0m19:45:33.144494 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:45:33.144494 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart_customer_analysis', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m19:45:33.650377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0882495e-dc5a-4866-8e8b-4c2e9ef15071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BB4F31400>]}
[0m19:45:33.938747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0882495e-dc5a-4866-8e8b-4c2e9ef15071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BB4737F50>]}
[0m19:45:33.939746 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:45:34.414719 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:45:34.626355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:45:34.626355 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_customer_analysis.sql
[0m19:45:35.170712 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_ecommerce.mart_customer_analysis' (models\03 gold\mart_customer_analysis.sql) depends on a node named 'dim_customers' which was not found
[0m19:45:35.170712 [debug] [MainThread]: Command `dbt run` failed at 19:45:35.170712 after 2.27 seconds
[0m19:45:35.170712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BB65F1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BB3D6D3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BB700BFB0>]}
[0m19:45:35.170712 [debug] [MainThread]: Flushing usage events
[0m19:45:35.180737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:52.084076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8FE644CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8FF036540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8FF035A60>]}


============================== 19:45:52.089079 | ee46f2af-1000-480c-b89f-ee0dca483dbe ==============================
[0m19:45:52.089079 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:45:52.090077 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart_customer_analysis', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m19:45:52.866720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee46f2af-1000-480c-b89f-ee0dca483dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8FF9F5A90>]}
[0m19:45:53.132627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee46f2af-1000-480c-b89f-ee0dca483dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8FE54F140>]}
[0m19:45:53.134629 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:45:53.596620 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:45:53.852026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:45:53.853028 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_customer_analysis.sql
[0m19:45:54.805123 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_ecommerce.mart_customer_analysis' (models\03 gold\mart_customer_analysis.sql) depends on a node named 'dim_customers' which was not found
[0m19:45:54.807113 [debug] [MainThread]: Command `dbt run` failed at 19:45:54.806113 after 3.13 seconds
[0m19:45:54.807113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8FF036540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8FA60E9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C88115A960>]}
[0m19:45:54.808115 [debug] [MainThread]: Flushing usage events
[0m19:45:54.850708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:45.654031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEFA666DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEFA613FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF6003920>]}


============================== 19:46:45.661034 | 32f6a991-e173-408b-bb46-81dee72bc8dd ==============================
[0m19:46:45.661034 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:46:45.662031 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mar_product_performance', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m19:46:46.238055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32f6a991-e173-408b-bb46-81dee72bc8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEFA876540>]}
[0m19:46:46.531673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32f6a991-e173-408b-bb46-81dee72bc8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEFA8763F0>]}
[0m19:46:46.533488 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:46:47.183557 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:46:47.468308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m19:46:47.468308 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_customer_analysis.sql
[0m19:46:47.469302 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_product_performance.sql
[0m19:46:48.233497 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_ecommerce.mart_customer_analysis' (models\03 gold\mart_customer_analysis.sql) depends on a node named 'dim_customers' which was not found
[0m19:46:48.235056 [debug] [MainThread]: Command `dbt run` failed at 19:46:48.235056 after 2.91 seconds
[0m19:46:48.235056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF8F67B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEFACEC260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEFAC98BC0>]}
[0m19:46:48.235056 [debug] [MainThread]: Flushing usage events
[0m19:46:48.262074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:16.930547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E1A510680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E1B15C2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E18516660>]}


============================== 19:48:16.936175 | 6f9cee69-fb26-4c8d-8005-344d014efbe9 ==============================
[0m19:48:16.936175 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:48:16.936175 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mar_geographic_analysis', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m19:48:17.548479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f9cee69-fb26-4c8d-8005-344d014efbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E1C899490>]}
[0m19:48:17.723501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f9cee69-fb26-4c8d-8005-344d014efbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E1C8C2E10>]}
[0m19:48:17.723501 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:48:18.209165 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:48:18.404736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m19:48:18.405738 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_customer_analysis.sql
[0m19:48:18.405738 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_product_performance.sql
[0m19:48:18.405738 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_geographic_analysis.sql
[0m19:48:18.940025 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_ecommerce.mart_customer_analysis' (models\03 gold\mart_customer_analysis.sql) depends on a node named 'dim_customers' which was not found
[0m19:48:18.941028 [debug] [MainThread]: Command `dbt run` failed at 19:48:18.941028 after 2.24 seconds
[0m19:48:18.942027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E1AF81820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E1CC0EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E1CC0C950>]}
[0m19:48:18.942027 [debug] [MainThread]: Flushing usage events
[0m19:48:19.045769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:58.065922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C1F44710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BF0CADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C29BB950>]}


============================== 19:52:58.072867 | 390483b4-b4b1-4a8e-9a2b-b0a1c08f3694 ==============================
[0m19:52:58.072867 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:52:58.073871 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_customers', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m19:52:58.752420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '390483b4-b4b1-4a8e-9a2b-b0a1c08f3694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C23F9340>]}
[0m19:52:58.922732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '390483b4-b4b1-4a8e-9a2b-b0a1c08f3694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C2B174A0>]}
[0m19:52:58.932253 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:52:59.373387 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:52:59.606752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m19:52:59.607753 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_customer_analysis.sql
[0m19:52:59.607753 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_delivery_performance.sql
[0m19:52:59.608537 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_payment_analysis.sql
[0m19:52:59.608537 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\02 silver\dim_customers.sql
[0m19:52:59.608537 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_geographic_analysis.sql
[0m19:52:59.609536 [debug] [MainThread]: Partial parsing: added file: olist_ecommerce://models\03 gold\mart_product_performance.sql
[0m19:53:00.260699 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
[0m19:53:00.284949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '390483b4-b4b1-4a8e-9a2b-b0a1c08f3694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C4B63AD0>]}
[0m19:53:00.423725 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:53:00.427727 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:53:00.536160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '390483b4-b4b1-4a8e-9a2b-b0a1c08f3694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C49DC410>]}
[0m19:53:00.536160 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m19:53:00.536160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390483b4-b4b1-4a8e-9a2b-b0a1c08f3694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BFCA5AC0>]}
[0m19:53:00.543969 [info ] [MainThread]: 
[0m19:53:00.543969 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:53:00.549483 [info ] [MainThread]: 
[0m19:53:00.552839 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:53:00.553839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:53:01.083194 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:53:01.084194 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:53:01.084194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:01.116950 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m19:53:01.119159 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:53:01.131865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:53:01.145673 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:53:01.146677 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:53:01.146677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:01.167675 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:53:01.169224 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:53:01.169224 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:53:01.175129 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.005 seconds
[0m19:53:01.178141 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:53:01.179797 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:53:01.195795 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:01.196797 [debug] [MainThread]: On master: BEGIN
[0m19:53:01.196797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:01.218836 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m19:53:01.219836 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:01.220953 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:53:01.228736 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:53:01.230742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390483b4-b4b1-4a8e-9a2b-b0a1c08f3694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C4A0C170>]}
[0m19:53:01.231746 [debug] [MainThread]: On master: ROLLBACK
[0m19:53:01.233739 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:01.233739 [debug] [MainThread]: On master: BEGIN
[0m19:53:01.237303 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:53:01.238304 [debug] [MainThread]: On master: COMMIT
[0m19:53:01.239303 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:01.239303 [debug] [MainThread]: On master: COMMIT
[0m19:53:01.240304 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:53:01.240304 [debug] [MainThread]: On master: Close
[0m19:53:01.249310 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.dim_customers
[0m19:53:01.249310 [info ] [Thread-1 (]: 1 of 1 START sql table model public.dim_customers .............................. [RUN]
[0m19:53:01.250310 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.dim_customers'
[0m19:53:01.252170 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.dim_customers
[0m19:53:01.268012 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.dim_customers"
[0m19:53:01.270012 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.dim_customers
[0m19:53:01.369980 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.dim_customers"
[0m19:53:01.371975 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m19:53:01.372770 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: BEGIN
[0m19:53:01.373774 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:53:01.398341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m19:53:01.399343 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m19:53:01.401339 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */

  
    

  create  table "warehouse"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."olist_customers_dataset"
  );
  
[0m19:53:01.584486 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.182 seconds
[0m19:53:01.607523 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m19:53:01.607523 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
alter table "warehouse"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:53:01.610524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:53:01.615523 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m19:53:01.616525 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
alter table "warehouse"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:53:01.618524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:53:01.653540 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m19:53:01.654543 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m19:53:01.655541 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m19:53:01.682537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m19:53:01.697540 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."dim_customers__dbt_backup"
[0m19:53:01.709334 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m19:53:01.709334 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
drop table if exists "warehouse"."public"."dim_customers__dbt_backup" cascade
[0m19:53:01.724159 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m19:53:01.728158 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: Close
[0m19:53:01.734166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390483b4-b4b1-4a8e-9a2b-b0a1c08f3694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BFDF3620>]}
[0m19:53:01.735472 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.dim_customers ......................... [[32mSELECT 99441[0m in 0.48s]
[0m19:53:01.736997 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.dim_customers
[0m19:53:01.738997 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:01.739996 [debug] [MainThread]: On master: BEGIN
[0m19:53:01.739996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:53:01.761380 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m19:53:01.762384 [debug] [MainThread]: On master: COMMIT
[0m19:53:01.763391 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:01.763391 [debug] [MainThread]: On master: COMMIT
[0m19:53:01.765383 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:53:01.766383 [debug] [MainThread]: On master: Close
[0m19:53:01.768386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:01.768386 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:53:01.769396 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m19:53:01.769925 [debug] [MainThread]: Connection 'model.olist_ecommerce.dim_customers' was properly closed.
[0m19:53:01.770924 [info ] [MainThread]: 
[0m19:53:01.770924 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m19:53:01.772920 [debug] [MainThread]: Command end result
[0m19:53:01.807084 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:53:01.811084 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:53:01.830081 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:53:01.830081 [info ] [MainThread]: 
[0m19:53:01.831081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:53:01.832081 [info ] [MainThread]: 
[0m19:53:01.833080 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:53:01.835081 [debug] [MainThread]: Command `dbt run` succeeded at 19:53:01.835081 after 4.00 seconds
[0m19:53:01.835081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C2C1F260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C2A21F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C2A21940>]}
[0m19:53:01.836079 [debug] [MainThread]: Flushing usage events
[0m19:53:01.886153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:28.287127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417C8D0EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417ACDE300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417D38A210>]}


============================== 19:53:28.294153 | 23ac3857-42ce-4526-b15c-2f164d838538 ==============================
[0m19:53:28.294153 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:53:28.295127 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --model gold', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:53:28.296127 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m19:53:28.297128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '23ac3857-42ce-4526-b15c-2f164d838538', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417D595970>]}
[0m19:53:29.005460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23ac3857-42ce-4526-b15c-2f164d838538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417EC06CC0>]}
[0m19:53:29.184870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23ac3857-42ce-4526-b15c-2f164d838538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417A85AB10>]}
[0m19:53:29.185872 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:53:29.599424 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:53:29.804079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:53:29.804079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:53:29.811057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
[0m19:53:29.854341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23ac3857-42ce-4526-b15c-2f164d838538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417F001FA0>]}
[0m19:53:29.942667 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:53:29.945667 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:53:29.977868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23ac3857-42ce-4526-b15c-2f164d838538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417F042A20>]}
[0m19:53:29.977868 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m19:53:29.979512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23ac3857-42ce-4526-b15c-2f164d838538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417F0018B0>]}
[0m19:53:29.980033 [warn ] [MainThread]: The selection criterion 'gold' does not match any enabled nodes
[0m19:53:29.983032 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:53:29.987803 [debug] [MainThread]: Command end result
[0m19:53:30.016368 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:53:30.019368 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:53:30.024370 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:53:30.026086 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:53:30.028084 [debug] [MainThread]: Command `dbt run` succeeded at 19:53:30.028084 after 1.97 seconds
[0m19:53:30.028084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417CD137A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417A6C2EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002417DA22480>]}
[0m19:53:30.029084 [debug] [MainThread]: Flushing usage events
[0m19:53:30.041819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:41.628088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D1DDDFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D1D963F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D1D94620>]}


============================== 19:53:41.632460 | 8e855c28-a38f-4b70-8efb-0637be091a8e ==============================
[0m19:53:41.632460 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:53:41.633461 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --model 03 gold', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt'}
[0m19:53:41.634460 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m19:53:41.634460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e855c28-a38f-4b70-8efb-0637be091a8e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D1D963F0>]}
[0m19:53:42.222261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e855c28-a38f-4b70-8efb-0637be091a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D3B53EF0>]}
[0m19:53:42.507992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e855c28-a38f-4b70-8efb-0637be091a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D2366B70>]}
[0m19:53:42.509581 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:53:43.022059 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:53:43.336529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:53:43.337531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:53:43.344507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
[0m19:53:43.384345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e855c28-a38f-4b70-8efb-0637be091a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D3DB3AD0>]}
[0m19:53:43.472433 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:53:43.475430 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:53:43.513238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e855c28-a38f-4b70-8efb-0637be091a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D4246000>]}
[0m19:53:43.514239 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m19:53:43.515238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e855c28-a38f-4b70-8efb-0637be091a8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D41EB470>]}
[0m19:53:43.516268 [warn ] [MainThread]: The selection criterion '03' does not match any enabled nodes
[0m19:53:43.517240 [warn ] [MainThread]: The selection criterion 'gold' does not match any enabled nodes
[0m19:53:43.520238 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:53:43.525143 [debug] [MainThread]: Command end result
[0m19:53:43.563091 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:53:43.566696 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:53:43.575697 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:53:43.575697 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:53:43.577699 [debug] [MainThread]: Command `dbt run` succeeded at 19:53:43.577699 after 2.24 seconds
[0m19:53:43.578697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D16468A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D38424E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246D3842510>]}
[0m19:53:43.578697 [debug] [MainThread]: Flushing usage events
[0m19:53:43.590328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:54:21.392836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB27C5CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB2B9E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB54D6CF0>]}


============================== 19:54:21.397578 | 21929c54-f6ef-4259-bb9b-44057939873a ==============================
[0m19:54:21.397578 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:54:21.398756 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select mart_sales_summary', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m19:54:21.931310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21929c54-f6ef-4259-bb9b-44057939873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB6DD5A90>]}
[0m19:54:22.156329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21929c54-f6ef-4259-bb9b-44057939873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB6DD4080>]}
[0m19:54:22.157327 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:54:22.597063 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:54:22.859217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:54:22.859217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:54:22.870219 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
[0m19:54:22.924638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21929c54-f6ef-4259-bb9b-44057939873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB716B920>]}
[0m19:54:23.054291 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:54:23.059291 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:54:23.118506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21929c54-f6ef-4259-bb9b-44057939873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB7543D40>]}
[0m19:54:23.119560 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m19:54:23.120948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21929c54-f6ef-4259-bb9b-44057939873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB71ED340>]}
[0m19:54:23.125884 [info ] [MainThread]: 
[0m19:54:23.127463 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:54:23.129457 [info ] [MainThread]: 
[0m19:54:23.133683 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:54:23.136490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:54:23.485481 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:54:23.485481 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:54:23.485481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:23.506481 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m19:54:23.507481 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:54:23.514481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:54:23.522194 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:54:23.523197 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:54:23.523197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:23.541192 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m19:54:23.541192 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:54:23.541192 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:54:23.546192 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.004 seconds
[0m19:54:23.551157 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:54:23.554157 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:54:23.566919 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:23.566919 [debug] [MainThread]: On master: BEGIN
[0m19:54:23.567918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:54:23.581921 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m19:54:23.581921 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:23.582918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:54:23.586917 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:54:23.587918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21929c54-f6ef-4259-bb9b-44057939873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB70CDF70>]}
[0m19:54:23.587918 [debug] [MainThread]: On master: ROLLBACK
[0m19:54:23.588916 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:23.589918 [debug] [MainThread]: On master: BEGIN
[0m19:54:23.590918 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:54:23.590918 [debug] [MainThread]: On master: COMMIT
[0m19:54:23.591918 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:23.591918 [debug] [MainThread]: On master: COMMIT
[0m19:54:23.592919 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:54:23.592919 [debug] [MainThread]: On master: Close
[0m19:54:23.598956 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_sales_summary
[0m19:54:23.598956 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_sales_summary ......................... [RUN]
[0m19:54:23.599954 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_sales_summary'
[0m19:54:23.600953 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_sales_summary
[0m19:54:23.607955 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_sales_summary"
[0m19:54:23.609954 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_sales_summary
[0m19:54:23.653789 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_sales_summary"
[0m19:54:23.661447 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m19:54:23.662400 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: BEGIN
[0m19:54:23.662928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:54:23.677147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m19:54:23.677663 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m19:54:23.677663 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_sales_summary"} */

  
    

  create  table "warehouse"."public"."mart_sales_summary__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    DATE_TRUNC('month', order_purchase_timestamp) as month_year,
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT customer_id) as unique_customers,
    SUM(total_order_value) as total_revenue,
    AVG(total_order_value) as avg_order_value,
    SUM(total_items) as total_items_sold,
    AVG(delivery_days_actual) as avg_delivery_days,
    
    -- Métricas de crescimento
    LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) as prev_month_orders,
    LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) as prev_month_revenue,
    
    -- Calcular crescimento percentual
    CASE 
        WHEN LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) > 0
        THEN ROUND(((COUNT(DISTINCT order_id) - LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))) * 100.0 / LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))), 2)
        ELSE NULL
    END as orders_growth_pct,
    
    CASE 
        WHEN LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) > 0
        THEN ROUND(((SUM(total_order_value) - LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))) * 100.0 / LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))), 2)
        ELSE NULL
    END as revenue_growth_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."fact_orders"
WHERE order_status = 'delivered'
    AND order_purchase_timestamp IS NOT NULL
GROUP BY DATE_TRUNC('month', order_purchase_timestamp)
ORDER BY month_year
  );
  
[0m19:54:23.679664 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fact_orders" does not exist
LINE 41: FROM "warehouse"."public"."fact_orders"
              ^

[0m19:54:23.679664 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: ROLLBACK
[0m19:54:23.680662 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: Close
[0m19:54:23.699660 [debug] [Thread-1 (]: Database Error in model mart_sales_summary (models\03 gold\mart_sales_summary.sql)
  relation "public.fact_orders" does not exist
  LINE 41: FROM "warehouse"."public"."fact_orders"
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_sales_summary.sql
[0m19:54:23.702664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21929c54-f6ef-4259-bb9b-44057939873a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB4E54890>]}
[0m19:54:23.703663 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.mart_sales_summary ................ [[31mERROR[0m in 0.10s]
[0m19:54:23.704663 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_sales_summary
[0m19:54:23.705663 [debug] [Thread-7 (]: Marking all children of 'model.olist_ecommerce.mart_sales_summary' to be skipped because of status 'error'.  Reason: Database Error in model mart_sales_summary (models\03 gold\mart_sales_summary.sql)
  relation "public.fact_orders" does not exist
  LINE 41: FROM "warehouse"."public"."fact_orders"
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_sales_summary.sql.
[0m19:54:23.709608 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:23.709608 [debug] [MainThread]: On master: BEGIN
[0m19:54:23.710610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:54:23.727610 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:54:23.728612 [debug] [MainThread]: On master: COMMIT
[0m19:54:23.729611 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:23.729611 [debug] [MainThread]: On master: COMMIT
[0m19:54:23.731609 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:54:23.731609 [debug] [MainThread]: On master: Close
[0m19:54:23.732612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:23.733609 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:54:23.734610 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m19:54:23.735612 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_sales_summary' was properly closed.
[0m19:54:23.735612 [info ] [MainThread]: 
[0m19:54:23.736615 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m19:54:23.738607 [debug] [MainThread]: Command end result
[0m19:54:23.763471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:54:23.763471 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:54:23.772035 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:54:23.772035 [info ] [MainThread]: 
[0m19:54:23.772035 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:54:23.772035 [info ] [MainThread]: 
[0m19:54:23.772035 [error] [MainThread]: [31mFailure in model mart_sales_summary (models\03 gold\mart_sales_summary.sql)[0m
[0m19:54:23.772035 [error] [MainThread]:   Database Error in model mart_sales_summary (models\03 gold\mart_sales_summary.sql)
  relation "public.fact_orders" does not exist
  LINE 41: FROM "warehouse"."public"."fact_orders"
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_sales_summary.sql
[0m19:54:23.782041 [info ] [MainThread]: 
[0m19:54:23.782655 [info ] [MainThread]:   compiled code at target\compiled\olist_ecommerce\models\03 gold\mart_sales_summary.sql
[0m19:54:23.782655 [info ] [MainThread]: 
[0m19:54:23.784734 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:54:23.785736 [debug] [MainThread]: Command `dbt run` failed at 19:54:23.785736 after 2.64 seconds
[0m19:54:23.785736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB5431B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB51807A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB4E2B290>]}
[0m19:54:23.786735 [debug] [MainThread]: Flushing usage events
[0m19:54:23.828648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:54:39.338689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76C9C71A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76F6ABA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76F6A9010>]}


============================== 19:54:39.346338 | 7e597223-b629-41d9-9e35-21d5b64adbe5 ==============================
[0m19:54:39.346338 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:54:39.347340 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart_product_performance', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m19:54:40.341242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e597223-b629-41d9-9e35-21d5b64adbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76F7123C0>]}
[0m19:54:40.634209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e597223-b629-41d9-9e35-21d5b64adbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7712020C0>]}
[0m19:54:40.643178 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:54:41.142848 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:54:41.462282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:54:41.463614 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:54:41.480159 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
[0m19:54:41.560611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e597223-b629-41d9-9e35-21d5b64adbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76F750BC0>]}
[0m19:54:41.659634 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:54:41.661648 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:54:41.694898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e597223-b629-41d9-9e35-21d5b64adbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C771732240>]}
[0m19:54:41.695899 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m19:54:41.695899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e597223-b629-41d9-9e35-21d5b64adbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7715E3290>]}
[0m19:54:41.698898 [info ] [MainThread]: 
[0m19:54:41.698898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:54:41.699898 [info ] [MainThread]: 
[0m19:54:41.700897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:54:41.702902 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:54:41.936249 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:54:41.936249 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:54:41.936249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:41.962003 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m19:54:41.969022 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:54:41.974082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:54:41.984025 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:54:41.984025 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:54:41.984025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:42.005459 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m19:54:42.007470 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:54:42.008078 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:54:42.008078 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.004 seconds
[0m19:54:42.008078 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:54:42.015649 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:54:42.029175 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:42.029175 [debug] [MainThread]: On master: BEGIN
[0m19:54:42.029175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:54:42.039864 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:54:42.049882 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:42.049882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:54:42.049882 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:54:42.056558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e597223-b629-41d9-9e35-21d5b64adbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C771350B90>]}
[0m19:54:42.056558 [debug] [MainThread]: On master: ROLLBACK
[0m19:54:42.056558 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:42.056558 [debug] [MainThread]: On master: BEGIN
[0m19:54:42.056558 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:54:42.060072 [debug] [MainThread]: On master: COMMIT
[0m19:54:42.060072 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:42.060072 [debug] [MainThread]: On master: COMMIT
[0m19:54:42.060072 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:54:42.060072 [debug] [MainThread]: On master: Close
[0m19:54:42.060072 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_product_performance
[0m19:54:42.068087 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_product_performance ................... [RUN]
[0m19:54:42.068087 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_product_performance'
[0m19:54:42.068087 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_product_performance
[0m19:54:42.070643 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_product_performance"
[0m19:54:42.070643 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_product_performance
[0m19:54:42.136915 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_product_performance"
[0m19:54:42.137916 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m19:54:42.137916 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: BEGIN
[0m19:54:42.138916 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:54:42.153478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m19:54:42.153478 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m19:54:42.153478 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_product_performance"} */

  
    

  create  table "warehouse"."public"."mart_product_performance__dbt_tmp"
  
  
    as
  
  (
    

WITH product_sales AS (
    SELECT 
        p.product_id,
        p.category_en as product_category,
        p.category_pt as product_category_pt,
        COUNT(foi.order_item_id) as total_sales,
        SUM(foi.price) as total_revenue,
        SUM(foi.freight_value) as total_freight,
        AVG(foi.price) as avg_price,
        AVG(p.product_weight_g) as avg_weight,
        AVG(p.product_volume_cm3) as avg_volume
    FROM "warehouse"."public"."fact_order_items" foi
    JOIN "warehouse"."public"."dim_products" p ON foi.product_id = p.product_id
    JOIN "warehouse"."public"."fact_orders" o ON foi.order_id = o.order_id
    WHERE o.order_status = 'delivered'
    GROUP BY p.product_id, p.category_en, p.category_pt
),

category_totals AS (
    SELECT 
        product_category,
        SUM(total_revenue) as category_total_revenue
    FROM product_sales
    GROUP BY product_category
)

SELECT 
    ps.product_category,
    COUNT(ps.product_id) as unique_products,
    SUM(ps.total_sales) as total_units_sold,
    SUM(ps.total_revenue) as category_revenue,
    AVG(ps.avg_price) as avg_product_price,
    AVG(ps.avg_weight) as avg_product_weight,
    AVG(ps.avg_volume) as avg_product_volume,
    
    -- Ranking de categorias
    RANK() OVER (ORDER BY SUM(ps.total_revenue) DESC) as revenue_rank,
    RANK() OVER (ORDER BY SUM(ps.total_sales) DESC) as volume_rank,
    
    -- Participação no total
    ROUND((SUM(ps.total_revenue) * 100.0 / SUM(SUM(ps.total_revenue)) OVER ()), 2) as revenue_share_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM product_sales ps
GROUP BY ps.product_category
ORDER BY category_revenue DESC
  );
  
[0m19:54:42.155477 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fact_orders" does not exist
LINE 27:     JOIN "warehouse"."public"."fact_orders" o ON foi.order_i...
                  ^

[0m19:54:42.156500 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: ROLLBACK
[0m19:54:42.157478 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: Close
[0m19:54:42.169603 [debug] [Thread-1 (]: Database Error in model mart_product_performance (models\03 gold\mart_product_performance.sql)
  relation "public.fact_orders" does not exist
  LINE 27:     JOIN "warehouse"."public"."fact_orders" o ON foi.order_i...
                    ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_product_performance.sql
[0m19:54:42.172631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e597223-b629-41d9-9e35-21d5b64adbe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76F024A70>]}
[0m19:54:42.172631 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.mart_product_performance .......... [[31mERROR[0m in 0.10s]
[0m19:54:42.173628 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_product_performance
[0m19:54:42.174629 [debug] [Thread-7 (]: Marking all children of 'model.olist_ecommerce.mart_product_performance' to be skipped because of status 'error'.  Reason: Database Error in model mart_product_performance (models\03 gold\mart_product_performance.sql)
  relation "public.fact_orders" does not exist
  LINE 27:     JOIN "warehouse"."public"."fact_orders" o ON foi.order_i...
                    ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_product_performance.sql.
[0m19:54:42.177605 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:42.177605 [debug] [MainThread]: On master: BEGIN
[0m19:54:42.177605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:54:42.192192 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m19:54:42.192807 [debug] [MainThread]: On master: COMMIT
[0m19:54:42.192807 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:42.193898 [debug] [MainThread]: On master: COMMIT
[0m19:54:42.195227 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:54:42.195748 [debug] [MainThread]: On master: Close
[0m19:54:42.197746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:42.198749 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:54:42.198749 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m19:54:42.198749 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_product_performance' was properly closed.
[0m19:54:42.199744 [info ] [MainThread]: 
[0m19:54:42.199744 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m19:54:42.201748 [debug] [MainThread]: Command end result
[0m19:54:42.230082 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:54:42.234082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:54:42.268262 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:54:42.269261 [info ] [MainThread]: 
[0m19:54:42.270265 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:54:42.271263 [info ] [MainThread]: 
[0m19:54:42.272261 [error] [MainThread]: [31mFailure in model mart_product_performance (models\03 gold\mart_product_performance.sql)[0m
[0m19:54:42.273260 [error] [MainThread]:   Database Error in model mart_product_performance (models\03 gold\mart_product_performance.sql)
  relation "public.fact_orders" does not exist
  LINE 27:     JOIN "warehouse"."public"."fact_orders" o ON foi.order_i...
                    ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_product_performance.sql
[0m19:54:42.274259 [info ] [MainThread]: 
[0m19:54:42.275261 [info ] [MainThread]:   compiled code at target\compiled\olist_ecommerce\models\03 gold\mart_product_performance.sql
[0m19:54:42.275261 [info ] [MainThread]: 
[0m19:54:42.276261 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:54:42.278260 [debug] [MainThread]: Command `dbt run` failed at 19:54:42.278260 after 3.24 seconds
[0m19:54:42.279261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76FC09760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76FB96420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76FDA4260>]}
[0m19:54:42.279261 [debug] [MainThread]: Flushing usage events
[0m19:54:42.293264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:54:54.986265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BFA80CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C2EC6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C3008D10>]}


============================== 19:54:54.991264 | a059dea5-d3a9-4408-b1b8-c4196aa6a5e2 ==============================
[0m19:54:54.991264 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:54:54.991264 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart_payment_analysis', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m19:54:55.722009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a059dea5-d3a9-4408-b1b8-c4196aa6a5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BEE63A40>]}
[0m19:54:55.917055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a059dea5-d3a9-4408-b1b8-c4196aa6a5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C30F30B0>]}
[0m19:54:55.918055 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:54:56.403975 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:54:56.624811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:54:56.624811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:54:56.633057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
[0m19:54:56.669824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a059dea5-d3a9-4408-b1b8-c4196aa6a5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C4678B30>]}
[0m19:54:56.806656 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:54:56.809656 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:54:56.867904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a059dea5-d3a9-4408-b1b8-c4196aa6a5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C4A528A0>]}
[0m19:54:56.868628 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m19:54:56.870154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a059dea5-d3a9-4408-b1b8-c4196aa6a5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C4A31C40>]}
[0m19:54:56.875153 [info ] [MainThread]: 
[0m19:54:56.876154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:54:56.877153 [info ] [MainThread]: 
[0m19:54:56.878156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:54:56.880150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:54:57.081299 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:54:57.090820 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:54:57.090820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:57.119817 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m19:54:57.122483 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:54:57.134391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:54:57.150237 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:54:57.150754 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:54:57.151752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:57.172268 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:54:57.173271 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:54:57.174270 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:54:57.181788 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.007 seconds
[0m19:54:57.184790 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:54:57.186786 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:54:57.204278 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:57.204278 [debug] [MainThread]: On master: BEGIN
[0m19:54:57.204278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:54:57.231856 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m19:54:57.232411 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:57.233118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:54:57.242516 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m19:54:57.243831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a059dea5-d3a9-4408-b1b8-c4196aa6a5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C4A586B0>]}
[0m19:54:57.243831 [debug] [MainThread]: On master: ROLLBACK
[0m19:54:57.244829 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:57.244829 [debug] [MainThread]: On master: BEGIN
[0m19:54:57.246832 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:54:57.247829 [debug] [MainThread]: On master: COMMIT
[0m19:54:57.247829 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:57.248827 [debug] [MainThread]: On master: COMMIT
[0m19:54:57.249830 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:54:57.250831 [debug] [MainThread]: On master: Close
[0m19:54:57.257935 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_payment_analysis
[0m19:54:57.258454 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_payment_analysis ...................... [RUN]
[0m19:54:57.260452 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_payment_analysis'
[0m19:54:57.261451 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_payment_analysis
[0m19:54:57.277989 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_payment_analysis"
[0m19:54:57.279985 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_payment_analysis
[0m19:54:57.340827 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_payment_analysis"
[0m19:54:57.342828 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m19:54:57.343829 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: BEGIN
[0m19:54:57.343829 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:54:57.364702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m19:54:57.365812 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m19:54:57.366326 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_payment_analysis"} */

  
    

  create  table "warehouse"."public"."mart_payment_analysis__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    fp.payment_type_clean as payment_method,
    fp.installment_category,
    COUNT(*) as transaction_count,
    COUNT(DISTINCT fp.order_id) as unique_orders,
    SUM(fp.payment_value) as total_payment_value,
    AVG(fp.payment_value) as avg_payment_value,
    AVG(fp.payment_installments) as avg_installments,
    
    -- Participação por método
    ROUND((COUNT(*) * 100.0 / SUM(COUNT(*)) OVER ()), 2) as transaction_share_pct,
    ROUND((SUM(fp.payment_value) * 100.0 / SUM(SUM(fp.payment_value)) OVER ()), 2) as value_share_pct,
    
    -- Análise temporal
    DATE_TRUNC('month', fo.order_purchase_timestamp) as month_year,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."fact_payments" fp
JOIN "warehouse"."public"."fact_orders" fo ON fp.order_id = fo.order_id
WHERE fo.order_status = 'delivered'
    AND fo.order_purchase_timestamp IS NOT NULL
GROUP BY fp.payment_type_clean, fp.installment_category, DATE_TRUNC('month', fo.order_purchase_timestamp)
ORDER BY month_year DESC, total_payment_value DESC
  );
  
[0m19:54:57.369324 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fact_orders" does not exist
LINE 32: JOIN "warehouse"."public"."fact_orders" fo ON fp.order_id = ...
              ^

[0m19:54:57.370325 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: ROLLBACK
[0m19:54:57.371326 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: Close
[0m19:54:57.387844 [debug] [Thread-1 (]: Database Error in model mart_payment_analysis (models\03 gold\mart_payment_analysis.sql)
  relation "public.fact_orders" does not exist
  LINE 32: JOIN "warehouse"."public"."fact_orders" fo ON fp.order_id = ...
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_payment_analysis.sql
[0m19:54:57.390847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a059dea5-d3a9-4408-b1b8-c4196aa6a5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C2354B30>]}
[0m19:54:57.391848 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.mart_payment_analysis ............. [[31mERROR[0m in 0.13s]
[0m19:54:57.392845 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_payment_analysis
[0m19:54:57.393845 [debug] [Thread-7 (]: Marking all children of 'model.olist_ecommerce.mart_payment_analysis' to be skipped because of status 'error'.  Reason: Database Error in model mart_payment_analysis (models\03 gold\mart_payment_analysis.sql)
  relation "public.fact_orders" does not exist
  LINE 32: JOIN "warehouse"."public"."fact_orders" fo ON fp.order_id = ...
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_payment_analysis.sql.
[0m19:54:57.397739 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:57.397739 [debug] [MainThread]: On master: BEGIN
[0m19:54:57.397739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:54:57.414257 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:54:57.414257 [debug] [MainThread]: On master: COMMIT
[0m19:54:57.415257 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:57.416259 [debug] [MainThread]: On master: COMMIT
[0m19:54:57.417258 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:54:57.418257 [debug] [MainThread]: On master: Close
[0m19:54:57.419258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:57.420256 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:54:57.421258 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m19:54:57.422257 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_payment_analysis' was properly closed.
[0m19:54:57.422257 [info ] [MainThread]: 
[0m19:54:57.424112 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m19:54:57.424893 [debug] [MainThread]: Command end result
[0m19:54:57.453580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:54:57.456581 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:54:57.471402 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:54:57.472403 [info ] [MainThread]: 
[0m19:54:57.478405 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:54:57.480403 [info ] [MainThread]: 
[0m19:54:57.481403 [error] [MainThread]: [31mFailure in model mart_payment_analysis (models\03 gold\mart_payment_analysis.sql)[0m
[0m19:54:57.483404 [error] [MainThread]:   Database Error in model mart_payment_analysis (models\03 gold\mart_payment_analysis.sql)
  relation "public.fact_orders" does not exist
  LINE 32: JOIN "warehouse"."public"."fact_orders" fo ON fp.order_id = ...
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_payment_analysis.sql
[0m19:54:57.485402 [info ] [MainThread]: 
[0m19:54:57.486403 [info ] [MainThread]:   compiled code at target\compiled\olist_ecommerce\models\03 gold\mart_payment_analysis.sql
[0m19:54:57.487404 [info ] [MainThread]: 
[0m19:54:57.487404 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:54:57.490402 [debug] [MainThread]: Command `dbt run` failed at 19:54:57.489402 after 2.72 seconds
[0m19:54:57.490402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BFC225D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C3008D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C30D4380>]}
[0m19:54:57.491405 [debug] [MainThread]: Flushing usage events
[0m19:54:57.499401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:55:12.807535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBB7249E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBB1C3DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBB1C3E60>]}


============================== 19:55:12.815536 | e9911db0-3988-4345-951f-72bd6f429b0a ==============================
[0m19:55:12.815536 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:55:12.816534 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart_geographic_analysis', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m19:55:13.543522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9911db0-3988-4345-951f-72bd6f429b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBB871EE0>]}
[0m19:55:13.767943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9911db0-3988-4345-951f-72bd6f429b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBB2327B0>]}
[0m19:55:13.769536 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:55:14.460174 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:55:14.784340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:14.784340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:14.792926 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m19:55:14.853100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9911db0-3988-4345-951f-72bd6f429b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBCEEA060>]}
[0m19:55:14.948841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:55:14.952842 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:55:14.986406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9911db0-3988-4345-951f-72bd6f429b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBD2494C0>]}
[0m19:55:14.986406 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m19:55:14.987406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9911db0-3988-4345-951f-72bd6f429b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBCDF8B00>]}
[0m19:55:14.989660 [info ] [MainThread]: 
[0m19:55:14.990669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:55:14.990669 [info ] [MainThread]: 
[0m19:55:14.991670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:55:14.993670 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:55:15.202412 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:55:15.203410 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:55:15.203410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:15.232530 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m19:55:15.233532 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:55:15.241164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:55:15.248164 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:55:15.248164 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:55:15.248164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:15.263172 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m19:55:15.263172 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:55:15.263172 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:55:15.267164 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.003 seconds
[0m19:55:15.268163 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:55:15.269164 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:55:15.279163 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:15.280164 [debug] [MainThread]: On master: BEGIN
[0m19:55:15.280164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:55:15.295165 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m19:55:15.295165 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:15.296164 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:55:15.300164 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:55:15.301164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9911db0-3988-4345-951f-72bd6f429b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBCDCDEE0>]}
[0m19:55:15.301164 [debug] [MainThread]: On master: ROLLBACK
[0m19:55:15.302163 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:15.303164 [debug] [MainThread]: On master: BEGIN
[0m19:55:15.305171 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:55:15.305171 [debug] [MainThread]: On master: COMMIT
[0m19:55:15.306165 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:15.306165 [debug] [MainThread]: On master: COMMIT
[0m19:55:15.307166 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:55:15.307166 [debug] [MainThread]: On master: Close
[0m19:55:15.310499 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_geographic_analysis
[0m19:55:15.310499 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_geographic_analysis ................... [RUN]
[0m19:55:15.314517 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_geographic_analysis'
[0m19:55:15.314517 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_geographic_analysis
[0m19:55:15.318035 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_geographic_analysis"
[0m19:55:15.318035 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_geographic_analysis
[0m19:55:15.376636 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_geographic_analysis"
[0m19:55:15.377637 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m19:55:15.378635 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: BEGIN
[0m19:55:15.378635 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:55:15.396008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:55:15.397009 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m19:55:15.397009 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_geographic_analysis"} */

  
    

  create  table "warehouse"."public"."mart_geographic_analysis__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.customer_state,
    c.customer_city,
    COUNT(DISTINCT c.customer_id) as total_customers,
    COUNT(f.order_id) as total_orders,
    SUM(f.total_order_value) as total_revenue,
    AVG(f.total_order_value) as avg_order_value,
    SUM(f.total_items) as total_items_sold,
    
    -- Métricas por cliente
    ROUND(SUM(f.total_order_value) / COUNT(DISTINCT c.customer_id), 2) as revenue_per_customer,
    ROUND(COUNT(f.order_id) * 1.0 / COUNT(DISTINCT c.customer_id), 2) as orders_per_customer,
    
    -- Participação no total
    ROUND((SUM(f.total_order_value) * 100.0 / SUM(SUM(f.total_order_value)) OVER ()), 2) as revenue_share_pct,
    ROUND((COUNT(DISTINCT c.customer_id) * 100.0 / SUM(COUNT(DISTINCT c.customer_id)) OVER ()), 2) as customer_share_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."dim_customers" c
JOIN "warehouse"."public"."fact_orders" f ON c.customer_id = f.customer_id
WHERE f.order_status = 'delivered'
GROUP BY c.customer_state, c.customer_city
HAVING COUNT(f.order_id) >= 10  -- Filtrar cidades com pelo menos 10 pedidos
ORDER BY total_revenue DESC
  );
  
[0m19:55:15.398008 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fact_orders" does not exist
LINE 33: JOIN "warehouse"."public"."fact_orders" f ON c.customer_id =...
              ^

[0m19:55:15.399009 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: ROLLBACK
[0m19:55:15.400008 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: Close
[0m19:55:15.413614 [debug] [Thread-1 (]: Database Error in model mart_geographic_analysis (models\03 gold\mart_geographic_analysis.sql)
  relation "public.fact_orders" does not exist
  LINE 33: JOIN "warehouse"."public"."fact_orders" f ON c.customer_id =...
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_geographic_analysis.sql
[0m19:55:15.416130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9911db0-3988-4345-951f-72bd6f429b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBAB446E0>]}
[0m19:55:15.417130 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.mart_geographic_analysis .......... [[31mERROR[0m in 0.10s]
[0m19:55:15.418129 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_geographic_analysis
[0m19:55:15.418129 [debug] [Thread-7 (]: Marking all children of 'model.olist_ecommerce.mart_geographic_analysis' to be skipped because of status 'error'.  Reason: Database Error in model mart_geographic_analysis (models\03 gold\mart_geographic_analysis.sql)
  relation "public.fact_orders" does not exist
  LINE 33: JOIN "warehouse"."public"."fact_orders" f ON c.customer_id =...
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_geographic_analysis.sql.
[0m19:55:15.421127 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:15.422127 [debug] [MainThread]: On master: BEGIN
[0m19:55:15.422127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:55:15.437127 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m19:55:15.438127 [debug] [MainThread]: On master: COMMIT
[0m19:55:15.438127 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:15.438127 [debug] [MainThread]: On master: COMMIT
[0m19:55:15.439126 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:55:15.440127 [debug] [MainThread]: On master: Close
[0m19:55:15.441127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:15.441127 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:55:15.442130 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m19:55:15.442130 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_geographic_analysis' was properly closed.
[0m19:55:15.443127 [info ] [MainThread]: 
[0m19:55:15.444290 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m19:55:15.445956 [debug] [MainThread]: Command end result
[0m19:55:15.466709 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:55:15.470712 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:55:15.485649 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:55:15.485649 [info ] [MainThread]: 
[0m19:55:15.486651 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:55:15.487650 [info ] [MainThread]: 
[0m19:55:15.487650 [error] [MainThread]: [31mFailure in model mart_geographic_analysis (models\03 gold\mart_geographic_analysis.sql)[0m
[0m19:55:15.488651 [error] [MainThread]:   Database Error in model mart_geographic_analysis (models\03 gold\mart_geographic_analysis.sql)
  relation "public.fact_orders" does not exist
  LINE 33: JOIN "warehouse"."public"."fact_orders" f ON c.customer_id =...
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_geographic_analysis.sql
[0m19:55:15.489649 [info ] [MainThread]: 
[0m19:55:15.490651 [info ] [MainThread]:   compiled code at target\compiled\olist_ecommerce\models\03 gold\mart_geographic_analysis.sql
[0m19:55:15.490651 [info ] [MainThread]: 
[0m19:55:15.491650 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:55:15.494460 [debug] [MainThread]: Command `dbt run` failed at 19:55:15.493459 after 3.01 seconds
[0m19:55:15.494460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBB2FF830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBB230290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DBB231850>]}
[0m19:55:15.495463 [debug] [MainThread]: Flushing usage events
[0m19:55:15.511943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:55:33.907147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC12982120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0F5A7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC120491F0>]}


============================== 19:55:33.912147 | 61d7cf16-6f79-4fcc-a5f8-5bf536a332ac ==============================
[0m19:55:33.912147 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:55:33.914154 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart_delivery_performance', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:55:34.505105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61d7cf16-6f79-4fcc-a5f8-5bf536a332ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC13B66690>]}
[0m19:55:34.749218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61d7cf16-6f79-4fcc-a5f8-5bf536a332ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC11F7D100>]}
[0m19:55:34.751221 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:55:35.371128 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:55:35.646965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:35.646965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:35.652026 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
[0m19:55:35.701209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61d7cf16-6f79-4fcc-a5f8-5bf536a332ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC13EB33B0>]}
[0m19:55:35.801203 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:55:35.806202 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:55:35.842205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61d7cf16-6f79-4fcc-a5f8-5bf536a332ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1430E960>]}
[0m19:55:35.843206 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m19:55:35.844205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61d7cf16-6f79-4fcc-a5f8-5bf536a332ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1281ADE0>]}
[0m19:55:35.848213 [info ] [MainThread]: 
[0m19:55:35.849352 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:55:35.850566 [info ] [MainThread]: 
[0m19:55:35.853859 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:55:35.854859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:55:36.036798 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:55:36.037799 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:55:36.038799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:36.062800 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.024 seconds
[0m19:55:36.063808 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:55:36.074325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:55:36.083326 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:55:36.083326 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:55:36.084328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:36.104323 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m19:55:36.104323 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:55:36.105323 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:55:36.108325 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.003 seconds
[0m19:55:36.109324 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:55:36.111321 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:55:36.123322 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:36.123322 [debug] [MainThread]: On master: BEGIN
[0m19:55:36.124326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:55:36.143322 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m19:55:36.144323 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:36.145326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:55:36.150325 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:55:36.151323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61d7cf16-6f79-4fcc-a5f8-5bf536a332ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC13EB0D40>]}
[0m19:55:36.152322 [debug] [MainThread]: On master: ROLLBACK
[0m19:55:36.153323 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:36.153323 [debug] [MainThread]: On master: BEGIN
[0m19:55:36.154324 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:55:36.155321 [debug] [MainThread]: On master: COMMIT
[0m19:55:36.155321 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:36.155321 [debug] [MainThread]: On master: COMMIT
[0m19:55:36.157323 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:55:36.157323 [debug] [MainThread]: On master: Close
[0m19:55:36.163326 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_delivery_performance
[0m19:55:36.164323 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_delivery_performance .................. [RUN]
[0m19:55:36.165323 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_delivery_performance'
[0m19:55:36.165323 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_delivery_performance
[0m19:55:36.176327 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_delivery_performance"
[0m19:55:36.178322 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_delivery_performance
[0m19:55:36.246324 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_delivery_performance"
[0m19:55:36.247326 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m19:55:36.248324 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: BEGIN
[0m19:55:36.249325 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:55:36.265325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m19:55:36.266323 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m19:55:36.267323 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_delivery_performance"} */

  
    

  create  table "warehouse"."public"."mart_delivery_performance__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.customer_state,
    f.delivery_status,
    COUNT(*) as order_count,
    AVG(f.delivery_days_actual) as avg_actual_delivery_days,
    AVG(f.delivery_days_estimated) as avg_estimated_delivery_days,
    
    -- Percentis de entrega
    PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY f.delivery_days_actual) as median_delivery_days,
    PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY f.delivery_days_actual) as p90_delivery_days,
    
    -- Taxa de pontualidade
    ROUND((SUM(CASE WHEN f.delivery_status = 'On Time' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) as on_time_delivery_rate,
    
    -- Diferença entre estimado vs real
    AVG(f.delivery_days_actual - f.delivery_days_estimated) as avg_delivery_variance,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."fact_orders" f
JOIN "warehouse"."public"."dim_customers" c ON f.customer_id = c.customer_id
WHERE f.order_status = 'delivered'
    AND f.delivery_days_actual IS NOT NULL
    AND f.delivery_days_estimated IS NOT NULL
GROUP BY c.customer_state, f.delivery_status
ORDER BY c.customer_state, order_count DESC
  );
  
[0m19:55:36.269326 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fact_orders" does not exist
LINE 32: FROM "warehouse"."public"."fact_orders" f
              ^

[0m19:55:36.270324 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: ROLLBACK
[0m19:55:36.271322 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: Close
[0m19:55:36.288323 [debug] [Thread-1 (]: Database Error in model mart_delivery_performance (models\03 gold\mart_delivery_performance.sql)
  relation "public.fact_orders" does not exist
  LINE 32: FROM "warehouse"."public"."fact_orders" f
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_delivery_performance.sql
[0m19:55:36.290836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61d7cf16-6f79-4fcc-a5f8-5bf536a332ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC11C34A40>]}
[0m19:55:36.290836 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.mart_delivery_performance ......... [[31mERROR[0m in 0.12s]
[0m19:55:36.291837 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_delivery_performance
[0m19:55:36.292839 [debug] [Thread-7 (]: Marking all children of 'model.olist_ecommerce.mart_delivery_performance' to be skipped because of status 'error'.  Reason: Database Error in model mart_delivery_performance (models\03 gold\mart_delivery_performance.sql)
  relation "public.fact_orders" does not exist
  LINE 32: FROM "warehouse"."public"."fact_orders" f
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_delivery_performance.sql.
[0m19:55:36.295839 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:36.296838 [debug] [MainThread]: On master: BEGIN
[0m19:55:36.296838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:55:36.313838 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:55:36.313838 [debug] [MainThread]: On master: COMMIT
[0m19:55:36.313838 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:36.314839 [debug] [MainThread]: On master: COMMIT
[0m19:55:36.316839 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:55:36.316839 [debug] [MainThread]: On master: Close
[0m19:55:36.318837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:36.319839 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:55:36.320848 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m19:55:36.321838 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_delivery_performance' was properly closed.
[0m19:55:36.322840 [info ] [MainThread]: 
[0m19:55:36.366357 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m19:55:36.369359 [debug] [MainThread]: Command end result
[0m19:55:36.437805 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:55:36.439231 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:55:36.520180 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:55:36.521182 [info ] [MainThread]: 
[0m19:55:36.535182 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:55:36.538180 [info ] [MainThread]: 
[0m19:55:36.540182 [error] [MainThread]: [31mFailure in model mart_delivery_performance (models\03 gold\mart_delivery_performance.sql)[0m
[0m19:55:36.546192 [error] [MainThread]:   Database Error in model mart_delivery_performance (models\03 gold\mart_delivery_performance.sql)
  relation "public.fact_orders" does not exist
  LINE 32: FROM "warehouse"."public"."fact_orders" f
                ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_delivery_performance.sql
[0m19:55:36.549185 [info ] [MainThread]: 
[0m19:55:36.550185 [info ] [MainThread]:   compiled code at target\compiled\olist_ecommerce\models\03 gold\mart_delivery_performance.sql
[0m19:55:36.551185 [info ] [MainThread]: 
[0m19:55:36.553182 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:55:36.556179 [debug] [MainThread]: Command `dbt run` failed at 19:55:36.555180 after 2.91 seconds
[0m19:55:36.557180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC11B83E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC13B17D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0F4CE630>]}
[0m19:55:36.558181 [debug] [MainThread]: Flushing usage events
[0m19:55:36.628333 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:56:01.095366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D87A71A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DBBB6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D86D23F0>]}


============================== 19:56:01.102444 | 027ccd0f-50af-47e3-b3ba-0b58137cd3f3 ==============================
[0m19:56:01.102444 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:56:01.102444 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select mart_customer_analysis', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:56:02.154452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '027ccd0f-50af-47e3-b3ba-0b58137cd3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DCDB4260>]}
[0m19:56:02.495225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '027ccd0f-50af-47e3-b3ba-0b58137cd3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DA95A690>]}
[0m19:56:02.497227 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:56:03.296508 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:56:03.731520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:03.731520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:03.743967 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
[0m19:56:03.838909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '027ccd0f-50af-47e3-b3ba-0b58137cd3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DD1A9DC0>]}
[0m19:56:04.013297 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:56:04.019299 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:56:04.081426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '027ccd0f-50af-47e3-b3ba-0b58137cd3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DD5413A0>]}
[0m19:56:04.082426 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m19:56:04.083426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '027ccd0f-50af-47e3-b3ba-0b58137cd3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DBC44170>]}
[0m19:56:04.087342 [info ] [MainThread]: 
[0m19:56:04.089341 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:56:04.090344 [info ] [MainThread]: 
[0m19:56:04.091341 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:56:04.092340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:56:04.279440 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:56:04.279440 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:56:04.279440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:04.308866 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m19:56:04.310434 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:56:04.318477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:56:04.326475 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:56:04.326475 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:56:04.327475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:04.341526 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m19:56:04.342527 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:56:04.342527 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:56:04.345531 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.003 seconds
[0m19:56:04.347527 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:56:04.348527 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:56:04.359105 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:04.359105 [debug] [MainThread]: On master: BEGIN
[0m19:56:04.359105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:04.375715 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m19:56:04.376715 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:04.376715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:56:04.383717 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m19:56:04.385320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '027ccd0f-50af-47e3-b3ba-0b58137cd3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DD1A8B90>]}
[0m19:56:04.386317 [debug] [MainThread]: On master: ROLLBACK
[0m19:56:04.387320 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:04.388318 [debug] [MainThread]: On master: BEGIN
[0m19:56:04.390319 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:56:04.390319 [debug] [MainThread]: On master: COMMIT
[0m19:56:04.391325 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:04.391325 [debug] [MainThread]: On master: COMMIT
[0m19:56:04.392325 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:56:04.393318 [debug] [MainThread]: On master: Close
[0m19:56:04.399316 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_customer_analysis
[0m19:56:04.400317 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_customer_analysis ..................... [RUN]
[0m19:56:04.401318 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_customer_analysis'
[0m19:56:04.402320 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_customer_analysis
[0m19:56:04.412318 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_customer_analysis"
[0m19:56:04.414317 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_customer_analysis
[0m19:56:04.468095 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_customer_analysis"
[0m19:56:04.468095 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m19:56:04.468095 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_customer_analysis: BEGIN
[0m19:56:04.468095 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:56:04.485356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m19:56:04.485356 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m19:56:04.485356 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_customer_analysis"} */

  
    

  create  table "warehouse"."public"."mart_customer_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH customer_metrics AS (
    SELECT 
        c.customer_id,
        c.customer_city,
        c.customer_state,
        COUNT(f.order_id) as total_orders,
        SUM(f.total_order_value) as total_spent,
        AVG(f.total_order_value) as avg_order_value,
        MIN(f.order_purchase_timestamp) as first_order_date,
        MAX(f.order_purchase_timestamp) as last_order_date,
        SUM(f.total_items) as total_items_purchased
    FROM "warehouse"."public"."fact_orders" f
    JOIN "warehouse"."public"."dim_customers" c ON f.customer_id = c.customer_id
    WHERE f.order_status = 'delivered'
    GROUP BY c.customer_id, c.customer_city, c.customer_state
),

customer_segments AS (
    SELECT 
        *,
        EXTRACT(DAYS FROM (last_order_date - first_order_date)) as customer_lifetime_days,
        CASE 
            WHEN total_orders = 1 THEN 'One-time'
            WHEN total_orders BETWEEN 2 AND 3 THEN 'Occasional'
            WHEN total_orders BETWEEN 4 AND 8 THEN 'Regular'
            ELSE 'Frequent'
        END as customer_segment,
        
        CASE 
            WHEN total_spent < 100 THEN 'Low Value'
            WHEN total_spent BETWEEN 100 AND 500 THEN 'Medium Value'
            WHEN total_spent BETWEEN 500 AND 1500 THEN 'High Value'
            ELSE 'Premium'
        END as customer_value_segment
    FROM customer_metrics
)

SELECT 
    customer_state,
    customer_segment,
    customer_value_segment,
    COUNT(*) as customer_count,
    SUM(total_spent) as segment_revenue,
    AVG(total_spent) as avg_customer_value,
    AVG(total_orders) as avg_orders_per_customer,
    AVG(avg_order_value) as avg_order_value,
    CURRENT_TIMESTAMP as created_at
FROM customer_segments
GROUP BY customer_state, customer_segment, customer_value_segment
ORDER BY customer_state, segment_revenue DESC
  );
  
[0m19:56:04.489919 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fact_orders" does not exist
LINE 25:     FROM "warehouse"."public"."fact_orders" f
                  ^

[0m19:56:04.489919 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_customer_analysis: ROLLBACK
[0m19:56:04.489919 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_customer_analysis: Close
[0m19:56:04.496187 [debug] [Thread-1 (]: Database Error in model mart_customer_analysis (models\03 gold\mart_customer_analysis.sql)
  relation "public.fact_orders" does not exist
  LINE 25:     FROM "warehouse"."public"."fact_orders" f
                    ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_customer_analysis.sql
[0m19:56:04.507644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '027ccd0f-50af-47e3-b3ba-0b58137cd3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DAE34920>]}
[0m19:56:04.507644 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.mart_customer_analysis ............ [[31mERROR[0m in 0.09s]
[0m19:56:04.507644 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_customer_analysis
[0m19:56:04.507644 [debug] [Thread-7 (]: Marking all children of 'model.olist_ecommerce.mart_customer_analysis' to be skipped because of status 'error'.  Reason: Database Error in model mart_customer_analysis (models\03 gold\mart_customer_analysis.sql)
  relation "public.fact_orders" does not exist
  LINE 25:     FROM "warehouse"."public"."fact_orders" f
                    ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_customer_analysis.sql.
[0m19:56:04.507644 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:04.507644 [debug] [MainThread]: On master: BEGIN
[0m19:56:04.507644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:04.529958 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m19:56:04.530957 [debug] [MainThread]: On master: COMMIT
[0m19:56:04.530957 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:04.530957 [debug] [MainThread]: On master: COMMIT
[0m19:56:04.531957 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:56:04.532956 [debug] [MainThread]: On master: Close
[0m19:56:04.533962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:04.533962 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:56:04.534965 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m19:56:04.534965 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_customer_analysis' was properly closed.
[0m19:56:04.535961 [info ] [MainThread]: 
[0m19:56:04.535961 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m19:56:04.537959 [debug] [MainThread]: Command end result
[0m19:56:04.563913 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:56:04.566906 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:56:04.579364 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:56:04.580339 [info ] [MainThread]: 
[0m19:56:04.581341 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:56:04.581341 [info ] [MainThread]: 
[0m19:56:04.582340 [error] [MainThread]: [31mFailure in model mart_customer_analysis (models\03 gold\mart_customer_analysis.sql)[0m
[0m19:56:04.582340 [error] [MainThread]:   Database Error in model mart_customer_analysis (models\03 gold\mart_customer_analysis.sql)
  relation "public.fact_orders" does not exist
  LINE 25:     FROM "warehouse"."public"."fact_orders" f
                    ^
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_customer_analysis.sql
[0m19:56:04.583337 [info ] [MainThread]: 
[0m19:56:04.584338 [info ] [MainThread]:   compiled code at target\compiled\olist_ecommerce\models\03 gold\mart_customer_analysis.sql
[0m19:56:04.584338 [info ] [MainThread]: 
[0m19:56:04.585341 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:56:04.587366 [debug] [MainThread]: Command `dbt run` failed at 19:56:04.586337 after 4.44 seconds
[0m19:56:04.587366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DB34C380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DB4BBA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DB4BBD10>]}
[0m19:56:04.587366 [debug] [MainThread]: Flushing usage events
[0m19:56:04.610572 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:30.690262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3166F0EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F319976570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3166921E0>]}


============================== 19:59:30.698374 | 9772650d-c532-4c3c-91f9-4b5f5fbb3616 ==============================
[0m19:59:30.698374 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:59:30.700377 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select fact_orders', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt'}
[0m19:59:31.235043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9772650d-c532-4c3c-91f9-4b5f5fbb3616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3168B7F20>]}
[0m19:59:31.444279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9772650d-c532-4c3c-91f9-4b5f5fbb3616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3194E2570>]}
[0m19:59:31.446281 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:59:31.996620 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:59:32.431134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:59:32.432138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:59:32.446145 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
[0m19:59:32.517598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9772650d-c532-4c3c-91f9-4b5f5fbb3616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31B141AC0>]}
[0m19:59:32.646698 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:59:32.651268 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:59:32.688304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9772650d-c532-4c3c-91f9-4b5f5fbb3616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31B1410D0>]}
[0m19:59:32.689305 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m19:59:32.690304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9772650d-c532-4c3c-91f9-4b5f5fbb3616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31B184260>]}
[0m19:59:32.694305 [info ] [MainThread]: 
[0m19:59:32.695303 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:59:32.696555 [info ] [MainThread]: 
[0m19:59:32.699932 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:59:32.700559 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m19:59:32.961808 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m19:59:32.962815 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m19:59:32.963805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:33.002481 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.039 seconds
[0m19:59:33.004483 [debug] [ThreadPool]: On list_warehouse: Close
[0m19:59:33.020878 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m19:59:33.034884 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:59:33.034884 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m19:59:33.035883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:59:33.061560 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m19:59:33.061560 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m19:59:33.062564 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:59:33.068694 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.005 seconds
[0m19:59:33.071906 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m19:59:33.072906 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m19:59:33.092765 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:33.093763 [debug] [MainThread]: On master: BEGIN
[0m19:59:33.093763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:59:33.120064 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m19:59:33.121068 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:33.122071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:59:33.129239 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:59:33.133032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9772650d-c532-4c3c-91f9-4b5f5fbb3616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31697A7E0>]}
[0m19:59:33.134033 [debug] [MainThread]: On master: ROLLBACK
[0m19:59:33.136032 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:33.137032 [debug] [MainThread]: On master: BEGIN
[0m19:59:33.139221 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:59:33.140466 [debug] [MainThread]: On master: COMMIT
[0m19:59:33.141094 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:33.141639 [debug] [MainThread]: On master: COMMIT
[0m19:59:33.143368 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:59:33.144185 [debug] [MainThread]: On master: Close
[0m19:59:33.153415 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.fact_orders
[0m19:59:33.155149 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fact_orders ................................ [RUN]
[0m19:59:33.156591 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.fact_orders'
[0m19:59:33.157245 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.fact_orders
[0m19:59:33.175703 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.fact_orders"
[0m19:59:33.177703 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.fact_orders
[0m19:59:33.268142 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.fact_orders"
[0m19:59:33.269668 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_orders"
[0m19:59:33.270668 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_orders: BEGIN
[0m19:59:33.270668 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:59:33.292607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m19:59:33.293672 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_orders"
[0m19:59:33.294674 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_orders"} */

  
    

  create  table "warehouse"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

WITH order_items_agg AS (
    SELECT 
        order_id,
        COUNT(*) as total_items,
        SUM(price) as total_product_value,
        SUM(freight_value) as total_freight_value,
        SUM(price + freight_value) as total_order_value,
        AVG(price) as avg_item_price,
        MAX(price) as max_item_price,
        MIN(price) as min_item_price
    FROM "warehouse"."public"."olist_order_items_dataset"
    GROUP BY order_id
),

order_payments_agg AS (
    SELECT 
        order_id,
        SUM(payment_value) as total_payment_value,
        COUNT(DISTINCT payment_type) as payment_methods_count,
        STRING_AGG(DISTINCT payment_type, ', ') as payment_types,
        AVG(payment_installments) as avg_installments
    FROM "warehouse"."public"."olist_order_payments_dataset"
    GROUP BY order_id
)

SELECT 
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp::timestamp as order_purchase_timestamp,
    o.order_approved_at::timestamp as order_approved_at,
    o.order_delivered_carrier_date::timestamp as order_delivered_carrier_date,
    o.order_delivered_customer_date::timestamp as order_delivered_customer_date,
    o.order_estimated_delivery_date::timestamp as order_estimated_delivery_date,
    
    -- Métricas de itens
    oi.total_items,
    oi.total_product_value,
    oi.total_freight_value,
    oi.total_order_value,
    oi.avg_item_price,
    oi.max_item_price,
    oi.min_item_price,
    
    -- Métricas de pagamento
    op.total_payment_value,
    op.payment_methods_count,
    op.payment_types,
    op.avg_installments,
    
    -- Métricas de tempo (em dias)
    CASE 
        WHEN o.order_delivered_customer_date IS NOT NULL AND o.order_purchase_timestamp IS NOT NULL
        THEN EXTRACT(DAYS FROM (o.order_delivered_customer_date::timestamp - o.order_purchase_timestamp::timestamp))
        ELSE NULL 
    END as delivery_days_actual,
    
    CASE 
        WHEN o.order_estimated_delivery_date IS NOT NULL AND o.order_purchase_timestamp IS NOT NULL
        THEN EXTRACT(DAYS FROM (o.order_estimated_delivery_date::timestamp - o.order_purchase_timestamp::timestamp))
        ELSE NULL 
    END as delivery_days_estimated,
    
    -- Indicadores de qualidade
    CASE 
        WHEN o.order_delivered_customer_date IS NOT NULL AND o.order_estimated_delivery_date IS NOT NULL
        THEN CASE 
            WHEN o.order_delivered_customer_date::timestamp <= o.order_estimated_delivery_date::timestamp 
            THEN 'On Time' 
            ELSE 'Late' 
        END
        ELSE NULL
    END as delivery_status,
    
    CURRENT_TIMESTAMP as created_at
    
FROM "warehouse"."public"."olist_orders_dataset" o
LEFT JOIN order_items_agg oi ON o.order_id = oi.order_id  
LEFT JOIN order_payments_agg op ON o.order_id = op.order_id
WHERE o.order_status IS NOT NULL
  );
  
[0m19:59:36.408079 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 3.113 seconds
[0m19:59:36.422082 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_orders"
[0m19:59:36.422082 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_orders"} */
alter table "warehouse"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:59:36.424082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:59:36.444872 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_orders: COMMIT
[0m19:59:36.445875 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_orders"
[0m19:59:36.445875 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_orders: COMMIT
[0m19:59:36.457223 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m19:59:36.465962 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."fact_orders__dbt_backup"
[0m19:59:36.473116 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_orders"
[0m19:59:36.473116 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_orders"} */
drop table if exists "warehouse"."public"."fact_orders__dbt_backup" cascade
[0m19:59:36.474113 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m19:59:36.478115 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_orders: Close
[0m19:59:36.483120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9772650d-c532-4c3c-91f9-4b5f5fbb3616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31B4E4140>]}
[0m19:59:36.485112 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fact_orders ........................... [[32mSELECT 99441[0m in 3.32s]
[0m19:59:36.486114 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.fact_orders
[0m19:59:36.488112 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:36.488112 [debug] [MainThread]: On master: BEGIN
[0m19:59:36.489113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:59:36.507590 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m19:59:36.507590 [debug] [MainThread]: On master: COMMIT
[0m19:59:36.508116 [debug] [MainThread]: Using postgres connection "master"
[0m19:59:36.508653 [debug] [MainThread]: On master: COMMIT
[0m19:59:36.509794 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:59:36.510854 [debug] [MainThread]: On master: Close
[0m19:59:36.511897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:59:36.512890 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m19:59:36.512890 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m19:59:36.513892 [debug] [MainThread]: Connection 'model.olist_ecommerce.fact_orders' was properly closed.
[0m19:59:36.514889 [info ] [MainThread]: 
[0m19:59:36.518770 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m19:59:36.520374 [debug] [MainThread]: Command end result
[0m19:59:36.616601 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m19:59:36.620601 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m19:59:36.635326 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m19:59:36.636380 [info ] [MainThread]: 
[0m19:59:36.636919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:59:36.637977 [info ] [MainThread]: 
[0m19:59:36.638502 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:59:36.640334 [debug] [MainThread]: Command `dbt run` succeeded at 19:59:36.639806 after 6.24 seconds
[0m19:59:36.640849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31B4D8D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31B4DBEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31B4DBFE0>]}
[0m19:59:36.641376 [debug] [MainThread]: Flushing usage events
[0m19:59:36.673152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:18.764822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9777FC800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9777FF530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9777FF4A0>]}


============================== 20:00:18.768846 | 654cd9b6-85a6-4219-8dad-244a115e184d ==============================
[0m20:00:18.768846 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:00:18.769942 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select mart_customer_analysis', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt'}
[0m20:00:19.431554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '654cd9b6-85a6-4219-8dad-244a115e184d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9790D5C70>]}
[0m20:00:19.625019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '654cd9b6-85a6-4219-8dad-244a115e184d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B974CCA6C0>]}
[0m20:00:19.626018 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:00:20.050883 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:00:20.244892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:20.244892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:20.251892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
[0m20:00:20.293402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '654cd9b6-85a6-4219-8dad-244a115e184d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B979495970>]}
[0m20:00:20.378667 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:00:20.381669 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:00:20.414539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '654cd9b6-85a6-4219-8dad-244a115e184d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9798B2030>]}
[0m20:00:20.414539 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m20:00:20.415541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '654cd9b6-85a6-4219-8dad-244a115e184d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B979199EB0>]}
[0m20:00:20.417927 [info ] [MainThread]: 
[0m20:00:20.418937 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:00:20.419937 [info ] [MainThread]: 
[0m20:00:20.419937 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:00:20.422939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m20:00:20.609721 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m20:00:20.609721 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:00:20.609721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:20.632719 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.022 seconds
[0m20:00:20.633723 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:00:20.644532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m20:00:20.657533 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:00:20.657533 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m20:00:20.658534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:20.681049 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m20:00:20.681049 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:00:20.682051 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:00:20.688108 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.005 seconds
[0m20:00:20.690626 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m20:00:20.691622 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m20:00:20.706580 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:20.707581 [debug] [MainThread]: On master: BEGIN
[0m20:00:20.707581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:20.728131 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m20:00:20.729133 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:20.729133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:00:20.733953 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:00:20.735531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '654cd9b6-85a6-4219-8dad-244a115e184d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9793FD700>]}
[0m20:00:20.736055 [debug] [MainThread]: On master: ROLLBACK
[0m20:00:20.737102 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:20.737626 [debug] [MainThread]: On master: BEGIN
[0m20:00:20.739729 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:00:20.740255 [debug] [MainThread]: On master: COMMIT
[0m20:00:20.740766 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:20.740766 [debug] [MainThread]: On master: COMMIT
[0m20:00:20.741820 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:00:20.742869 [debug] [MainThread]: On master: Close
[0m20:00:20.750238 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_customer_analysis
[0m20:00:20.750766 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_customer_analysis ..................... [RUN]
[0m20:00:20.751902 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_customer_analysis'
[0m20:00:20.752434 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_customer_analysis
[0m20:00:20.764711 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_customer_analysis"
[0m20:00:20.767107 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_customer_analysis
[0m20:00:20.853645 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_customer_analysis"
[0m20:00:20.855514 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m20:00:20.856490 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_customer_analysis: BEGIN
[0m20:00:20.857489 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:20.873532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m20:00:20.873532 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m20:00:20.874534 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_customer_analysis"} */

  
    

  create  table "warehouse"."public"."mart_customer_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH customer_metrics AS (
    SELECT 
        c.customer_id,
        c.customer_city,
        c.customer_state,
        COUNT(f.order_id) as total_orders,
        SUM(f.total_order_value) as total_spent,
        AVG(f.total_order_value) as avg_order_value,
        MIN(f.order_purchase_timestamp) as first_order_date,
        MAX(f.order_purchase_timestamp) as last_order_date,
        SUM(f.total_items) as total_items_purchased
    FROM "warehouse"."public"."fact_orders" f
    JOIN "warehouse"."public"."dim_customers" c ON f.customer_id = c.customer_id
    WHERE f.order_status = 'delivered'
    GROUP BY c.customer_id, c.customer_city, c.customer_state
),

customer_segments AS (
    SELECT 
        *,
        EXTRACT(DAYS FROM (last_order_date - first_order_date)) as customer_lifetime_days,
        CASE 
            WHEN total_orders = 1 THEN 'One-time'
            WHEN total_orders BETWEEN 2 AND 3 THEN 'Occasional'
            WHEN total_orders BETWEEN 4 AND 8 THEN 'Regular'
            ELSE 'Frequent'
        END as customer_segment,
        
        CASE 
            WHEN total_spent < 100 THEN 'Low Value'
            WHEN total_spent BETWEEN 100 AND 500 THEN 'Medium Value'
            WHEN total_spent BETWEEN 500 AND 1500 THEN 'High Value'
            ELSE 'Premium'
        END as customer_value_segment
    FROM customer_metrics
)

SELECT 
    customer_state,
    customer_segment,
    customer_value_segment,
    COUNT(*) as customer_count,
    SUM(total_spent) as segment_revenue,
    AVG(total_spent) as avg_customer_value,
    AVG(total_orders) as avg_orders_per_customer,
    AVG(avg_order_value) as avg_order_value,
    CURRENT_TIMESTAMP as created_at
FROM customer_segments
GROUP BY customer_state, customer_segment, customer_value_segment
ORDER BY customer_state, segment_revenue DESC
  );
  
[0m20:00:21.525918 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.651 seconds
[0m20:00:21.537651 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m20:00:21.538651 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_customer_analysis"} */
alter table "warehouse"."public"."mart_customer_analysis__dbt_tmp" rename to "mart_customer_analysis"
[0m20:00:21.539651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:00:21.558677 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_customer_analysis: COMMIT
[0m20:00:21.559724 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m20:00:21.560668 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_customer_analysis: COMMIT
[0m20:00:21.564034 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:00:21.573601 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."mart_customer_analysis__dbt_backup"
[0m20:00:21.583321 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m20:00:21.583321 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_customer_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_customer_analysis"} */
drop table if exists "warehouse"."public"."mart_customer_analysis__dbt_backup" cascade
[0m20:00:21.585320 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:00:21.588322 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_customer_analysis: Close
[0m20:00:21.592006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '654cd9b6-85a6-4219-8dad-244a115e184d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B974C07200>]}
[0m20:00:21.594006 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.mart_customer_analysis ................ [[32mSELECT 105[0m in 0.84s]
[0m20:00:21.595006 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_customer_analysis
[0m20:00:21.596003 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:21.597029 [debug] [MainThread]: On master: BEGIN
[0m20:00:21.597029 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:21.613772 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m20:00:21.614773 [debug] [MainThread]: On master: COMMIT
[0m20:00:21.615773 [debug] [MainThread]: Using postgres connection "master"
[0m20:00:21.615773 [debug] [MainThread]: On master: COMMIT
[0m20:00:21.616775 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:00:21.617775 [debug] [MainThread]: On master: Close
[0m20:00:21.619774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:21.619774 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m20:00:21.620775 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m20:00:21.621773 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_customer_analysis' was properly closed.
[0m20:00:21.622773 [info ] [MainThread]: 
[0m20:00:21.624772 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m20:00:21.627776 [debug] [MainThread]: Command end result
[0m20:00:21.739016 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:00:21.742015 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:00:21.759506 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m20:00:21.760041 [info ] [MainThread]: 
[0m20:00:21.760577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:21.761109 [info ] [MainThread]: 
[0m20:00:21.761636 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:00:21.764918 [debug] [MainThread]: Command `dbt run` succeeded at 20:00:21.764384 after 3.22 seconds
[0m20:00:21.765453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B979857500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B977C79730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B979CFAD80>]}
[0m20:00:21.765971 [debug] [MainThread]: Flushing usage events
[0m20:00:21.806643 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:49.655696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E90463380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E8D0871A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E8FC2DAC0>]}


============================== 20:05:49.659716 | 5a98dd2c-c321-4748-87c0-e7ab14bb2684 ==============================
[0m20:05:49.659716 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:05:49.660692 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart_delivery_performance', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m20:05:50.220807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a98dd2c-c321-4748-87c0-e7ab14bb2684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E91911760>]}
[0m20:05:50.440862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a98dd2c-c321-4748-87c0-e7ab14bb2684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E91A5FCE0>]}
[0m20:05:50.441863 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:05:50.851319 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:05:51.200286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:51.201305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:51.216285 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m20:05:51.390309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a98dd2c-c321-4748-87c0-e7ab14bb2684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E91A28860>]}
[0m20:05:51.574526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:05:51.577526 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:05:51.612036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a98dd2c-c321-4748-87c0-e7ab14bb2684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E91E41E50>]}
[0m20:05:51.613035 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m20:05:51.613035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a98dd2c-c321-4748-87c0-e7ab14bb2684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E916445F0>]}
[0m20:05:51.616033 [info ] [MainThread]: 
[0m20:05:51.617033 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:51.618033 [info ] [MainThread]: 
[0m20:05:51.619034 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:05:51.620035 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m20:05:51.807618 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m20:05:51.807618 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:05:51.808618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:51.830025 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m20:05:51.832026 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:05:51.839023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m20:05:51.847798 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:05:51.848796 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m20:05:51.848796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:51.862797 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m20:05:51.863797 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:05:51.863797 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:05:51.866794 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.003 seconds
[0m20:05:51.868795 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m20:05:51.869797 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m20:05:51.878349 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:51.879349 [debug] [MainThread]: On master: BEGIN
[0m20:05:51.879349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:05:51.894017 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m20:05:51.894017 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:51.894017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:05:51.900025 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m20:05:51.902021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a98dd2c-c321-4748-87c0-e7ab14bb2684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E921B9B50>]}
[0m20:05:51.903020 [debug] [MainThread]: On master: ROLLBACK
[0m20:05:51.904020 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:51.905019 [debug] [MainThread]: On master: BEGIN
[0m20:05:51.907021 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:05:51.908028 [debug] [MainThread]: On master: COMMIT
[0m20:05:51.908028 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:51.909111 [debug] [MainThread]: On master: COMMIT
[0m20:05:51.910626 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:05:51.910626 [debug] [MainThread]: On master: Close
[0m20:05:51.918628 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_delivery_performance
[0m20:05:51.920629 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_delivery_performance .................. [RUN]
[0m20:05:51.922985 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_delivery_performance'
[0m20:05:51.923987 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_delivery_performance
[0m20:05:51.939860 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_delivery_performance"
[0m20:05:51.941850 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_delivery_performance
[0m20:05:52.018518 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_delivery_performance"
[0m20:05:52.020509 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m20:05:52.023954 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: BEGIN
[0m20:05:52.026064 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:05:52.046117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m20:05:52.047350 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m20:05:52.048486 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_delivery_performance"} */

  
    

  create  table "warehouse"."public"."mart_delivery_performance__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.customer_state,
    f.delivery_status,
    COUNT(*) as order_count,
    AVG(f.delivery_days_actual) as avg_actual_delivery_days,
    AVG(f.delivery_days_estimated) as avg_estimated_delivery_days,
    
    -- Percentis de entrega
    PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY f.delivery_days_actual) as median_delivery_days,
    PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY f.delivery_days_actual) as p90_delivery_days,
    
    -- Taxa de pontualidade
    ROUND((SUM(CASE WHEN f.delivery_status = 'On Time' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) as on_time_delivery_rate,
    
    -- Diferença entre estimado vs real
    AVG(f.delivery_days_actual - f.delivery_days_estimated) as avg_delivery_variance,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."fact_orders" f
JOIN "warehouse"."public"."dim_customers" c ON f.customer_id = c.customer_id
WHERE f.order_status = 'delivered'
    AND f.delivery_days_actual IS NOT NULL
    AND f.delivery_days_estimated IS NOT NULL
GROUP BY c.customer_state, f.delivery_status
ORDER BY c.customer_state, order_count DESC
  );
  
[0m20:05:52.246966 [debug] [Thread-1 (]: SQL status: SELECT 54 in 0.198 seconds
[0m20:05:52.257966 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m20:05:52.258966 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_delivery_performance"} */
alter table "warehouse"."public"."mart_delivery_performance__dbt_tmp" rename to "mart_delivery_performance"
[0m20:05:52.259969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:05:52.278069 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: COMMIT
[0m20:05:52.278069 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m20:05:52.278069 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: COMMIT
[0m20:05:52.280070 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:05:52.288070 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."mart_delivery_performance__dbt_backup"
[0m20:05:52.295575 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m20:05:52.295663 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_delivery_performance"} */
drop table if exists "warehouse"."public"."mart_delivery_performance__dbt_backup" cascade
[0m20:05:52.296584 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:05:52.299580 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: Close
[0m20:05:52.303585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a98dd2c-c321-4748-87c0-e7ab14bb2684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E8D1D3500>]}
[0m20:05:52.304582 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.mart_delivery_performance ............. [[32mSELECT 54[0m in 0.38s]
[0m20:05:52.305819 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_delivery_performance
[0m20:05:52.307334 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:52.307334 [debug] [MainThread]: On master: BEGIN
[0m20:05:52.308334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:05:52.323335 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m20:05:52.324338 [debug] [MainThread]: On master: COMMIT
[0m20:05:52.325335 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:52.325335 [debug] [MainThread]: On master: COMMIT
[0m20:05:52.326338 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:05:52.327335 [debug] [MainThread]: On master: Close
[0m20:05:52.328334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:52.328334 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m20:05:52.329337 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m20:05:52.329337 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_delivery_performance' was properly closed.
[0m20:05:52.330339 [info ] [MainThread]: 
[0m20:05:52.331337 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m20:05:52.332335 [debug] [MainThread]: Command end result
[0m20:05:52.407538 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:05:52.412539 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:05:52.430175 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m20:05:52.431176 [info ] [MainThread]: 
[0m20:05:52.432516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:05:52.433518 [info ] [MainThread]: 
[0m20:05:52.434519 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:05:52.436515 [debug] [MainThread]: Command `dbt run` succeeded at 20:05:52.436515 after 3.01 seconds
[0m20:05:52.437515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E8CFAE7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E8FBC11F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E8FFD9760>]}
[0m20:05:52.437515 [debug] [MainThread]: Flushing usage events
[0m20:05:52.476719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:06:11.275220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829B420560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018299117140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829903E720>]}


============================== 20:06:11.279760 | 9dddb8f2-882d-445a-98fe-d4cdac28a3eb ==============================
[0m20:06:11.279760 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:06:11.280731 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart_geographic_analysis', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:06:11.885680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dddb8f2-882d-445a-98fe-d4cdac28a3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182994EE510>]}
[0m20:06:12.129877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dddb8f2-882d-445a-98fe-d4cdac28a3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829BFE5B20>]}
[0m20:06:12.130876 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:06:12.604245 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:06:12.889638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:06:12.890641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:06:12.899769 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
[0m20:06:12.956041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dddb8f2-882d-445a-98fe-d4cdac28a3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829DBB48C0>]}
[0m20:06:13.056012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:06:13.060013 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:06:13.098436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dddb8f2-882d-445a-98fe-d4cdac28a3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829DF521B0>]}
[0m20:06:13.101435 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m20:06:13.106431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dddb8f2-882d-445a-98fe-d4cdac28a3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829DF0AC90>]}
[0m20:06:13.112956 [info ] [MainThread]: 
[0m20:06:13.118949 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:06:13.123832 [info ] [MainThread]: 
[0m20:06:13.125847 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:06:13.130484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m20:06:13.320936 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m20:06:13.322491 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:06:13.324068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:13.350388 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m20:06:13.353385 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:06:13.369879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m20:06:13.386193 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:06:13.387191 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m20:06:13.387191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:13.407721 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m20:06:13.408718 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:06:13.408718 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:06:13.411715 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m20:06:13.413715 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m20:06:13.416717 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m20:06:13.429930 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:13.429930 [debug] [MainThread]: On master: BEGIN
[0m20:06:13.429930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:06:13.444933 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m20:06:13.444933 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:13.445930 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:06:13.450930 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:06:13.451667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dddb8f2-882d-445a-98fe-d4cdac28a3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829DB719D0>]}
[0m20:06:13.452664 [debug] [MainThread]: On master: ROLLBACK
[0m20:06:13.453666 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:13.453666 [debug] [MainThread]: On master: BEGIN
[0m20:06:13.454665 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:06:13.455665 [debug] [MainThread]: On master: COMMIT
[0m20:06:13.455665 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:13.455665 [debug] [MainThread]: On master: COMMIT
[0m20:06:13.456665 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:06:13.456665 [debug] [MainThread]: On master: Close
[0m20:06:13.462664 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_geographic_analysis
[0m20:06:13.462664 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_geographic_analysis ................... [RUN]
[0m20:06:13.463665 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_geographic_analysis'
[0m20:06:13.464670 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_geographic_analysis
[0m20:06:13.472665 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_geographic_analysis"
[0m20:06:13.473668 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_geographic_analysis
[0m20:06:13.529457 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_geographic_analysis"
[0m20:06:13.530459 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m20:06:13.531460 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: BEGIN
[0m20:06:13.531460 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:06:13.549894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m20:06:13.549894 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m20:06:13.550890 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_geographic_analysis"} */

  
    

  create  table "warehouse"."public"."mart_geographic_analysis__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.customer_state,
    c.customer_city,
    COUNT(DISTINCT c.customer_id) as total_customers,
    COUNT(f.order_id) as total_orders,
    SUM(f.total_order_value) as total_revenue,
    AVG(f.total_order_value) as avg_order_value,
    SUM(f.total_items) as total_items_sold,
    
    -- Métricas por cliente
    ROUND(SUM(f.total_order_value) / COUNT(DISTINCT c.customer_id), 2) as revenue_per_customer,
    ROUND(COUNT(f.order_id) * 1.0 / COUNT(DISTINCT c.customer_id), 2) as orders_per_customer,
    
    -- Participação no total
    ROUND((SUM(f.total_order_value) * 100.0 / SUM(SUM(f.total_order_value)) OVER ()), 2) as revenue_share_pct,
    ROUND((COUNT(DISTINCT c.customer_id) * 100.0 / SUM(COUNT(DISTINCT c.customer_id)) OVER ()), 2) as customer_share_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."dim_customers" c
JOIN "warehouse"."public"."fact_orders" f ON c.customer_id = f.customer_id
WHERE f.order_status = 'delivered'
GROUP BY c.customer_state, c.customer_city
HAVING COUNT(f.order_id) >= 10  -- Filtrar cidades com pelo menos 10 pedidos
ORDER BY total_revenue DESC
  );
  
[0m20:06:13.552887 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 24:     ROUND(SUM(f.total_order_value) / COUNT(DISTINCT c.custom...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:06:13.552887 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: ROLLBACK
[0m20:06:13.553885 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: Close
[0m20:06:13.567886 [debug] [Thread-1 (]: Database Error in model mart_geographic_analysis (models\03 gold\mart_geographic_analysis.sql)
  function round(double precision, integer) does not exist
  LINE 24:     ROUND(SUM(f.total_order_value) / COUNT(DISTINCT c.custom...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_geographic_analysis.sql
[0m20:06:13.569886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dddb8f2-882d-445a-98fe-d4cdac28a3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829E3605F0>]}
[0m20:06:13.570887 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.mart_geographic_analysis .......... [[31mERROR[0m in 0.10s]
[0m20:06:13.571887 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_geographic_analysis
[0m20:06:13.572889 [debug] [Thread-7 (]: Marking all children of 'model.olist_ecommerce.mart_geographic_analysis' to be skipped because of status 'error'.  Reason: Database Error in model mart_geographic_analysis (models\03 gold\mart_geographic_analysis.sql)
  function round(double precision, integer) does not exist
  LINE 24:     ROUND(SUM(f.total_order_value) / COUNT(DISTINCT c.custom...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_geographic_analysis.sql.
[0m20:06:13.577410 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:13.577410 [debug] [MainThread]: On master: BEGIN
[0m20:06:13.577410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:13.592176 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m20:06:13.593174 [debug] [MainThread]: On master: COMMIT
[0m20:06:13.593174 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:13.593174 [debug] [MainThread]: On master: COMMIT
[0m20:06:13.594173 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:06:13.595173 [debug] [MainThread]: On master: Close
[0m20:06:13.596179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:13.597195 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m20:06:13.597195 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m20:06:13.598177 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_geographic_analysis' was properly closed.
[0m20:06:13.598177 [info ] [MainThread]: 
[0m20:06:13.599172 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m20:06:13.600176 [debug] [MainThread]: Command end result
[0m20:06:13.627012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:06:13.631015 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:06:13.648612 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m20:06:13.648612 [info ] [MainThread]: 
[0m20:06:13.649613 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:06:13.651286 [info ] [MainThread]: 
[0m20:06:13.652284 [error] [MainThread]: [31mFailure in model mart_geographic_analysis (models\03 gold\mart_geographic_analysis.sql)[0m
[0m20:06:13.653286 [error] [MainThread]:   Database Error in model mart_geographic_analysis (models\03 gold\mart_geographic_analysis.sql)
  function round(double precision, integer) does not exist
  LINE 24:     ROUND(SUM(f.total_order_value) / COUNT(DISTINCT c.custom...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_geographic_analysis.sql
[0m20:06:13.655286 [info ] [MainThread]: 
[0m20:06:13.655286 [info ] [MainThread]:   compiled code at target\compiled\olist_ecommerce\models\03 gold\mart_geographic_analysis.sql
[0m20:06:13.656287 [info ] [MainThread]: 
[0m20:06:13.657284 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:06:13.659292 [debug] [MainThread]: Command `dbt run` failed at 20:06:13.658286 after 2.64 seconds
[0m20:06:13.659292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829BAEE3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829B74F530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829B74E6F0>]}
[0m20:06:13.659292 [debug] [MainThread]: Flushing usage events
[0m20:06:13.670048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:07.635295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4CF06FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD51475FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD51476AE0>]}


============================== 20:07:07.640318 | 7db8166d-872a-40c5-ac70-e0b6d5902298 ==============================
[0m20:07:07.640318 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:07:07.640318 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart_geographic_analysis', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m20:07:08.161376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7db8166d-872a-40c5-ac70-e0b6d5902298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5178F260>]}
[0m20:07:08.356435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7db8166d-872a-40c5-ac70-e0b6d5902298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4FE79070>]}
[0m20:07:08.357435 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:07:08.781451 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:07:09.051057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:07:09.051057 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\03 gold\mart_geographic_analysis.sql
[0m20:07:09.942464 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m20:07:09.966464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7db8166d-872a-40c5-ac70-e0b6d5902298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD51E5E7E0>]}
[0m20:07:10.074489 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:07:10.079482 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:07:10.180720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7db8166d-872a-40c5-ac70-e0b6d5902298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD51D62D80>]}
[0m20:07:10.180720 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m20:07:10.182721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7db8166d-872a-40c5-ac70-e0b6d5902298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD51E563F0>]}
[0m20:07:10.185720 [info ] [MainThread]: 
[0m20:07:10.186719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:07:10.187720 [info ] [MainThread]: 
[0m20:07:10.188721 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:07:10.189719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m20:07:10.423171 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m20:07:10.424170 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:07:10.425168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:10.456981 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m20:07:10.459982 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:07:10.470496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m20:07:10.482898 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:07:10.483893 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m20:07:10.483893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:10.502123 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m20:07:10.502921 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:07:10.502921 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:07:10.507919 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m20:07:10.511492 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m20:07:10.512437 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m20:07:10.530717 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:10.531718 [debug] [MainThread]: On master: BEGIN
[0m20:07:10.531718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:10.554320 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:07:10.555318 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:10.556318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:07:10.564319 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m20:07:10.566318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7db8166d-872a-40c5-ac70-e0b6d5902298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD51B6BFB0>]}
[0m20:07:10.567318 [debug] [MainThread]: On master: ROLLBACK
[0m20:07:10.569314 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:10.570319 [debug] [MainThread]: On master: BEGIN
[0m20:07:10.571841 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:07:10.572838 [debug] [MainThread]: On master: COMMIT
[0m20:07:10.572838 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:10.572838 [debug] [MainThread]: On master: COMMIT
[0m20:07:10.574837 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:07:10.574837 [debug] [MainThread]: On master: Close
[0m20:07:10.584665 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_geographic_analysis
[0m20:07:10.586665 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_geographic_analysis ................... [RUN]
[0m20:07:10.587666 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_geographic_analysis'
[0m20:07:10.588664 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_geographic_analysis
[0m20:07:10.609077 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_geographic_analysis"
[0m20:07:10.610058 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_geographic_analysis
[0m20:07:10.695185 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_geographic_analysis"
[0m20:07:10.697186 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m20:07:10.698695 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: BEGIN
[0m20:07:10.699703 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:07:10.726977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m20:07:10.727980 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m20:07:10.728981 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_geographic_analysis"} */

  
    

  create  table "warehouse"."public"."mart_geographic_analysis__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.customer_state,
    c.customer_city,
    COUNT(DISTINCT c.customer_id) as total_customers,
    COUNT(f.order_id) as total_orders,
    SUM(f.total_order_value) as total_revenue,
    AVG(f.total_order_value) as avg_order_value,
    SUM(f.total_items) as total_items_sold,
    
    -- Métricas por cliente (conversão para NUMERIC)
    ROUND((SUM(f.total_order_value) / COUNT(DISTINCT c.customer_id))::numeric, 2) as revenue_per_customer,
    ROUND((COUNT(f.order_id)::numeric / COUNT(DISTINCT c.customer_id)), 2) as orders_per_customer,
    
    -- Participação no total
    ROUND((SUM(f.total_order_value) * 100.0 / SUM(SUM(f.total_order_value)) OVER ())::numeric, 2) as revenue_share_pct,
    ROUND((COUNT(DISTINCT c.customer_id) * 100.0 / SUM(COUNT(DISTINCT c.customer_id)) OVER ())::numeric, 2) as customer_share_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."dim_customers" c
JOIN "warehouse"."public"."fact_orders" f ON c.customer_id = f.customer_id
WHERE f.order_status = 'delivered'
GROUP BY c.customer_state, c.customer_city
HAVING COUNT(f.order_id) >= 10
ORDER BY total_revenue DESC
  );
  
[0m20:07:11.306625 [debug] [Thread-1 (]: SQL status: SELECT 928 in 0.576 seconds
[0m20:07:11.326468 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m20:07:11.327467 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_geographic_analysis"} */
alter table "warehouse"."public"."mart_geographic_analysis__dbt_tmp" rename to "mart_geographic_analysis"
[0m20:07:11.329471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:07:11.361124 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: COMMIT
[0m20:07:11.362126 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m20:07:11.363127 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: COMMIT
[0m20:07:11.365122 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:07:11.373125 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."mart_geographic_analysis__dbt_backup"
[0m20:07:11.383633 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m20:07:11.383633 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_geographic_analysis"} */
drop table if exists "warehouse"."public"."mart_geographic_analysis__dbt_backup" cascade
[0m20:07:11.385633 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:07:11.389637 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_geographic_analysis: Close
[0m20:07:11.394698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db8166d-872a-40c5-ac70-e0b6d5902298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4D0572C0>]}
[0m20:07:11.395294 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.mart_geographic_analysis .............. [[32mSELECT 928[0m in 0.80s]
[0m20:07:11.397228 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_geographic_analysis
[0m20:07:11.399222 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:11.399222 [debug] [MainThread]: On master: BEGIN
[0m20:07:11.400222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:11.418226 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m20:07:11.419224 [debug] [MainThread]: On master: COMMIT
[0m20:07:11.420236 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:11.420236 [debug] [MainThread]: On master: COMMIT
[0m20:07:11.422222 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:07:11.422222 [debug] [MainThread]: On master: Close
[0m20:07:11.424227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:11.425232 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m20:07:11.426225 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m20:07:11.427242 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_geographic_analysis' was properly closed.
[0m20:07:11.428227 [info ] [MainThread]: 
[0m20:07:11.428227 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m20:07:11.429230 [debug] [MainThread]: Command end result
[0m20:07:11.466654 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:07:11.471655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:07:11.491970 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m20:07:11.492977 [info ] [MainThread]: 
[0m20:07:11.493969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:07:11.494974 [info ] [MainThread]: 
[0m20:07:11.495965 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:07:11.497972 [debug] [MainThread]: Command `dbt run` succeeded at 20:07:11.497972 after 4.09 seconds
[0m20:07:11.498964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD514EBAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD514EBAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD514EBB30>]}
[0m20:07:11.498964 [debug] [MainThread]: Flushing usage events
[0m20:07:11.535398 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:27.967711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265192F4B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026519B01400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026516F824B0>]}


============================== 20:07:27.973710 | c706d078-da20-44a2-bbc6-0f7720e52d89 ==============================
[0m20:07:27.973710 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:07:27.974710 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select mart_payment_analysis', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m20:07:28.550150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c706d078-da20-44a2-bbc6-0f7720e52d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651B615520>]}
[0m20:07:28.728480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c706d078-da20-44a2-bbc6-0f7720e52d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265196BABA0>]}
[0m20:07:28.730477 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:07:29.201728 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:07:29.405470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:29.406463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:29.415076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
[0m20:07:29.459316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c706d078-da20-44a2-bbc6-0f7720e52d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651B5C7D10>]}
[0m20:07:29.560698 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:07:29.564700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:07:29.603043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c706d078-da20-44a2-bbc6-0f7720e52d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651BE05D00>]}
[0m20:07:29.604047 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m20:07:29.605046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c706d078-da20-44a2-bbc6-0f7720e52d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651BDBBE30>]}
[0m20:07:29.608043 [info ] [MainThread]: 
[0m20:07:29.609042 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:07:29.609042 [info ] [MainThread]: 
[0m20:07:29.611045 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:07:29.613044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m20:07:29.772592 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m20:07:29.772592 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:07:29.773592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:29.798619 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m20:07:29.800614 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:07:29.811615 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m20:07:29.823615 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:07:29.823615 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m20:07:29.823615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:29.839615 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m20:07:29.840616 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:07:29.840616 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:07:29.844620 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.003 seconds
[0m20:07:29.845615 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m20:07:29.846614 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m20:07:29.858127 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:29.858127 [debug] [MainThread]: On master: BEGIN
[0m20:07:29.859126 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:29.874127 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m20:07:29.875126 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:29.876125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:07:29.881126 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:07:29.882127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c706d078-da20-44a2-bbc6-0f7720e52d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651B9281A0>]}
[0m20:07:29.882127 [debug] [MainThread]: On master: ROLLBACK
[0m20:07:29.883127 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:29.884126 [debug] [MainThread]: On master: BEGIN
[0m20:07:29.885127 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:07:29.886126 [debug] [MainThread]: On master: COMMIT
[0m20:07:29.887125 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:29.887125 [debug] [MainThread]: On master: COMMIT
[0m20:07:29.888125 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:07:29.888125 [debug] [MainThread]: On master: Close
[0m20:07:29.895126 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_payment_analysis
[0m20:07:29.896127 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_payment_analysis ...................... [RUN]
[0m20:07:29.897127 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_payment_analysis'
[0m20:07:29.898130 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_payment_analysis
[0m20:07:29.914131 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_payment_analysis"
[0m20:07:29.917130 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_payment_analysis
[0m20:07:30.019296 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_payment_analysis"
[0m20:07:30.021285 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m20:07:30.022286 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: BEGIN
[0m20:07:30.023287 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:07:30.050221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m20:07:30.051225 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m20:07:30.052223 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_payment_analysis"} */

  
    

  create  table "warehouse"."public"."mart_payment_analysis__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    fp.payment_type_clean as payment_method,
    fp.installment_category,
    COUNT(*) as transaction_count,
    COUNT(DISTINCT fp.order_id) as unique_orders,
    SUM(fp.payment_value) as total_payment_value,
    AVG(fp.payment_value) as avg_payment_value,
    AVG(fp.payment_installments) as avg_installments,
    
    -- Participação por método
    ROUND((COUNT(*) * 100.0 / SUM(COUNT(*)) OVER ()), 2) as transaction_share_pct,
    ROUND((SUM(fp.payment_value) * 100.0 / SUM(SUM(fp.payment_value)) OVER ()), 2) as value_share_pct,
    
    -- Análise temporal
    DATE_TRUNC('month', fo.order_purchase_timestamp) as month_year,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."fact_payments" fp
JOIN "warehouse"."public"."fact_orders" fo ON fp.order_id = fo.order_id
WHERE fo.order_status = 'delivered'
    AND fo.order_purchase_timestamp IS NOT NULL
GROUP BY fp.payment_type_clean, fp.installment_category, DATE_TRUNC('month', fo.order_purchase_timestamp)
ORDER BY month_year DESC, total_payment_value DESC
  );
  
[0m20:07:30.055224 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 25:     ROUND((SUM(fp.payment_value) * 100.0 / SUM(SUM(fp.paymen...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:07:30.056819 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: ROLLBACK
[0m20:07:30.058227 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: Close
[0m20:07:30.080629 [debug] [Thread-1 (]: Database Error in model mart_payment_analysis (models\03 gold\mart_payment_analysis.sql)
  function round(double precision, integer) does not exist
  LINE 25:     ROUND((SUM(fp.payment_value) * 100.0 / SUM(SUM(fp.paymen...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_payment_analysis.sql
[0m20:07:30.084624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c706d078-da20-44a2-bbc6-0f7720e52d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265175290A0>]}
[0m20:07:30.085625 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.mart_payment_analysis ............. [[31mERROR[0m in 0.18s]
[0m20:07:30.087627 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_payment_analysis
[0m20:07:30.088623 [debug] [Thread-7 (]: Marking all children of 'model.olist_ecommerce.mart_payment_analysis' to be skipped because of status 'error'.  Reason: Database Error in model mart_payment_analysis (models\03 gold\mart_payment_analysis.sql)
  function round(double precision, integer) does not exist
  LINE 25:     ROUND((SUM(fp.payment_value) * 100.0 / SUM(SUM(fp.paymen...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_payment_analysis.sql.
[0m20:07:30.092623 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:30.092623 [debug] [MainThread]: On master: BEGIN
[0m20:07:30.093625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:30.115626 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m20:07:30.116630 [debug] [MainThread]: On master: COMMIT
[0m20:07:30.116630 [debug] [MainThread]: Using postgres connection "master"
[0m20:07:30.117624 [debug] [MainThread]: On master: COMMIT
[0m20:07:30.118625 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:07:30.119622 [debug] [MainThread]: On master: Close
[0m20:07:30.121627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:30.121627 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m20:07:30.122628 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m20:07:30.123623 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_payment_analysis' was properly closed.
[0m20:07:30.124622 [info ] [MainThread]: 
[0m20:07:30.125622 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m20:07:30.126623 [debug] [MainThread]: Command end result
[0m20:07:30.183726 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:07:30.188726 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:07:30.208766 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m20:07:30.208766 [info ] [MainThread]: 
[0m20:07:30.209766 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:07:30.210768 [info ] [MainThread]: 
[0m20:07:30.211768 [error] [MainThread]: [31mFailure in model mart_payment_analysis (models\03 gold\mart_payment_analysis.sql)[0m
[0m20:07:30.212771 [error] [MainThread]:   Database Error in model mart_payment_analysis (models\03 gold\mart_payment_analysis.sql)
  function round(double precision, integer) does not exist
  LINE 25:     ROUND((SUM(fp.payment_value) * 100.0 / SUM(SUM(fp.paymen...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_payment_analysis.sql
[0m20:07:30.213765 [info ] [MainThread]: 
[0m20:07:30.214765 [info ] [MainThread]:   compiled code at target\compiled\olist_ecommerce\models\03 gold\mart_payment_analysis.sql
[0m20:07:30.215765 [info ] [MainThread]: 
[0m20:07:30.216765 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:07:30.217764 [debug] [MainThread]: Command `dbt run` failed at 20:07:30.217764 after 2.62 seconds
[0m20:07:30.217764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026519E112B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651BDC9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026519B4F260>]}
[0m20:07:30.218762 [debug] [MainThread]: Flushing usage events
[0m20:07:30.225767 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:50.386764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F41C0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F48FA6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F48FADE0>]}


============================== 20:08:50.399448 | 803a43a0-2a71-4092-b4e8-97c31b4e3174 ==============================
[0m20:08:50.399448 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:08:50.407630 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select mart_payment_analysis', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m20:08:51.611308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '803a43a0-2a71-4092-b4e8-97c31b4e3174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F42B1520>]}
[0m20:08:51.824820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '803a43a0-2a71-4092-b4e8-97c31b4e3174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F4338230>]}
[0m20:08:51.826816 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:08:52.443705 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:08:52.726646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:08:52.727646 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\03 gold\mart_payment_analysis.sql
[0m20:08:53.856374 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
[0m20:08:53.879149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '803a43a0-2a71-4092-b4e8-97c31b4e3174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F6B3E7B0>]}
[0m20:08:54.080325 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:08:54.085325 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:08:54.200855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '803a43a0-2a71-4092-b4e8-97c31b4e3174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F6A1FBF0>]}
[0m20:08:54.201854 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m20:08:54.202853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '803a43a0-2a71-4092-b4e8-97c31b4e3174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F6B576E0>]}
[0m20:08:54.206856 [info ] [MainThread]: 
[0m20:08:54.207855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:08:54.209855 [info ] [MainThread]: 
[0m20:08:54.210854 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:08:54.212854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m20:08:54.472112 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m20:08:54.472112 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:08:54.472112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:54.502749 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.030 seconds
[0m20:08:54.503751 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:08:54.515967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m20:08:54.527967 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:08:54.528965 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m20:08:54.528965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:54.546529 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m20:08:54.547528 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:08:54.547528 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:08:54.550532 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.003 seconds
[0m20:08:54.552527 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m20:08:54.553527 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m20:08:54.563444 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:54.563444 [debug] [MainThread]: On master: BEGIN
[0m20:08:54.564444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:08:54.578375 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m20:08:54.579375 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:54.579375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:08:54.583373 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:08:54.585375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '803a43a0-2a71-4092-b4e8-97c31b4e3174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F69B7350>]}
[0m20:08:54.585375 [debug] [MainThread]: On master: ROLLBACK
[0m20:08:54.586376 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:54.586376 [debug] [MainThread]: On master: BEGIN
[0m20:08:54.588374 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:08:54.588374 [debug] [MainThread]: On master: COMMIT
[0m20:08:54.588374 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:54.589374 [debug] [MainThread]: On master: COMMIT
[0m20:08:54.589374 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:08:54.590374 [debug] [MainThread]: On master: Close
[0m20:08:54.595377 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_payment_analysis
[0m20:08:54.596376 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_payment_analysis ...................... [RUN]
[0m20:08:54.597377 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_payment_analysis'
[0m20:08:54.598378 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_payment_analysis
[0m20:08:54.608597 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_payment_analysis"
[0m20:08:54.609598 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_payment_analysis
[0m20:08:54.670752 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_payment_analysis"
[0m20:08:54.671749 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m20:08:54.672750 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: BEGIN
[0m20:08:54.672750 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:08:54.687454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m20:08:54.687454 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m20:08:54.688455 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_payment_analysis"} */

  
    

  create  table "warehouse"."public"."mart_payment_analysis__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    fp.payment_type_clean as payment_method,
    fp.installment_category,
    COUNT(*) as transaction_count,
    COUNT(DISTINCT fp.order_id) as unique_orders,
    SUM(fp.payment_value) as total_payment_value,
    AVG(fp.payment_value) as avg_payment_value,
    AVG(fp.payment_installments) as avg_installments,
    
    -- Participação por método (com conversão ::numeric)
    ROUND((COUNT(*) * 100.0 / SUM(COUNT(*)) OVER ())::numeric, 2) as transaction_share_pct,
    ROUND((SUM(fp.payment_value) * 100.0 / SUM(SUM(fp.payment_value)) OVER ())::numeric, 2) as value_share_pct,
    
    -- Análise temporal
    DATE_TRUNC('month', fo.order_purchase_timestamp) as month_year,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."fact_payments" fp
JOIN "warehouse"."public"."fact_orders" fo ON fp.order_id = fo.order_id
WHERE fo.order_status = 'delivered'
    AND fo.order_purchase_timestamp IS NOT NULL
GROUP BY fp.payment_type_clean, fp.installment_category, DATE_TRUNC('month', fo.order_purchase_timestamp)
ORDER BY month_year DESC, total_payment_value DESC
  );
  
[0m20:08:55.145023 [debug] [Thread-1 (]: SQL status: SELECT 148 in 0.457 seconds
[0m20:08:55.158016 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m20:08:55.159020 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_payment_analysis"} */
alter table "warehouse"."public"."mart_payment_analysis__dbt_tmp" rename to "mart_payment_analysis"
[0m20:08:55.160018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:08:55.185866 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: COMMIT
[0m20:08:55.186378 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m20:08:55.186378 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: COMMIT
[0m20:08:55.197379 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m20:08:55.210379 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."mart_payment_analysis__dbt_backup"
[0m20:08:55.217380 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m20:08:55.217380 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_payment_analysis"} */
drop table if exists "warehouse"."public"."mart_payment_analysis__dbt_backup" cascade
[0m20:08:55.218379 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:08:55.221386 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_payment_analysis: Close
[0m20:08:55.226379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '803a43a0-2a71-4092-b4e8-97c31b4e3174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F6DE7E90>]}
[0m20:08:55.227378 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.mart_payment_analysis ................. [[32mSELECT 148[0m in 0.63s]
[0m20:08:55.229378 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_payment_analysis
[0m20:08:55.231378 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:55.231378 [debug] [MainThread]: On master: BEGIN
[0m20:08:55.232377 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:08:55.250379 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m20:08:55.250379 [debug] [MainThread]: On master: COMMIT
[0m20:08:55.251379 [debug] [MainThread]: Using postgres connection "master"
[0m20:08:55.251379 [debug] [MainThread]: On master: COMMIT
[0m20:08:55.253175 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:08:55.254180 [debug] [MainThread]: On master: Close
[0m20:08:55.255173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:55.256177 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m20:08:55.257182 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m20:08:55.257182 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_payment_analysis' was properly closed.
[0m20:08:55.258173 [info ] [MainThread]: 
[0m20:08:55.262229 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m20:08:55.265176 [debug] [MainThread]: Command end result
[0m20:08:55.288744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:08:55.292744 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:08:55.307527 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m20:08:55.308527 [info ] [MainThread]: 
[0m20:08:55.308527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:08:55.309528 [info ] [MainThread]: 
[0m20:08:55.309528 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:08:55.311529 [debug] [MainThread]: Command `dbt run` succeeded at 20:08:55.311529 after 5.19 seconds
[0m20:08:55.311529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F6B576E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F6E67200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F6E676E0>]}
[0m20:08:55.311529 [debug] [MainThread]: Flushing usage events
[0m20:08:55.399308 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:09:07.412811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2B8FB0E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2B6D27470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2BB1957C0>]}


============================== 20:09:07.417852 | db4d01ca-db42-440e-9705-025daba71498 ==============================
[0m20:09:07.417852 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:09:07.418265 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select mart_product_performance', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt'}
[0m20:09:08.026540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db4d01ca-db42-440e-9705-025daba71498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2BA102360>]}
[0m20:09:08.269497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db4d01ca-db42-440e-9705-025daba71498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2B9478230>]}
[0m20:09:08.271599 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:09:08.852504 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:09:09.115569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:09:09.116576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:09:09.124912 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
[0m20:09:09.190396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db4d01ca-db42-440e-9705-025daba71498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2BB309AF0>]}
[0m20:09:09.308598 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:09:09.312890 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:09:09.348203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db4d01ca-db42-440e-9705-025daba71498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2BBA8F0B0>]}
[0m20:09:09.348718 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m20:09:09.349716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db4d01ca-db42-440e-9705-025daba71498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2BB72A300>]}
[0m20:09:09.353720 [info ] [MainThread]: 
[0m20:09:09.353720 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:09:09.355837 [info ] [MainThread]: 
[0m20:09:09.356698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:09:09.358219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m20:09:09.562548 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m20:09:09.562548 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:09:09.562548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:09.589271 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m20:09:09.590842 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:09:09.601204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m20:09:09.612208 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:09:09.612208 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m20:09:09.613207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:09.629669 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m20:09:09.630188 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:09:09.630706 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:09:09.636256 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m20:09:09.637664 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m20:09:09.638724 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m20:09:09.651074 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:09.652076 [debug] [MainThread]: On master: BEGIN
[0m20:09:09.652076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:09:09.668584 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m20:09:09.669579 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:09.670582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:09:09.676274 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m20:09:09.677840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db4d01ca-db42-440e-9705-025daba71498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2BBE4E720>]}
[0m20:09:09.678354 [debug] [MainThread]: On master: ROLLBACK
[0m20:09:09.679351 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:09.680356 [debug] [MainThread]: On master: BEGIN
[0m20:09:09.681354 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:09:09.681354 [debug] [MainThread]: On master: COMMIT
[0m20:09:09.682628 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:09.682628 [debug] [MainThread]: On master: COMMIT
[0m20:09:09.683685 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:09:09.684206 [debug] [MainThread]: On master: Close
[0m20:09:09.691083 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_product_performance
[0m20:09:09.692495 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_product_performance ................... [RUN]
[0m20:09:09.693553 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_product_performance'
[0m20:09:09.694601 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_product_performance
[0m20:09:09.706386 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_product_performance"
[0m20:09:09.708380 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_product_performance
[0m20:09:09.774350 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_product_performance"
[0m20:09:09.775353 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m20:09:09.775883 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: BEGIN
[0m20:09:09.776415 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:09:09.793491 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m20:09:09.794488 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m20:09:09.795487 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_product_performance"} */

  
    

  create  table "warehouse"."public"."mart_product_performance__dbt_tmp"
  
  
    as
  
  (
    

WITH product_sales AS (
    SELECT 
        p.product_id,
        p.category_en as product_category,
        p.category_pt as product_category_pt,
        COUNT(foi.order_item_id) as total_sales,
        SUM(foi.price) as total_revenue,
        SUM(foi.freight_value) as total_freight,
        AVG(foi.price) as avg_price,
        AVG(p.product_weight_g) as avg_weight,
        AVG(p.product_volume_cm3) as avg_volume
    FROM "warehouse"."public"."fact_order_items" foi
    JOIN "warehouse"."public"."dim_products" p ON foi.product_id = p.product_id
    JOIN "warehouse"."public"."fact_orders" o ON foi.order_id = o.order_id
    WHERE o.order_status = 'delivered'
    GROUP BY p.product_id, p.category_en, p.category_pt
),

category_totals AS (
    SELECT 
        product_category,
        SUM(total_revenue) as category_total_revenue
    FROM product_sales
    GROUP BY product_category
)

SELECT 
    ps.product_category,
    COUNT(ps.product_id) as unique_products,
    SUM(ps.total_sales) as total_units_sold,
    SUM(ps.total_revenue) as category_revenue,
    AVG(ps.avg_price) as avg_product_price,
    AVG(ps.avg_weight) as avg_product_weight,
    AVG(ps.avg_volume) as avg_product_volume,
    
    -- Ranking de categorias
    RANK() OVER (ORDER BY SUM(ps.total_revenue) DESC) as revenue_rank,
    RANK() OVER (ORDER BY SUM(ps.total_sales) DESC) as volume_rank,
    
    -- Participação no total
    ROUND((SUM(ps.total_revenue) * 100.0 / SUM(SUM(ps.total_revenue)) OVER ()), 2) as revenue_share_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM product_sales ps
GROUP BY ps.product_category
ORDER BY category_revenue DESC
  );
  
[0m20:09:09.797492 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 54:     ROUND((SUM(ps.total_revenue) * 100.0 / SUM(SUM(ps.total_...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:09:09.798491 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: ROLLBACK
[0m20:09:09.800489 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: Close
[0m20:09:09.814489 [debug] [Thread-1 (]: Database Error in model mart_product_performance (models\03 gold\mart_product_performance.sql)
  function round(double precision, integer) does not exist
  LINE 54:     ROUND((SUM(ps.total_revenue) * 100.0 / SUM(SUM(ps.total_...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_product_performance.sql
[0m20:09:09.816492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db4d01ca-db42-440e-9705-025daba71498', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2B93B4AA0>]}
[0m20:09:09.818267 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.mart_product_performance .......... [[31mERROR[0m in 0.12s]
[0m20:09:09.819906 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_product_performance
[0m20:09:09.820956 [debug] [Thread-7 (]: Marking all children of 'model.olist_ecommerce.mart_product_performance' to be skipped because of status 'error'.  Reason: Database Error in model mart_product_performance (models\03 gold\mart_product_performance.sql)
  function round(double precision, integer) does not exist
  LINE 54:     ROUND((SUM(ps.total_revenue) * 100.0 / SUM(SUM(ps.total_...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_product_performance.sql.
[0m20:09:09.824505 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:09.824505 [debug] [MainThread]: On master: BEGIN
[0m20:09:09.825505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:09:09.844020 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m20:09:09.844692 [debug] [MainThread]: On master: COMMIT
[0m20:09:09.845212 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:09.845557 [debug] [MainThread]: On master: COMMIT
[0m20:09:09.847383 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:09:09.847913 [debug] [MainThread]: On master: Close
[0m20:09:09.848958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:09.849957 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m20:09:09.849957 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m20:09:09.851147 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_product_performance' was properly closed.
[0m20:09:09.852194 [info ] [MainThread]: 
[0m20:09:09.852194 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m20:09:09.853195 [debug] [MainThread]: Command end result
[0m20:09:09.899168 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:09:09.904320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:09:09.922214 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m20:09:09.922858 [info ] [MainThread]: 
[0m20:09:09.923859 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:09:09.924857 [info ] [MainThread]: 
[0m20:09:09.925857 [error] [MainThread]: [31mFailure in model mart_product_performance (models\03 gold\mart_product_performance.sql)[0m
[0m20:09:09.926858 [error] [MainThread]:   Database Error in model mart_product_performance (models\03 gold\mart_product_performance.sql)
  function round(double precision, integer) does not exist
  LINE 54:     ROUND((SUM(ps.total_revenue) * 100.0 / SUM(SUM(ps.total_...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_product_performance.sql
[0m20:09:09.929092 [info ] [MainThread]: 
[0m20:09:09.930707 [info ] [MainThread]:   compiled code at target\compiled\olist_ecommerce\models\03 gold\mart_product_performance.sql
[0m20:09:09.931288 [info ] [MainThread]: 
[0m20:09:09.932381 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:09:09.935434 [debug] [MainThread]: Command `dbt run` failed at 20:09:09.934435 after 2.74 seconds
[0m20:09:09.936434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2B9F56030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2BB2B4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2BB633D70>]}
[0m20:09:09.936434 [debug] [MainThread]: Flushing usage events
[0m20:09:09.947602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:09:55.461728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7AE1B8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7ADDE37A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7ADDE30E0>]}


============================== 20:09:55.466727 | 7d6743af-8160-467d-bfe0-97c4f67356a6 ==============================
[0m20:09:55.466727 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:09:55.467728 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart_product_performance', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m20:09:56.040760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d6743af-8160-467d-bfe0-97c4f67356a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7AB894200>]}
[0m20:09:56.237963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d6743af-8160-467d-bfe0-97c4f67356a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7AD8C8D40>]}
[0m20:09:56.238964 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:09:56.641047 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:09:56.839370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:56.839370 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\03 gold\mart_product_performance.sql
[0m20:09:57.749302 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
[0m20:09:57.773295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d6743af-8160-467d-bfe0-97c4f67356a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7B06669C0>]}
[0m20:09:57.891848 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:09:57.896857 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:09:58.010958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d6743af-8160-467d-bfe0-97c4f67356a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7B054BEC0>]}
[0m20:09:58.011959 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m20:09:58.012960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d6743af-8160-467d-bfe0-97c4f67356a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7B054A4E0>]}
[0m20:09:58.019961 [info ] [MainThread]: 
[0m20:09:58.020963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:09:58.026963 [info ] [MainThread]: 
[0m20:09:58.030817 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:09:58.033810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m20:09:58.298046 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m20:09:58.298046 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:09:58.299044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:58.322452 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.023 seconds
[0m20:09:58.323449 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:09:58.332446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m20:09:58.345447 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:09:58.345447 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m20:09:58.345447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:58.363422 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m20:09:58.363422 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:09:58.364242 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:09:58.368044 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m20:09:58.369044 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m20:09:58.370045 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m20:09:58.384761 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:58.384761 [debug] [MainThread]: On master: BEGIN
[0m20:09:58.385760 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:09:58.405868 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m20:09:58.406864 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:58.406864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:09:58.413482 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m20:09:58.415481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d6743af-8160-467d-bfe0-97c4f67356a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7B08F6060>]}
[0m20:09:58.416483 [debug] [MainThread]: On master: ROLLBACK
[0m20:09:58.417483 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:58.417483 [debug] [MainThread]: On master: BEGIN
[0m20:09:58.420001 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:09:58.420001 [debug] [MainThread]: On master: COMMIT
[0m20:09:58.420001 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:58.421003 [debug] [MainThread]: On master: COMMIT
[0m20:09:58.421003 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:09:58.422002 [debug] [MainThread]: On master: Close
[0m20:09:58.429533 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_product_performance
[0m20:09:58.430533 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_product_performance ................... [RUN]
[0m20:09:58.431529 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_product_performance'
[0m20:09:58.432530 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_product_performance
[0m20:09:58.442734 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_product_performance"
[0m20:09:58.444733 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_product_performance
[0m20:09:58.627313 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_product_performance"
[0m20:09:58.628314 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m20:09:58.629315 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: BEGIN
[0m20:09:58.629315 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:09:58.646314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m20:09:58.646314 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m20:09:58.647316 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_product_performance"} */

  
    

  create  table "warehouse"."public"."mart_product_performance__dbt_tmp"
  
  
    as
  
  (
    

WITH product_sales AS (
    SELECT 
        p.product_id,
        p.category_en as product_category,
        p.category_pt as product_category_pt,
        COUNT(foi.order_item_id) as total_sales,
        SUM(foi.price) as total_revenue,
        SUM(foi.freight_value) as total_freight,
        AVG(foi.price) as avg_price,
        AVG(p.product_weight_g) as avg_weight,
        AVG(p.product_volume_cm3) as avg_volume
    FROM "warehouse"."public"."fact_order_items" foi
    JOIN "warehouse"."public"."dim_products" p ON foi.product_id = p.product_id
    JOIN "warehouse"."public"."fact_orders" o ON foi.order_id = o.order_id
    WHERE o.order_status = 'delivered'
    GROUP BY p.product_id, p.category_en, p.category_pt
)

SELECT 
    ps.product_category,
    COUNT(ps.product_id) as unique_products,
    SUM(ps.total_sales) as total_units_sold,
    SUM(ps.total_revenue) as category_revenue,
    AVG(ps.avg_price) as avg_product_price,
    AVG(ps.avg_weight) as avg_product_weight,
    AVG(ps.avg_volume) as avg_product_volume,
    
    -- Ranking de categorias
    RANK() OVER (ORDER BY SUM(ps.total_revenue) DESC) as revenue_rank,
    RANK() OVER (ORDER BY SUM(ps.total_sales) DESC) as volume_rank,
    
    -- Participação no total (com conversão ::numeric)
    ROUND((SUM(ps.total_revenue) * 100.0 / SUM(SUM(ps.total_revenue)) OVER ())::numeric, 2) as revenue_share_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM product_sales ps
GROUP BY ps.product_category
ORDER BY category_revenue DESC
  );
  
[0m20:09:59.094724 [debug] [Thread-1 (]: SQL status: SELECT 72 in 0.447 seconds
[0m20:09:59.113730 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m20:09:59.115513 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_product_performance"} */
alter table "warehouse"."public"."mart_product_performance__dbt_tmp" rename to "mart_product_performance"
[0m20:09:59.117516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:09:59.139135 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: COMMIT
[0m20:09:59.139135 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m20:09:59.140133 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: COMMIT
[0m20:09:59.142134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:09:59.152136 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."mart_product_performance__dbt_backup"
[0m20:09:59.161141 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m20:09:59.162136 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_product_performance"} */
drop table if exists "warehouse"."public"."mart_product_performance__dbt_backup" cascade
[0m20:09:59.163651 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:09:59.166654 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: Close
[0m20:09:59.170660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d6743af-8160-467d-bfe0-97c4f67356a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7B02E78F0>]}
[0m20:09:59.171663 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.mart_product_performance .............. [[32mSELECT 72[0m in 0.74s]
[0m20:09:59.173651 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_product_performance
[0m20:09:59.174651 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:59.175651 [debug] [MainThread]: On master: BEGIN
[0m20:09:59.175651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:09:59.195320 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m20:09:59.196314 [debug] [MainThread]: On master: COMMIT
[0m20:09:59.197321 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:59.197321 [debug] [MainThread]: On master: COMMIT
[0m20:09:59.199315 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:09:59.200316 [debug] [MainThread]: On master: Close
[0m20:09:59.202318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:59.203317 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m20:09:59.203317 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m20:09:59.204313 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_product_performance' was properly closed.
[0m20:09:59.204313 [info ] [MainThread]: 
[0m20:09:59.205313 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m20:09:59.206314 [debug] [MainThread]: Command end result
[0m20:09:59.240015 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:09:59.244016 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:09:59.260308 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m20:09:59.261325 [info ] [MainThread]: 
[0m20:09:59.265323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:09:59.266326 [info ] [MainThread]: 
[0m20:09:59.267331 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:09:59.270047 [debug] [MainThread]: Command `dbt run` succeeded at 20:09:59.270047 after 4.03 seconds
[0m20:09:59.271053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7ADEF0140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7AEBB89B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7AEBB8560>]}
[0m20:09:59.272047 [debug] [MainThread]: Flushing usage events
[0m20:09:59.308045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:22.313924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C2F854BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C302FFF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C302FDF40>]}


============================== 20:10:22.322921 | 1359add3-da27-4575-9b4e-f2472041d587 ==============================
[0m20:10:22.322921 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:10:22.329506 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select mart_sales_summary', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m20:10:23.230372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1359add3-da27-4575-9b4e-f2472041d587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C31C4BE00>]}
[0m20:10:23.464032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1359add3-da27-4575-9b4e-f2472041d587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C31F70470>]}
[0m20:10:23.465611 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:10:24.058619 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:10:24.407317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:24.407317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:24.420037 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
[0m20:10:24.504446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1359add3-da27-4575-9b4e-f2472041d587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C31FB0B30>]}
[0m20:10:24.640664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:10:24.646660 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:10:24.703837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1359add3-da27-4575-9b4e-f2472041d587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C32351C40>]}
[0m20:10:24.704837 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m20:10:24.705838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1359add3-da27-4575-9b4e-f2472041d587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C32312390>]}
[0m20:10:24.710841 [info ] [MainThread]: 
[0m20:10:24.711839 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:10:24.714784 [info ] [MainThread]: 
[0m20:10:24.716784 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:10:24.719783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m20:10:24.996751 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m20:10:24.997805 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:10:24.999110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:25.032012 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m20:10:25.035009 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:10:25.052009 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m20:10:25.065479 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:10:25.065479 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m20:10:25.066481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:25.087999 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m20:10:25.089000 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:10:25.089000 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:10:25.095910 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.005 seconds
[0m20:10:25.099915 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m20:10:25.100911 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m20:10:25.121877 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:25.122395 [debug] [MainThread]: On master: BEGIN
[0m20:10:25.123394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:10:25.148698 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m20:10:25.149705 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:25.150701 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:10:25.158033 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m20:10:25.160288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1359add3-da27-4575-9b4e-f2472041d587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C31F38DD0>]}
[0m20:10:25.160887 [debug] [MainThread]: On master: ROLLBACK
[0m20:10:25.162738 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:25.163255 [debug] [MainThread]: On master: BEGIN
[0m20:10:25.165739 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:10:25.166262 [debug] [MainThread]: On master: COMMIT
[0m20:10:25.167030 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:25.167610 [debug] [MainThread]: On master: COMMIT
[0m20:10:25.169201 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:10:25.169730 [debug] [MainThread]: On master: Close
[0m20:10:25.178134 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_sales_summary
[0m20:10:25.179194 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_sales_summary ......................... [RUN]
[0m20:10:25.180357 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_sales_summary'
[0m20:10:25.181477 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_sales_summary
[0m20:10:25.198434 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_sales_summary"
[0m20:10:25.201438 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_sales_summary
[0m20:10:25.292736 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_sales_summary"
[0m20:10:25.294737 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m20:10:25.295737 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: BEGIN
[0m20:10:25.296738 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:10:25.318223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m20:10:25.319223 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m20:10:25.319223 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_sales_summary"} */

  
    

  create  table "warehouse"."public"."mart_sales_summary__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    DATE_TRUNC('month', order_purchase_timestamp) as month_year,
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT customer_id) as unique_customers,
    SUM(total_order_value) as total_revenue,
    AVG(total_order_value) as avg_order_value,
    SUM(total_items) as total_items_sold,
    AVG(delivery_days_actual) as avg_delivery_days,
    
    -- Métricas de crescimento
    LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) as prev_month_orders,
    LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) as prev_month_revenue,
    
    -- Calcular crescimento percentual
    CASE 
        WHEN LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) > 0
        THEN ROUND(((COUNT(DISTINCT order_id) - LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))) * 100.0 / LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))), 2)
        ELSE NULL
    END as orders_growth_pct,
    
    CASE 
        WHEN LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) > 0
        THEN ROUND(((SUM(total_order_value) - LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))) * 100.0 / LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))), 2)
        ELSE NULL
    END as revenue_growth_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."fact_orders"
WHERE order_status = 'delivered'
    AND order_purchase_timestamp IS NOT NULL
GROUP BY DATE_TRUNC('month', order_purchase_timestamp)
ORDER BY month_year
  );
  
[0m20:10:25.323738 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 36:         THEN ROUND(((SUM(total_order_value) - LAG(SUM(total_...
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:10:25.324739 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: ROLLBACK
[0m20:10:25.325740 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: Close
[0m20:10:25.347243 [debug] [Thread-1 (]: Database Error in model mart_sales_summary (models\03 gold\mart_sales_summary.sql)
  function round(double precision, integer) does not exist
  LINE 36:         THEN ROUND(((SUM(total_order_value) - LAG(SUM(total_...
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_sales_summary.sql
[0m20:10:25.351245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1359add3-da27-4575-9b4e-f2472041d587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C2FC44920>]}
[0m20:10:25.352246 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.mart_sales_summary ................ [[31mERROR[0m in 0.17s]
[0m20:10:25.354243 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_sales_summary
[0m20:10:25.355242 [debug] [Thread-7 (]: Marking all children of 'model.olist_ecommerce.mart_sales_summary' to be skipped because of status 'error'.  Reason: Database Error in model mart_sales_summary (models\03 gold\mart_sales_summary.sql)
  function round(double precision, integer) does not exist
  LINE 36:         THEN ROUND(((SUM(total_order_value) - LAG(SUM(total_...
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_sales_summary.sql.
[0m20:10:25.359244 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:25.360242 [debug] [MainThread]: On master: BEGIN
[0m20:10:25.360242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:10:25.385407 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m20:10:25.386411 [debug] [MainThread]: On master: COMMIT
[0m20:10:25.386411 [debug] [MainThread]: Using postgres connection "master"
[0m20:10:25.387413 [debug] [MainThread]: On master: COMMIT
[0m20:10:25.389415 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:10:25.390409 [debug] [MainThread]: On master: Close
[0m20:10:25.391627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:25.392624 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m20:10:25.393625 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m20:10:25.394626 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_sales_summary' was properly closed.
[0m20:10:25.394626 [info ] [MainThread]: 
[0m20:10:25.395624 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m20:10:25.397626 [debug] [MainThread]: Command end result
[0m20:10:25.434540 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:10:25.439212 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:10:25.454015 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m20:10:25.455010 [info ] [MainThread]: 
[0m20:10:25.456010 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:10:25.457009 [info ] [MainThread]: 
[0m20:10:25.458008 [error] [MainThread]: [31mFailure in model mart_sales_summary (models\03 gold\mart_sales_summary.sql)[0m
[0m20:10:25.458008 [error] [MainThread]:   Database Error in model mart_sales_summary (models\03 gold\mart_sales_summary.sql)
  function round(double precision, integer) does not exist
  LINE 36:         THEN ROUND(((SUM(total_order_value) - LAG(SUM(total_...
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\olist_ecommerce\models\03 gold\mart_sales_summary.sql
[0m20:10:25.460010 [info ] [MainThread]: 
[0m20:10:25.460010 [info ] [MainThread]:   compiled code at target\compiled\olist_ecommerce\models\03 gold\mart_sales_summary.sql
[0m20:10:25.462009 [info ] [MainThread]: 
[0m20:10:25.463009 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:10:25.464012 [debug] [MainThread]: Command `dbt run` failed at 20:10:25.464012 after 3.47 seconds
[0m20:10:25.465011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C303A5D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C2FBF5D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C2FBF7170>]}
[0m20:10:25.465011 [debug] [MainThread]: Flushing usage events
[0m20:10:25.473710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:08.939372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA0572690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA0571310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA0572180>]}


============================== 20:11:08.943372 | 3fef55f3-c3c6-409e-ac0e-af0d90d57694 ==============================
[0m20:11:08.943372 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:11:08.944372 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select mart_sales_summary', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\p-rsousa\\Documents\\Nova pasta\\dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m20:11:09.584069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fef55f3-c3c6-409e-ac0e-af0d90d57694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA1DDBCE0>]}
[0m20:11:09.762634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fef55f3-c3c6-409e-ac0e-af0d90d57694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA1E04A40>]}
[0m20:11:09.763635 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:11:10.172141 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:11:10.459899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:11:10.460900 [debug] [MainThread]: Partial parsing: updated file: olist_ecommerce://models\03 gold\mart_sales_summary.sql
[0m20:11:11.108199 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m20:11:11.127193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fef55f3-c3c6-409e-ac0e-af0d90d57694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA26C67B0>]}
[0m20:11:11.214987 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:11:11.218987 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:11:11.311660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fef55f3-c3c6-409e-ac0e-af0d90d57694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA26C7950>]}
[0m20:11:11.312661 [info ] [MainThread]: Found 13 models, 9 sources, 434 macros
[0m20:11:11.313660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fef55f3-c3c6-409e-ac0e-af0d90d57694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA27D5CD0>]}
[0m20:11:11.315661 [info ] [MainThread]: 
[0m20:11:11.316660 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:11:11.317660 [info ] [MainThread]: 
[0m20:11:11.318662 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:11:11.326909 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m20:11:11.599320 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m20:11:11.600256 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m20:11:11.600256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:11.629691 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m20:11:11.632407 [debug] [ThreadPool]: On list_warehouse: Close
[0m20:11:11.643672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_public'
[0m20:11:11.654671 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:11:11.654671 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m20:11:11.655672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:11.678304 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m20:11:11.679305 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m20:11:11.679305 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:11:11.685134 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.005 seconds
[0m20:11:11.687141 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m20:11:11.689134 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m20:11:11.702133 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:11.702133 [debug] [MainThread]: On master: BEGIN
[0m20:11:11.703132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:11:11.724139 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m20:11:11.725139 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:11.726141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:11:11.731132 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:11:11.733133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fef55f3-c3c6-409e-ac0e-af0d90d57694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA26C6F00>]}
[0m20:11:11.733133 [debug] [MainThread]: On master: ROLLBACK
[0m20:11:11.734725 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:11.734725 [debug] [MainThread]: On master: BEGIN
[0m20:11:11.735724 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:11:11.736723 [debug] [MainThread]: On master: COMMIT
[0m20:11:11.736723 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:11.736723 [debug] [MainThread]: On master: COMMIT
[0m20:11:11.737724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:11:11.737724 [debug] [MainThread]: On master: Close
[0m20:11:11.743721 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_sales_summary
[0m20:11:11.743721 [info ] [Thread-1 (]: 1 of 1 START sql table model public.mart_sales_summary ......................... [RUN]
[0m20:11:11.744721 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.olist_ecommerce.mart_sales_summary'
[0m20:11:11.744721 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_sales_summary
[0m20:11:11.753405 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_sales_summary"
[0m20:11:11.754405 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_sales_summary
[0m20:11:11.804718 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_sales_summary"
[0m20:11:11.806718 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m20:11:11.806718 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: BEGIN
[0m20:11:11.807718 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:11:11.822718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m20:11:11.823716 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m20:11:11.824718 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_sales_summary"} */

  
    

  create  table "warehouse"."public"."mart_sales_summary__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    DATE_TRUNC('month', order_purchase_timestamp) as month_year,
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT customer_id) as unique_customers,
    SUM(total_order_value) as total_revenue,
    AVG(total_order_value) as avg_order_value,
    SUM(total_items) as total_items_sold,
    AVG(delivery_days_actual) as avg_delivery_days,
    
    -- Métricas de crescimento
    LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) as prev_month_orders,
    LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) as prev_month_revenue,
    
    -- Calcular crescimento percentual (com conversão ::numeric)
    CASE 
        WHEN LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) > 0
        THEN ROUND(((COUNT(DISTINCT order_id) - LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))) * 100.0 / LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)))::numeric, 2)
        ELSE NULL
    END as orders_growth_pct,
    
    CASE 
        WHEN LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) > 0
        THEN ROUND(((SUM(total_order_value) - LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))) * 100.0 / LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)))::numeric, 2)
        ELSE NULL
    END as revenue_growth_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."fact_orders"
WHERE order_status = 'delivered'
    AND order_purchase_timestamp IS NOT NULL
GROUP BY DATE_TRUNC('month', order_purchase_timestamp)
ORDER BY month_year
  );
  
[0m20:11:12.197329 [debug] [Thread-1 (]: SQL status: SELECT 23 in 0.373 seconds
[0m20:11:12.215279 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m20:11:12.216281 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_sales_summary"} */
alter table "warehouse"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m20:11:12.217282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:11:12.235829 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: COMMIT
[0m20:11:12.235829 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m20:11:12.235829 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: COMMIT
[0m20:11:12.238829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:11:12.245828 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."public"."mart_sales_summary__dbt_backup"
[0m20:11:12.254779 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m20:11:12.254779 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_sales_summary"} */
drop table if exists "warehouse"."public"."mart_sales_summary__dbt_backup" cascade
[0m20:11:12.256779 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:11:12.260782 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_sales_summary: Close
[0m20:11:12.269105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fef55f3-c3c6-409e-ac0e-af0d90d57694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA2AD4590>]}
[0m20:11:12.271105 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.mart_sales_summary .................... [[32mSELECT 23[0m in 0.52s]
[0m20:11:12.274106 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_sales_summary
[0m20:11:12.276107 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:12.276107 [debug] [MainThread]: On master: BEGIN
[0m20:11:12.277105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:11:12.300395 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m20:11:12.300915 [debug] [MainThread]: On master: COMMIT
[0m20:11:12.300915 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:12.300915 [debug] [MainThread]: On master: COMMIT
[0m20:11:12.301912 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:11:12.302912 [debug] [MainThread]: On master: Close
[0m20:11:12.303911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:12.304915 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m20:11:12.304915 [debug] [MainThread]: Connection 'list_warehouse_public' was properly closed.
[0m20:11:12.305915 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_sales_summary' was properly closed.
[0m20:11:12.306915 [info ] [MainThread]: 
[0m20:11:12.307913 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m20:11:12.309915 [debug] [MainThread]: Command end result
[0m20:11:12.362106 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\manifest.json
[0m20:11:12.367107 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\semantic_manifest.json
[0m20:11:12.403953 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\p-rsousa\Documents\Nova pasta\dbt\target\run_results.json
[0m20:11:12.404956 [info ] [MainThread]: 
[0m20:11:12.408760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:11:12.411159 [info ] [MainThread]: 
[0m20:11:12.413811 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:11:12.418565 [debug] [MainThread]: Command `dbt run` succeeded at 20:11:12.417726 after 3.70 seconds
[0m20:11:12.425818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA03EE630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA1D81100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA1D81850>]}
[0m20:11:12.426711 [debug] [MainThread]: Flushing usage events
[0m20:11:12.467207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:49.557929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfec6b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfc221300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfc221270>]}


============================== 00:23:49.574705 | 639c3aba-fa45-40ec-bae1-1c0340f8f48d ==============================
[0m00:23:49.574705 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:23:49.576309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models silver', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:23:49.813705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '639c3aba-fa45-40ec-bae1-1c0340f8f48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfc303460>]}
[0m00:23:49.846308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '639c3aba-fa45-40ec-bae1-1c0340f8f48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfc23c190>]}
[0m00:23:49.848237 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:23:49.863479 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:23:49.893221 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:23:49.894766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '639c3aba-fa45-40ec-bae1-1c0340f8f48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfe07c550>]}
[0m00:23:52.810417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m00:23:52.848147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '639c3aba-fa45-40ec-bae1-1c0340f8f48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfa819f00>]}
[0m00:23:53.084878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '639c3aba-fa45-40ec-bae1-1c0340f8f48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfa81aa70>]}
[0m00:23:53.097426 [info ] [MainThread]: Found 13 models, 9 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m00:23:53.110768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '639c3aba-fa45-40ec-bae1-1c0340f8f48d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfa81ab90>]}
[0m00:23:53.128879 [warn ] [MainThread]: The selection criterion 'silver' does not match any nodes
[0m00:23:53.147879 [info ] [MainThread]: 
[0m00:23:53.154143 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:23:53.156797 [debug] [MainThread]: Command end result
[0m00:23:53.491194 [debug] [MainThread]: Command `dbt run` succeeded at 00:23:53.490949 after 3.96 seconds
[0m00:23:53.496051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfec6b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfa826950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfc23c190>]}
[0m00:23:53.498881 [debug] [MainThread]: Flushing usage events
[0m00:24:01.474159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e57ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e2228ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e2228b50>]}


============================== 00:24:01.480613 | 7b2d5443-c9db-4e59-b962-d9bc4fc1d2d1 ==============================
[0m00:24:01.480613 [info ] [MainThread]: Running with dbt=1.6.0
[0m00:24:01.482143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models gold', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:24:01.625743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b2d5443-c9db-4e59-b962-d9bc4fc1d2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e41c8970>]}
[0m00:24:01.653446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b2d5443-c9db-4e59-b962-d9bc4fc1d2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e226e3b0>]}
[0m00:24:01.655142 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m00:24:01.672982 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m00:24:01.870571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:24:01.871828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:24:01.874071 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
[0m00:24:01.883501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b2d5443-c9db-4e59-b962-d9bc4fc1d2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e08280d0>]}
[0m00:24:01.916674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b2d5443-c9db-4e59-b962-d9bc4fc1d2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e07dee90>]}
[0m00:24:01.917905 [info ] [MainThread]: Found 13 models, 9 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m00:24:01.919083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b2d5443-c9db-4e59-b962-d9bc4fc1d2d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e07de950>]}
[0m00:24:01.920562 [warn ] [MainThread]: The selection criterion 'gold' does not match any nodes
[0m00:24:01.922729 [info ] [MainThread]: 
[0m00:24:01.924092 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:24:01.926225 [debug] [MainThread]: Command end result
[0m00:24:01.945013 [debug] [MainThread]: Command `dbt run` succeeded at 00:24:01.944779 after 0.49 seconds
[0m00:24:01.947549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e57ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e07f8130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1e07f8040>]}
[0m00:24:01.948911 [debug] [MainThread]: Flushing usage events
[0m02:53:59.698284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b211f2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ea61660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ea61600>]}


============================== 02:53:59.707950 | e946ad8b-0a06-4cc1-be4d-f803efdb53a5 ==============================
[0m02:53:59.707950 [info ] [MainThread]: Running with dbt=1.6.0
[0m02:53:59.709783 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt list', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/app/dbt', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'write_json': 'True', 'target_path': 'None', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/usr/app/dbt/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m02:53:59.893037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e946ad8b-0a06-4cc1-be4d-f803efdb53a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1e924f70>]}
[0m02:53:59.924650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e946ad8b-0a06-4cc1-be4d-f803efdb53a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ea63190>]}
[0m02:53:59.926432 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m02:53:59.942395 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m02:54:00.213317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:54:00.215165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:54:00.216914 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
[0m02:54:00.226620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e946ad8b-0a06-4cc1-be4d-f803efdb53a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1d917eb0>]}
[0m02:54:00.277311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e946ad8b-0a06-4cc1-be4d-f803efdb53a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ddd0880>]}
[0m02:54:00.279316 [info ] [MainThread]: Found 13 models, 9 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m02:54:00.290669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e946ad8b-0a06-4cc1-be4d-f803efdb53a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ddd0700>]}
[0m02:54:00.303992 [debug] [MainThread]: Command `dbt list` succeeded at 02:54:00.303025 after 0.63 seconds
[0m02:54:00.343718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b211f2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ddd0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b1ddd0820>]}
[0m02:54:00.345661 [debug] [MainThread]: Flushing usage events
[0m02:56:07.246290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286b985720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286927a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286927a080>]}


============================== 02:56:07.250764 | 8b68f6af-86b5-43de-abff-62587e77a13f ==============================
[0m02:56:07.250764 [info ] [MainThread]: Running with dbt=1.6.0
[0m02:56:07.252526 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --models 02 silver', 'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/usr/app/dbt/logs', 'quiet': 'False'}
[0m02:56:07.378867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b68f6af-86b5-43de-abff-62587e77a13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286927a0b0>]}
[0m02:56:07.424460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b68f6af-86b5-43de-abff-62587e77a13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2868508820>]}
[0m02:56:07.427198 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m02:56:07.448121 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m02:56:07.675058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:56:07.676208 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:56:07.677912 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
[0m02:56:07.688813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b68f6af-86b5-43de-abff-62587e77a13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28681f40d0>]}
[0m02:56:07.719118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b68f6af-86b5-43de-abff-62587e77a13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2868121d80>]}
[0m02:56:07.720385 [info ] [MainThread]: Found 13 models, 9 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m02:56:07.722009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b68f6af-86b5-43de-abff-62587e77a13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2868121cf0>]}
[0m02:56:07.723742 [warn ] [MainThread]: The selection criterion '02' does not match any nodes
[0m02:56:07.725456 [warn ] [MainThread]: The selection criterion 'silver' does not match any nodes
[0m02:56:07.728362 [info ] [MainThread]: 
[0m02:56:07.730141 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:56:07.732024 [debug] [MainThread]: Command end result
[0m02:56:07.758583 [debug] [MainThread]: Command `dbt run` succeeded at 02:56:07.758388 after 0.53 seconds
[0m02:56:07.759851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286b985720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f286850b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2868123160>]}
[0m02:56:07.760980 [debug] [MainThread]: Flushing usage events
[0m02:56:32.946779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcaaca62c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca8382080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca8381ff0>]}


============================== 02:56:32.950940 | 1e04834b-6d8e-48c7-ab02-6236ae6b1eac ==============================
[0m02:56:32.950940 [info ] [MainThread]: Running with dbt=1.6.0
[0m02:56:32.952915 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --select 02 silver.*', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'quiet': 'False', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_path': '/usr/app/dbt/logs', 'no_print': 'None'}
[0m02:56:33.071061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e04834b-6d8e-48c7-ab02-6236ae6b1eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca8382020>]}
[0m02:56:33.111699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e04834b-6d8e-48c7-ab02-6236ae6b1eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca7b08820>]}
[0m02:56:33.121662 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m02:56:33.162493 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m02:56:33.423355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:56:33.424599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:56:33.426376 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
[0m02:56:33.436112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e04834b-6d8e-48c7-ab02-6236ae6b1eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca77f80d0>]}
[0m02:56:33.474737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e04834b-6d8e-48c7-ab02-6236ae6b1eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca7711c60>]}
[0m02:56:33.476189 [info ] [MainThread]: Found 13 models, 9 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m02:56:33.478665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e04834b-6d8e-48c7-ab02-6236ae6b1eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca7711bd0>]}
[0m02:56:33.481392 [warn ] [MainThread]: The selection criterion '02' does not match any nodes
[0m02:56:33.484663 [warn ] [MainThread]: The selection criterion 'silver.*' does not match any nodes
[0m02:56:33.494878 [info ] [MainThread]: 
[0m02:56:33.497196 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:56:33.501763 [debug] [MainThread]: Command end result
[0m02:56:33.534461 [debug] [MainThread]: Command `dbt run` succeeded at 02:56:33.534218 after 0.61 seconds
[0m02:56:33.535957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcaaca62c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca7b0b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efca77130d0>]}
[0m02:56:33.539762 [debug] [MainThread]: Flushing usage events
[0m02:57:11.710454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d5ea1720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d35860b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d3586020>]}


============================== 02:57:11.714365 | 5a4dbd5b-be2e-47f2-b9dc-cf1fff62156d ==============================
[0m02:57:11.714365 [info ] [MainThread]: Running with dbt=1.6.0
[0m02:57:11.716155 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/usr/app/dbt', 'warn_error': 'None', 'log_cache_events': 'False', 'log_path': '/usr/app/dbt/logs', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'version_check': 'True', 'static_parser': 'True'}
[0m02:57:11.838134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a4dbd5b-be2e-47f2-b9dc-cf1fff62156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d3585ff0>]}
[0m02:57:11.870133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a4dbd5b-be2e-47f2-b9dc-cf1fff62156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d3656830>]}
[0m02:57:11.872124 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m02:57:11.892003 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m02:57:12.086417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:57:12.087553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:57:12.089423 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
[0m02:57:12.098885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a4dbd5b-be2e-47f2-b9dc-cf1fff62156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d29f80d0>]}
[0m02:57:12.127804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a4dbd5b-be2e-47f2-b9dc-cf1fff62156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d2915d80>]}
[0m02:57:12.128900 [info ] [MainThread]: Found 13 models, 9 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m02:57:12.130392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a4dbd5b-be2e-47f2-b9dc-cf1fff62156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d2915cf0>]}
[0m02:57:12.133819 [info ] [MainThread]: 
[0m02:57:12.136006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:57:12.139197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m02:57:12.158453 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m02:57:12.159669 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m02:57:12.160971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:12.162602 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m02:57:12.164073 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m02:57:12.165278 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m02:57:12.166378 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m02:57:12.167280 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m02:57:12.168233 [debug] [ThreadPool]: On list_warehouse: No close available on handle
[0m02:57:12.170038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:12.172140 [debug] [MainThread]: Connection 'list_warehouse' was properly closed.
[0m02:57:12.173910 [info ] [MainThread]: 
[0m02:57:12.175773 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m02:57:12.177562 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m02:57:12.179510 [debug] [MainThread]: Command `dbt run` failed at 02:57:12.179229 after 0.49 seconds
[0m02:57:12.180824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d5ea1720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d29170a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d25474c0>]}
[0m02:57:12.182034 [debug] [MainThread]: Flushing usage events
[0m03:00:12.617106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595f061720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595c975f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595c975630>]}


============================== 03:00:12.621720 | 71d86f3e-52a8-40f5-9dcf-19a9fe182610 ==============================
[0m03:00:12.621720 [info ] [MainThread]: Running with dbt=1.6.0
[0m03:00:12.623551 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'introspect': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'profiles_dir': '/usr/app/dbt', 'printer_width': '80', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True'}
[0m03:00:12.625476 [info ] [MainThread]: dbt version: 1.6.0
[0m03:00:12.626911 [info ] [MainThread]: python version: 3.10.18
[0m03:00:12.628491 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m03:00:12.632129 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m03:00:12.705575 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m03:00:12.707482 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m03:00:12.711237 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m03:00:12.714379 [info ] [MainThread]: adapter type: postgres
[0m03:00:12.716047 [info ] [MainThread]: adapter version: 1.6.0
[0m03:00:12.722970 [info ] [MainThread]: Configuration:
[0m03:00:12.724960 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:00:12.726383 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m03:00:12.727822 [info ] [MainThread]: Required dependencies:
[0m03:00:12.729320 [debug] [MainThread]: Executing "git --help"
[0m03:00:12.752659 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:00:12.754086 [debug] [MainThread]: STDERR: "b''"
[0m03:00:12.755228 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:00:12.757344 [info ] [MainThread]: Connection:
[0m03:00:12.759011 [info ] [MainThread]:   host: localhost
[0m03:00:12.760568 [info ] [MainThread]:   port: 5433
[0m03:00:12.762182 [info ] [MainThread]:   user: dbt
[0m03:00:12.764083 [info ] [MainThread]:   database: warehouse
[0m03:00:12.765679 [info ] [MainThread]:   schema: public
[0m03:00:12.767917 [info ] [MainThread]:   connect_timeout: 10
[0m03:00:12.770242 [info ] [MainThread]:   role: None
[0m03:00:12.772542 [info ] [MainThread]:   search_path: None
[0m03:00:12.774035 [info ] [MainThread]:   keepalives_idle: 0
[0m03:00:12.775706 [info ] [MainThread]:   sslmode: None
[0m03:00:12.777798 [info ] [MainThread]:   sslcert: None
[0m03:00:12.779215 [info ] [MainThread]:   sslkey: None
[0m03:00:12.780586 [info ] [MainThread]:   sslrootcert: None
[0m03:00:12.785636 [info ] [MainThread]:   application_name: dbt
[0m03:00:12.787390 [info ] [MainThread]:   retries: 1
[0m03:00:12.789283 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m03:00:12.793773 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m03:00:12.794921 [debug] [MainThread]: Using postgres connection "debug"
[0m03:00:12.795899 [debug] [MainThread]: On debug: select 1 as id
[0m03:00:12.797537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:12.801059 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m03:00:12.803435 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m03:00:12.804503 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m03:00:12.805431 [debug] [MainThread]: On debug: No close available on handle
[0m03:00:12.806316 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m03:00:12.808043 [info ] [MainThread]: [31m1 check failed:[0m
[0m03:00:12.810193 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  Required "name" field not present in project

Error encountered in /usr/app/dbt/dbt_project.yml


[0m03:00:12.812275 [debug] [MainThread]: Command `dbt debug` failed at 03:00:12.812021 after 0.22 seconds
[0m03:00:12.813517 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:00:12.814616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595f061720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595bf03c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f595bf03cd0>]}
[0m03:00:12.815666 [debug] [MainThread]: Flushing usage events
[0m03:00:27.848903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f875110d720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874e885f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874e885630>]}


============================== 03:00:27.854870 | ad658d04-9548-4a40-acc5-94c5e4b10002 ==============================
[0m03:00:27.854870 [info ] [MainThread]: Running with dbt=1.6.0
[0m03:00:27.856716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'profiles_dir': '/usr/app/dbt', 'write_json': 'True', 'partial_parse': 'True', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt debug'}
[0m03:00:27.859387 [info ] [MainThread]: dbt version: 1.6.0
[0m03:00:27.861236 [info ] [MainThread]: python version: 3.10.18
[0m03:00:27.863450 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m03:00:27.865334 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m03:00:27.937561 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m03:00:27.939216 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m03:00:27.941026 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m03:00:27.943069 [info ] [MainThread]: adapter type: postgres
[0m03:00:27.944503 [info ] [MainThread]: adapter version: 1.6.0
[0m03:00:27.993544 [info ] [MainThread]: Configuration:
[0m03:00:27.995079 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:00:27.996879 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:00:27.998671 [info ] [MainThread]: Required dependencies:
[0m03:00:28.000334 [debug] [MainThread]: Executing "git --help"
[0m03:00:28.003901 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:00:28.005356 [debug] [MainThread]: STDERR: "b''"
[0m03:00:28.006413 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:00:28.008316 [info ] [MainThread]: Connection:
[0m03:00:28.009699 [info ] [MainThread]:   host: localhost
[0m03:00:28.011280 [info ] [MainThread]:   port: 5433
[0m03:00:28.012922 [info ] [MainThread]:   user: dbt
[0m03:00:28.015152 [info ] [MainThread]:   database: warehouse
[0m03:00:28.018236 [info ] [MainThread]:   schema: public
[0m03:00:28.021908 [info ] [MainThread]:   connect_timeout: 10
[0m03:00:28.023519 [info ] [MainThread]:   role: None
[0m03:00:28.025171 [info ] [MainThread]:   search_path: None
[0m03:00:28.026907 [info ] [MainThread]:   keepalives_idle: 0
[0m03:00:28.029129 [info ] [MainThread]:   sslmode: None
[0m03:00:28.030633 [info ] [MainThread]:   sslcert: None
[0m03:00:28.032153 [info ] [MainThread]:   sslkey: None
[0m03:00:28.036505 [info ] [MainThread]:   sslrootcert: None
[0m03:00:28.038489 [info ] [MainThread]:   application_name: dbt
[0m03:00:28.040062 [info ] [MainThread]:   retries: 1
[0m03:00:28.041701 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m03:00:28.044157 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m03:00:28.045306 [debug] [MainThread]: Using postgres connection "debug"
[0m03:00:28.046320 [debug] [MainThread]: On debug: select 1 as id
[0m03:00:28.047182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:28.050271 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m03:00:28.052727 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m03:00:28.053908 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m03:00:28.055190 [debug] [MainThread]: On debug: No close available on handle
[0m03:00:28.056139 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m03:00:28.057507 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:00:28.061249 [debug] [MainThread]: Command `dbt debug` succeeded at 03:00:28.061038 after 0.24 seconds
[0m03:00:28.062323 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:00:28.064199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f875110d720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f875043c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874e95af50>]}
[0m03:00:28.065595 [debug] [MainThread]: Flushing usage events
[0m03:05:15.223015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49457f9720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49431760b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4943176020>]}


============================== 03:05:15.227686 | 0f75ac31-5363-4ef0-995d-66110a686395 ==============================
[0m03:05:15.227686 [info ] [MainThread]: Running with dbt=1.6.0
[0m03:05:15.229523 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/usr/app/dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None'}
[0m03:05:15.352486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4943175ff0>]}
[0m03:05:15.384259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f494304a7d0>]}
[0m03:05:15.385745 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m03:05:15.406478 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m03:05:15.427148 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:05:15.430043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4942751bd0>]}
[0m03:05:17.268801 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
[0m03:05:17.280672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941f63eb0>]}
[0m03:05:17.325486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941f629e0>]}
[0m03:05:17.327988 [info ] [MainThread]: Found 13 models, 9 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m03:05:17.338817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4942380730>]}
[0m03:05:17.343692 [info ] [MainThread]: 
[0m03:05:17.350867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:05:17.354213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m03:05:17.375073 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m03:05:17.376651 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m03:05:17.377673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:17.398519 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:05:17.400616 [debug] [ThreadPool]: On list_warehouse: Close
[0m03:05:17.404316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_public)
[0m03:05:17.413382 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m03:05:17.414414 [debug] [ThreadPool]: On list_warehouse_public: BEGIN
[0m03:05:17.415307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:17.423118 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:05:17.425036 [debug] [ThreadPool]: Using postgres connection "list_warehouse_public"
[0m03:05:17.426327 [debug] [ThreadPool]: On list_warehouse_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "list_warehouse_public"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:05:17.431331 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.0 seconds
[0m03:05:17.434012 [debug] [ThreadPool]: On list_warehouse_public: ROLLBACK
[0m03:05:17.435077 [debug] [ThreadPool]: On list_warehouse_public: Close
[0m03:05:17.447222 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:17.448264 [debug] [MainThread]: On master: BEGIN
[0m03:05:17.449154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:05:17.457508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:05:17.458498 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:17.459547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:05:17.492224 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:05:17.494449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941fea0e0>]}
[0m03:05:17.495748 [debug] [MainThread]: On master: ROLLBACK
[0m03:05:17.497124 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:17.498464 [debug] [MainThread]: On master: BEGIN
[0m03:05:17.499998 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:05:17.501302 [debug] [MainThread]: On master: COMMIT
[0m03:05:17.502452 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:17.503525 [debug] [MainThread]: On master: COMMIT
[0m03:05:17.505048 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:05:17.506179 [debug] [MainThread]: On master: Close
[0m03:05:17.507832 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:05:17.510273 [info ] [MainThread]: 
[0m03:05:17.526933 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.dim_customers
[0m03:05:17.528089 [debug] [Thread-2 (]: Began running node model.olist_ecommerce.dim_geolocation
[0m03:05:17.529027 [debug] [Thread-3 (]: Began running node model.olist_ecommerce.dim_products
[0m03:05:17.530111 [debug] [Thread-4 (]: Began running node model.olist_ecommerce.dim_sellers
[0m03:05:17.531697 [info ] [Thread-1 (]: 1 of 13 START sql table model public.dim_customers ............................. [RUN]
[0m03:05:17.533834 [info ] [Thread-2 (]: 2 of 13 START sql table model public.dim_geolocation ........................... [RUN]
[0m03:05:17.536037 [info ] [Thread-3 (]: 3 of 13 START sql table model public.dim_products .............................. [RUN]
[0m03:05:17.539069 [info ] [Thread-4 (]: 4 of 13 START sql table model public.dim_sellers ............................... [RUN]
[0m03:05:17.542829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_public, now model.olist_ecommerce.dim_customers)
[0m03:05:17.545009 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.olist_ecommerce.dim_geolocation'
[0m03:05:17.546963 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.olist_ecommerce.dim_products'
[0m03:05:17.550254 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.olist_ecommerce.dim_sellers'
[0m03:05:17.552175 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.dim_customers
[0m03:05:17.555108 [debug] [Thread-2 (]: Began compiling node model.olist_ecommerce.dim_geolocation
[0m03:05:17.556501 [debug] [Thread-3 (]: Began compiling node model.olist_ecommerce.dim_products
[0m03:05:17.557885 [debug] [Thread-4 (]: Began compiling node model.olist_ecommerce.dim_sellers
[0m03:05:17.572673 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.dim_customers"
[0m03:05:17.578839 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_ecommerce.dim_geolocation"
[0m03:05:17.586472 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_ecommerce.dim_products"
[0m03:05:17.592178 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_ecommerce.dim_sellers"
[0m03:05:17.599563 [debug] [Thread-2 (]: Timing info for model.olist_ecommerce.dim_geolocation (compile): 03:05:17.573452 => 03:05:17.598937
[0m03:05:17.602552 [debug] [Thread-1 (]: Timing info for model.olist_ecommerce.dim_customers (compile): 03:05:17.559014 => 03:05:17.601965
[0m03:05:17.603341 [debug] [Thread-2 (]: Began executing node model.olist_ecommerce.dim_geolocation
[0m03:05:17.604164 [debug] [Thread-4 (]: Timing info for model.olist_ecommerce.dim_sellers (compile): 03:05:17.587543 => 03:05:17.603762
[0m03:05:17.606179 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.dim_customers
[0m03:05:17.607289 [debug] [Thread-3 (]: Timing info for model.olist_ecommerce.dim_products (compile): 03:05:17.580200 => 03:05:17.606749
[0m03:05:17.630258 [debug] [Thread-4 (]: Began executing node model.olist_ecommerce.dim_sellers
[0m03:05:17.737868 [debug] [Thread-3 (]: Began executing node model.olist_ecommerce.dim_products
[0m03:05:17.764317 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.dim_customers"
[0m03:05:17.765197 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_ecommerce.dim_geolocation"
[0m03:05:17.776562 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_ecommerce.dim_sellers"
[0m03:05:17.799581 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_ecommerce.dim_products"
[0m03:05:17.801973 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.dim_geolocation"
[0m03:05:17.802984 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.dim_sellers"
[0m03:05:17.803769 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m03:05:17.805508 [debug] [Thread-2 (]: On model.olist_ecommerce.dim_geolocation: BEGIN
[0m03:05:17.806875 [debug] [Thread-4 (]: On model.olist_ecommerce.dim_sellers: BEGIN
[0m03:05:17.808223 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: BEGIN
[0m03:05:17.809559 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:05:17.811438 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:05:17.812405 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.dim_products"
[0m03:05:17.813485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:17.820914 [debug] [Thread-3 (]: On model.olist_ecommerce.dim_products: BEGIN
[0m03:05:17.828085 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:05:17.826824 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:17.828869 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:17.837257 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.dim_geolocation"
[0m03:05:17.836573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:17.831782 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.dim_sellers"
[0m03:05:17.838911 [debug] [Thread-2 (]: On model.olist_ecommerce.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_geolocation"} */

  
    

  create  table "warehouse"."public"."dim_geolocation__dbt_tmp"
  
  
    as
  
  (
    --dim_geolocation



WITH geo_clean AS (
    SELECT DISTINCT
        geolocation_zip_code_prefix,
        geolocation_lat,
        geolocation_lng,
        geolocation_city,
        geolocation_state
    FROM "warehouse"."public"."olist_geolocation_dataset"
    WHERE geolocation_lat BETWEEN -35 AND 5  -- Filtrar coordenadas válidas do Brasil
      AND geolocation_lng BETWEEN -75 AND -30
)

SELECT 
    ROW_NUMBER() OVER (ORDER BY geolocation_zip_code_prefix) as geo_id,
    geolocation_zip_code_prefix as zip_code_prefix,
    geolocation_lat as latitude,
    geolocation_lng as longitude,
    geolocation_city as city,
    geolocation_state as state,
    CURRENT_TIMESTAMP as created_at
FROM geo_clean
  );
  
[0m03:05:17.840740 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:17.841383 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m03:05:17.842734 [debug] [Thread-4 (]: On model.olist_ecommerce.dim_sellers: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_sellers"} */

  
    

  create  table "warehouse"."public"."dim_sellers__dbt_tmp"
  
  
    as
  
  (
    -- dim_sellers


SELECT 
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state,
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."olist_sellers_dataset"
  );
  
[0m03:05:17.844937 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.dim_products"
[0m03:05:17.846704 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */

  
    

  create  table "warehouse"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state,
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."olist_customers_dataset"
  );
  
[0m03:05:17.849287 [debug] [Thread-3 (]: On model.olist_ecommerce.dim_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_products"} */

  
    

  create  table "warehouse"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

-- dim_products.sql
SELECT 
    p.product_id,
    p.product_category_name as category_pt,
    COALESCE(t.product_category_name_english, 'Unknown') as category_en,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm,
    -- Calcular volume do produto
    CASE 
        WHEN p.product_length_cm > 0 AND p.product_height_cm > 0 AND p.product_width_cm > 0
        THEN p.product_length_cm * p.product_height_cm * p.product_width_cm
        ELSE NULL
    END as product_volume_cm3,
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."olist_products_dataset" p
LEFT JOIN "warehouse"."public"."product_category_name_translation" t
    ON p.product_category_name = t.product_category_name
  );
  
[0m03:05:17.865141 [debug] [Thread-4 (]: SQL status: SELECT 3095 in 0.0 seconds
[0m03:05:17.878132 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.dim_sellers"
[0m03:05:17.879627 [debug] [Thread-4 (]: On model.olist_ecommerce.dim_sellers: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_sellers"} */
alter table "warehouse"."public"."dim_sellers" rename to "dim_sellers__dbt_backup"
[0m03:05:17.881620 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:17.887436 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.dim_sellers"
[0m03:05:17.889100 [debug] [Thread-4 (]: On model.olist_ecommerce.dim_sellers: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_sellers"} */
alter table "warehouse"."public"."dim_sellers__dbt_tmp" rename to "dim_sellers"
[0m03:05:17.891037 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:17.938250 [debug] [Thread-4 (]: On model.olist_ecommerce.dim_sellers: COMMIT
[0m03:05:17.939447 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.dim_sellers"
[0m03:05:17.940645 [debug] [Thread-4 (]: On model.olist_ecommerce.dim_sellers: COMMIT
[0m03:05:17.978805 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:17.996372 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.dim_sellers"
[0m03:05:17.997752 [debug] [Thread-4 (]: On model.olist_ecommerce.dim_sellers: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_sellers"} */
drop table if exists "warehouse"."public"."dim_sellers__dbt_backup" cascade
[0m03:05:18.012231 [debug] [Thread-3 (]: SQL status: SELECT 32951 in 0.0 seconds
[0m03:05:18.019933 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:18.019450 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.dim_products"
[0m03:05:18.022962 [debug] [Thread-4 (]: Timing info for model.olist_ecommerce.dim_sellers (execute): 03:05:17.766149 => 03:05:18.022632
[0m03:05:18.025978 [debug] [Thread-4 (]: On model.olist_ecommerce.dim_sellers: Close
[0m03:05:18.024382 [debug] [Thread-3 (]: On model.olist_ecommerce.dim_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_products"} */
alter table "warehouse"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m03:05:18.029271 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941b15e40>]}
[0m03:05:18.031582 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:18.033052 [info ] [Thread-4 (]: 4 of 13 OK created sql table model public.dim_sellers .......................... [[32mSELECT 3095[0m in 0.48s]
[0m03:05:18.039577 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.dim_products"
[0m03:05:18.041351 [debug] [Thread-4 (]: Finished running node model.olist_ecommerce.dim_sellers
[0m03:05:18.042884 [debug] [Thread-3 (]: On model.olist_ecommerce.dim_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_products"} */
alter table "warehouse"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m03:05:18.044541 [debug] [Thread-4 (]: Began running node model.olist_ecommerce.fact_order_items
[0m03:05:18.047028 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:18.048035 [info ] [Thread-4 (]: 5 of 13 START sql table model public.fact_order_items .......................... [RUN]
[0m03:05:18.055111 [debug] [Thread-3 (]: On model.olist_ecommerce.dim_products: COMMIT
[0m03:05:18.058152 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_ecommerce.dim_sellers, now model.olist_ecommerce.fact_order_items)
[0m03:05:18.059878 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.dim_products"
[0m03:05:18.062634 [debug] [Thread-4 (]: Began compiling node model.olist_ecommerce.fact_order_items
[0m03:05:18.063973 [debug] [Thread-3 (]: On model.olist_ecommerce.dim_products: COMMIT
[0m03:05:18.069907 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_ecommerce.fact_order_items"
[0m03:05:18.078325 [debug] [Thread-4 (]: Timing info for model.olist_ecommerce.fact_order_items (compile): 03:05:18.065156 => 03:05:18.077961
[0m03:05:18.080125 [debug] [Thread-4 (]: Began executing node model.olist_ecommerce.fact_order_items
[0m03:05:18.089622 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_ecommerce.fact_order_items"
[0m03:05:18.100460 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:18.106220 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.dim_products"
[0m03:05:18.106897 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m03:05:18.107924 [debug] [Thread-3 (]: On model.olist_ecommerce.dim_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_products"} */
drop table if exists "warehouse"."public"."dim_products__dbt_backup" cascade
[0m03:05:18.109161 [debug] [Thread-4 (]: On model.olist_ecommerce.fact_order_items: BEGIN
[0m03:05:18.110893 [debug] [Thread-1 (]: SQL status: SELECT 99441 in 0.0 seconds
[0m03:05:18.114191 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:05:18.119826 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m03:05:18.122194 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:18.123845 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
alter table "warehouse"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m03:05:18.126962 [debug] [Thread-3 (]: Timing info for model.olist_ecommerce.dim_products (execute): 03:05:17.777497 => 03:05:18.126670
[0m03:05:18.128875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:18.129811 [debug] [Thread-3 (]: On model.olist_ecommerce.dim_products: Close
[0m03:05:18.130566 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:18.136056 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m03:05:18.138064 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941b6f2b0>]}
[0m03:05:18.139381 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m03:05:18.140695 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
alter table "warehouse"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m03:05:18.143985 [info ] [Thread-3 (]: 3 of 13 OK created sql table model public.dim_products ......................... [[32mSELECT 32951[0m in 0.59s]
[0m03:05:18.145906 [debug] [Thread-4 (]: On model.olist_ecommerce.fact_order_items: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_order_items"} */

  
    

  create  table "warehouse"."public"."fact_order_items__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    oi.order_id,
    oi.order_item_id,
    oi.product_id,
    oi.seller_id,
    oi.shipping_limit_date::timestamp as shipping_limit_date,
    oi.price,
    oi.freight_value,
    oi.price + oi.freight_value as total_item_value,
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."olist_order_items_dataset" oi
  );
  
[0m03:05:18.148051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:18.148975 [debug] [Thread-3 (]: Finished running node model.olist_ecommerce.dim_products
[0m03:05:18.153976 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m03:05:18.156158 [debug] [Thread-3 (]: Began running node model.olist_ecommerce.fact_orders
[0m03:05:18.160054 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m03:05:18.162958 [info ] [Thread-3 (]: 6 of 13 START sql table model public.fact_orders ............................... [RUN]
[0m03:05:18.166782 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: COMMIT
[0m03:05:18.168701 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_ecommerce.dim_products, now model.olist_ecommerce.fact_orders)
[0m03:05:18.171188 [debug] [Thread-3 (]: Began compiling node model.olist_ecommerce.fact_orders
[0m03:05:18.183559 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_ecommerce.fact_orders"
[0m03:05:18.184302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:18.192389 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.dim_customers"
[0m03:05:18.194414 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_customers"} */
drop table if exists "warehouse"."public"."dim_customers__dbt_backup" cascade
[0m03:05:18.201605 [debug] [Thread-3 (]: Timing info for model.olist_ecommerce.fact_orders (compile): 03:05:18.174010 => 03:05:18.201113
[0m03:05:18.206099 [debug] [Thread-3 (]: Began executing node model.olist_ecommerce.fact_orders
[0m03:05:18.216297 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_ecommerce.fact_orders"
[0m03:05:18.227864 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.fact_orders"
[0m03:05:18.228974 [debug] [Thread-3 (]: On model.olist_ecommerce.fact_orders: BEGIN
[0m03:05:18.229939 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:05:18.236031 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:18.239691 [debug] [Thread-1 (]: Timing info for model.olist_ecommerce.dim_customers (execute): 03:05:17.682638 => 03:05:18.239434
[0m03:05:18.240729 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:18.241490 [debug] [Thread-1 (]: On model.olist_ecommerce.dim_customers: Close
[0m03:05:18.242542 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.fact_orders"
[0m03:05:18.244166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941761ab0>]}
[0m03:05:18.245503 [debug] [Thread-3 (]: On model.olist_ecommerce.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_orders"} */

  
    

  create  table "warehouse"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

WITH order_items_agg AS (
    SELECT 
        order_id,
        COUNT(*) as total_items,
        SUM(price) as total_product_value,
        SUM(freight_value) as total_freight_value,
        SUM(price + freight_value) as total_order_value,
        AVG(price) as avg_item_price,
        MAX(price) as max_item_price,
        MIN(price) as min_item_price
    FROM "warehouse"."public"."olist_order_items_dataset"
    GROUP BY order_id
),

order_payments_agg AS (
    SELECT 
        order_id,
        SUM(payment_value) as total_payment_value,
        COUNT(DISTINCT payment_type) as payment_methods_count,
        STRING_AGG(DISTINCT payment_type, ', ') as payment_types,
        AVG(payment_installments) as avg_installments
    FROM "warehouse"."public"."olist_order_payments_dataset"
    GROUP BY order_id
)

SELECT 
    o.order_id,
    o.customer_id,
    o.order_status,
    o.order_purchase_timestamp::timestamp as order_purchase_timestamp,
    o.order_approved_at::timestamp as order_approved_at,
    o.order_delivered_carrier_date::timestamp as order_delivered_carrier_date,
    o.order_delivered_customer_date::timestamp as order_delivered_customer_date,
    o.order_estimated_delivery_date::timestamp as order_estimated_delivery_date,
    
    -- Métricas de itens
    oi.total_items,
    oi.total_product_value,
    oi.total_freight_value,
    oi.total_order_value,
    oi.avg_item_price,
    oi.max_item_price,
    oi.min_item_price,
    
    -- Métricas de pagamento
    op.total_payment_value,
    op.payment_methods_count,
    op.payment_types,
    op.avg_installments,
    
    -- Métricas de tempo (em dias)
    CASE 
        WHEN o.order_delivered_customer_date IS NOT NULL AND o.order_purchase_timestamp IS NOT NULL
        THEN EXTRACT(DAYS FROM (o.order_delivered_customer_date::timestamp - o.order_purchase_timestamp::timestamp))
        ELSE NULL 
    END as delivery_days_actual,
    
    CASE 
        WHEN o.order_estimated_delivery_date IS NOT NULL AND o.order_purchase_timestamp IS NOT NULL
        THEN EXTRACT(DAYS FROM (o.order_estimated_delivery_date::timestamp - o.order_purchase_timestamp::timestamp))
        ELSE NULL 
    END as delivery_days_estimated,
    
    -- Indicadores de qualidade
    CASE 
        WHEN o.order_delivered_customer_date IS NOT NULL AND o.order_estimated_delivery_date IS NOT NULL
        THEN CASE 
            WHEN o.order_delivered_customer_date::timestamp <= o.order_estimated_delivery_date::timestamp 
            THEN 'On Time' 
            ELSE 'Late' 
        END
        ELSE NULL
    END as delivery_status,
    
    CURRENT_TIMESTAMP as created_at
    
FROM "warehouse"."public"."olist_orders_dataset" o
LEFT JOIN order_items_agg oi ON o.order_id = oi.order_id  
LEFT JOIN order_payments_agg op ON o.order_id = op.order_id
WHERE o.order_status IS NOT NULL
  );
  
[0m03:05:18.248185 [info ] [Thread-1 (]: 1 of 13 OK created sql table model public.dim_customers ........................ [[32mSELECT 99441[0m in 0.70s]
[0m03:05:18.256450 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.dim_customers
[0m03:05:18.258215 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.fact_payments
[0m03:05:18.260525 [info ] [Thread-1 (]: 7 of 13 START sql table model public.fact_payments ............................. [RUN]
[0m03:05:18.266196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_ecommerce.dim_customers, now model.olist_ecommerce.fact_payments)
[0m03:05:18.276422 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.fact_payments
[0m03:05:18.284279 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.fact_payments"
[0m03:05:18.296484 [debug] [Thread-1 (]: Timing info for model.olist_ecommerce.fact_payments (compile): 03:05:18.277891 => 03:05:18.296069
[0m03:05:18.298981 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.fact_payments
[0m03:05:18.309848 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.fact_payments"
[0m03:05:18.320969 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_payments"
[0m03:05:18.322480 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: BEGIN
[0m03:05:18.323931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:18.338528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:18.342719 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_payments"
[0m03:05:18.347591 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_payments"} */

  
    

  create  table "warehouse"."public"."fact_payments__dbt_tmp"
  
  
    as
  
  (
    -- fact_payments


SELECT 
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value,
    -- Categorizar tipos de pagamento
    CASE 
        WHEN payment_type = 'credit_card' THEN 'Credit Card'
        WHEN payment_type = 'boleto' THEN 'Bank Slip'
        WHEN payment_type = 'voucher' THEN 'Voucher'
        WHEN payment_type = 'debit_card' THEN 'Debit Card'
        ELSE 'Other'
    END as payment_type_clean,
    
    -- Categorizar parcelamento
    CASE 
        WHEN payment_installments = 1 THEN 'Single Payment'
        WHEN payment_installments BETWEEN 2 AND 6 THEN 'Short Term (2-6x)'
        WHEN payment_installments BETWEEN 7 AND 12 THEN 'Medium Term (7-12x)'
        WHEN payment_installments > 12 THEN 'Long Term (12x+)'
        ELSE 'Unknown'
    END as installment_category,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."olist_order_payments_dataset"
  );
  
[0m03:05:18.580315 [debug] [Thread-4 (]: SQL status: SELECT 112650 in 0.0 seconds
[0m03:05:18.588152 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m03:05:18.590061 [debug] [Thread-4 (]: On model.olist_ecommerce.fact_order_items: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_order_items"} */
alter table "warehouse"."public"."fact_order_items" rename to "fact_order_items__dbt_backup"
[0m03:05:18.621091 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:18.638786 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m03:05:18.647578 [debug] [Thread-4 (]: On model.olist_ecommerce.fact_order_items: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_order_items"} */
alter table "warehouse"."public"."fact_order_items__dbt_tmp" rename to "fact_order_items"
[0m03:05:18.692809 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:18.707971 [debug] [Thread-4 (]: On model.olist_ecommerce.fact_order_items: COMMIT
[0m03:05:18.710420 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m03:05:18.712630 [debug] [Thread-4 (]: On model.olist_ecommerce.fact_order_items: COMMIT
[0m03:05:18.741203 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:18.749921 [debug] [Thread-1 (]: SQL status: SELECT 103886 in 0.0 seconds
[0m03:05:18.771742 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.fact_order_items"
[0m03:05:18.780924 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_payments"
[0m03:05:18.783853 [debug] [Thread-4 (]: On model.olist_ecommerce.fact_order_items: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_order_items"} */
drop table if exists "warehouse"."public"."fact_order_items__dbt_backup" cascade
[0m03:05:18.785648 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_payments"} */
alter table "warehouse"."public"."fact_payments" rename to "fact_payments__dbt_backup"
[0m03:05:18.794629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:18.806277 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:18.813521 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_payments"
[0m03:05:18.818007 [debug] [Thread-4 (]: Timing info for model.olist_ecommerce.fact_order_items (execute): 03:05:18.082995 => 03:05:18.817522
[0m03:05:18.825158 [debug] [Thread-4 (]: On model.olist_ecommerce.fact_order_items: Close
[0m03:05:18.819838 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_payments"} */
alter table "warehouse"."public"."fact_payments__dbt_tmp" rename to "fact_payments"
[0m03:05:18.830389 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f494171bfa0>]}
[0m03:05:18.833851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:18.835574 [info ] [Thread-4 (]: 5 of 13 OK created sql table model public.fact_order_items ..................... [[32mSELECT 112650[0m in 0.77s]
[0m03:05:18.841873 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: COMMIT
[0m03:05:18.847293 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_payments"
[0m03:05:18.848669 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: COMMIT
[0m03:05:18.845559 [debug] [Thread-4 (]: Finished running node model.olist_ecommerce.fact_order_items
[0m03:05:18.854805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:18.861773 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.fact_payments"
[0m03:05:18.864375 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_payments"} */
drop table if exists "warehouse"."public"."fact_payments__dbt_backup" cascade
[0m03:05:18.868667 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:18.871997 [debug] [Thread-1 (]: Timing info for model.olist_ecommerce.fact_payments (execute): 03:05:18.300773 => 03:05:18.871619
[0m03:05:18.873276 [debug] [Thread-1 (]: On model.olist_ecommerce.fact_payments: Close
[0m03:05:18.877627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941bb1d20>]}
[0m03:05:18.879301 [info ] [Thread-1 (]: 7 of 13 OK created sql table model public.fact_payments ........................ [[32mSELECT 103886[0m in 0.61s]
[0m03:05:18.881668 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.fact_payments
[0m03:05:20.621391 [debug] [Thread-3 (]: SQL status: SELECT 99441 in 2.0 seconds
[0m03:05:20.629339 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.fact_orders"
[0m03:05:20.631371 [debug] [Thread-3 (]: On model.olist_ecommerce.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_orders"} */
alter table "warehouse"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m03:05:20.633661 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:20.642654 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.fact_orders"
[0m03:05:20.644162 [debug] [Thread-3 (]: On model.olist_ecommerce.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_orders"} */
alter table "warehouse"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m03:05:20.684784 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:20.688158 [debug] [Thread-3 (]: On model.olist_ecommerce.fact_orders: COMMIT
[0m03:05:20.689358 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.fact_orders"
[0m03:05:20.690471 [debug] [Thread-3 (]: On model.olist_ecommerce.fact_orders: COMMIT
[0m03:05:20.696540 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:20.700953 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.fact_orders"
[0m03:05:20.702125 [debug] [Thread-3 (]: On model.olist_ecommerce.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.fact_orders"} */
drop table if exists "warehouse"."public"."fact_orders__dbt_backup" cascade
[0m03:05:20.706898 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:20.709355 [debug] [Thread-3 (]: Timing info for model.olist_ecommerce.fact_orders (execute): 03:05:18.207840 => 03:05:20.709108
[0m03:05:20.710478 [debug] [Thread-3 (]: On model.olist_ecommerce.fact_orders: Close
[0m03:05:20.712358 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941b360e0>]}
[0m03:05:20.714797 [info ] [Thread-3 (]: 6 of 13 OK created sql table model public.fact_orders .......................... [[32mSELECT 99441[0m in 2.54s]
[0m03:05:20.717183 [debug] [Thread-3 (]: Finished running node model.olist_ecommerce.fact_orders
[0m03:05:20.722752 [debug] [Thread-4 (]: Began running node model.olist_ecommerce.mart_customer_analysis
[0m03:05:20.723600 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_delivery_performance
[0m03:05:20.724189 [debug] [Thread-3 (]: Began running node model.olist_ecommerce.mart_geographic_analysis
[0m03:05:20.725558 [info ] [Thread-4 (]: 8 of 13 START sql table model public.mart_customer_analysis .................... [RUN]
[0m03:05:20.729150 [info ] [Thread-1 (]: 9 of 13 START sql table model public.mart_delivery_performance ................. [RUN]
[0m03:05:20.731582 [info ] [Thread-3 (]: 10 of 13 START sql table model public.mart_geographic_analysis ................. [RUN]
[0m03:05:20.734538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_ecommerce.fact_order_items, now model.olist_ecommerce.mart_customer_analysis)
[0m03:05:20.739401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_ecommerce.fact_payments, now model.olist_ecommerce.mart_delivery_performance)
[0m03:05:20.741128 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_ecommerce.fact_orders, now model.olist_ecommerce.mart_geographic_analysis)
[0m03:05:20.742574 [debug] [Thread-4 (]: Began compiling node model.olist_ecommerce.mart_customer_analysis
[0m03:05:20.744046 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_delivery_performance
[0m03:05:20.745482 [debug] [Thread-3 (]: Began compiling node model.olist_ecommerce.mart_geographic_analysis
[0m03:05:20.751014 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_ecommerce.mart_customer_analysis"
[0m03:05:20.756691 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_delivery_performance"
[0m03:05:20.763820 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_ecommerce.mart_geographic_analysis"
[0m03:05:20.773161 [debug] [Thread-3 (]: Timing info for model.olist_ecommerce.mart_geographic_analysis (compile): 03:05:20.757962 => 03:05:20.772586
[0m03:05:20.775723 [debug] [Thread-4 (]: Timing info for model.olist_ecommerce.mart_customer_analysis (compile): 03:05:20.746581 => 03:05:20.775255
[0m03:05:20.776958 [debug] [Thread-3 (]: Began executing node model.olist_ecommerce.mart_geographic_analysis
[0m03:05:20.778004 [debug] [Thread-1 (]: Timing info for model.olist_ecommerce.mart_delivery_performance (compile): 03:05:20.752064 => 03:05:20.777492
[0m03:05:20.779014 [debug] [Thread-4 (]: Began executing node model.olist_ecommerce.mart_customer_analysis
[0m03:05:20.787904 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_ecommerce.mart_geographic_analysis"
[0m03:05:20.788905 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_delivery_performance
[0m03:05:20.798374 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_ecommerce.mart_customer_analysis"
[0m03:05:20.808093 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_delivery_performance"
[0m03:05:20.810848 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m03:05:20.814828 [debug] [Thread-3 (]: On model.olist_ecommerce.mart_geographic_analysis: BEGIN
[0m03:05:20.815668 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m03:05:20.816957 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:05:20.819523 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m03:05:20.820598 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_customer_analysis: BEGIN
[0m03:05:20.822857 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: BEGIN
[0m03:05:20.824356 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:05:20.825671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:20.843217 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:20.844538 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:20.853859 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m03:05:20.856400 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m03:05:20.858694 [debug] [Thread-3 (]: On model.olist_ecommerce.mart_geographic_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_geographic_analysis"} */

  
    

  create  table "warehouse"."public"."mart_geographic_analysis__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.customer_state,
    c.customer_city,
    COUNT(DISTINCT c.customer_id) as total_customers,
    COUNT(f.order_id) as total_orders,
    SUM(f.total_order_value) as total_revenue,
    AVG(f.total_order_value) as avg_order_value,
    SUM(f.total_items) as total_items_sold,
    
    -- Métricas por cliente (conversão para NUMERIC)
    ROUND((SUM(f.total_order_value) / COUNT(DISTINCT c.customer_id))::numeric, 2) as revenue_per_customer,
    ROUND((COUNT(f.order_id)::numeric / COUNT(DISTINCT c.customer_id)), 2) as orders_per_customer,
    
    -- Participação no total
    ROUND((SUM(f.total_order_value) * 100.0 / SUM(SUM(f.total_order_value)) OVER ())::numeric, 2) as revenue_share_pct,
    ROUND((COUNT(DISTINCT c.customer_id) * 100.0 / SUM(COUNT(DISTINCT c.customer_id)) OVER ())::numeric, 2) as customer_share_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."dim_customers" c
JOIN "warehouse"."public"."fact_orders" f ON c.customer_id = f.customer_id
WHERE f.order_status = 'delivered'
GROUP BY c.customer_state, c.customer_city
HAVING COUNT(f.order_id) >= 10
ORDER BY total_revenue DESC
  );
  
[0m03:05:20.863216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:20.872791 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_customer_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_customer_analysis"} */

  
    

  create  table "warehouse"."public"."mart_customer_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH customer_metrics AS (
    SELECT 
        c.customer_id,
        c.customer_city,
        c.customer_state,
        COUNT(f.order_id) as total_orders,
        SUM(f.total_order_value) as total_spent,
        AVG(f.total_order_value) as avg_order_value,
        MIN(f.order_purchase_timestamp) as first_order_date,
        MAX(f.order_purchase_timestamp) as last_order_date,
        SUM(f.total_items) as total_items_purchased
    FROM "warehouse"."public"."fact_orders" f
    JOIN "warehouse"."public"."dim_customers" c ON f.customer_id = c.customer_id
    WHERE f.order_status = 'delivered'
    GROUP BY c.customer_id, c.customer_city, c.customer_state
),

customer_segments AS (
    SELECT 
        *,
        EXTRACT(DAYS FROM (last_order_date - first_order_date)) as customer_lifetime_days,
        CASE 
            WHEN total_orders = 1 THEN 'One-time'
            WHEN total_orders BETWEEN 2 AND 3 THEN 'Occasional'
            WHEN total_orders BETWEEN 4 AND 8 THEN 'Regular'
            ELSE 'Frequent'
        END as customer_segment,
        
        CASE 
            WHEN total_spent < 100 THEN 'Low Value'
            WHEN total_spent BETWEEN 100 AND 500 THEN 'Medium Value'
            WHEN total_spent BETWEEN 500 AND 1500 THEN 'High Value'
            ELSE 'Premium'
        END as customer_value_segment
    FROM customer_metrics
)

SELECT 
    customer_state,
    customer_segment,
    customer_value_segment,
    COUNT(*) as customer_count,
    SUM(total_spent) as segment_revenue,
    AVG(total_spent) as avg_customer_value,
    AVG(total_orders) as avg_orders_per_customer,
    AVG(avg_order_value) as avg_order_value,
    CURRENT_TIMESTAMP as created_at
FROM customer_segments
GROUP BY customer_state, customer_segment, customer_value_segment
ORDER BY customer_state, segment_revenue DESC
  );
  
[0m03:05:20.884435 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m03:05:20.898044 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_delivery_performance"} */

  
    

  create  table "warehouse"."public"."mart_delivery_performance__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    c.customer_state,
    f.delivery_status,
    COUNT(*) as order_count,
    AVG(f.delivery_days_actual) as avg_actual_delivery_days,
    AVG(f.delivery_days_estimated) as avg_estimated_delivery_days,
    
    -- Percentis de entrega
    PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY f.delivery_days_actual) as median_delivery_days,
    PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY f.delivery_days_actual) as p90_delivery_days,
    
    -- Taxa de pontualidade
    ROUND((SUM(CASE WHEN f.delivery_status = 'On Time' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) as on_time_delivery_rate,
    
    -- Diferença entre estimado vs real
    AVG(f.delivery_days_actual - f.delivery_days_estimated) as avg_delivery_variance,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."fact_orders" f
JOIN "warehouse"."public"."dim_customers" c ON f.customer_id = c.customer_id
WHERE f.order_status = 'delivered'
    AND f.delivery_days_actual IS NOT NULL
    AND f.delivery_days_estimated IS NOT NULL
GROUP BY c.customer_state, f.delivery_status
ORDER BY c.customer_state, order_count DESC
  );
  
[0m03:05:21.218150 [debug] [Thread-2 (]: SQL status: SELECT 738307 in 3.0 seconds
[0m03:05:21.223986 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.dim_geolocation"
[0m03:05:21.225374 [debug] [Thread-2 (]: On model.olist_ecommerce.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_geolocation"} */
alter table "warehouse"."public"."dim_geolocation" rename to "dim_geolocation__dbt_backup"
[0m03:05:21.227116 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:21.234061 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.dim_geolocation"
[0m03:05:21.235763 [debug] [Thread-2 (]: On model.olist_ecommerce.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_geolocation"} */
alter table "warehouse"."public"."dim_geolocation__dbt_tmp" rename to "dim_geolocation"
[0m03:05:21.237741 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:21.242222 [debug] [Thread-2 (]: On model.olist_ecommerce.dim_geolocation: COMMIT
[0m03:05:21.243746 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.dim_geolocation"
[0m03:05:21.245063 [debug] [Thread-2 (]: On model.olist_ecommerce.dim_geolocation: COMMIT
[0m03:05:21.267045 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:21.279786 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.dim_geolocation"
[0m03:05:21.283633 [debug] [Thread-2 (]: On model.olist_ecommerce.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.dim_geolocation"} */
drop table if exists "warehouse"."public"."dim_geolocation__dbt_backup" cascade
[0m03:05:21.290590 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:21.294142 [debug] [Thread-2 (]: Timing info for model.olist_ecommerce.dim_geolocation (execute): 03:05:17.608205 => 03:05:21.293771
[0m03:05:21.295499 [debug] [Thread-2 (]: On model.olist_ecommerce.dim_geolocation: Close
[0m03:05:21.297600 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941b89630>]}
[0m03:05:21.299555 [info ] [Thread-2 (]: 2 of 13 OK created sql table model public.dim_geolocation ...................... [[32mSELECT 738307[0m in 3.75s]
[0m03:05:21.301720 [debug] [Thread-2 (]: Finished running node model.olist_ecommerce.dim_geolocation
[0m03:05:21.304177 [debug] [Thread-2 (]: Began running node model.olist_ecommerce.mart_payment_analysis
[0m03:05:21.306565 [info ] [Thread-2 (]: 11 of 13 START sql table model public.mart_payment_analysis .................... [RUN]
[0m03:05:21.314473 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_ecommerce.dim_geolocation, now model.olist_ecommerce.mart_payment_analysis)
[0m03:05:21.318612 [debug] [Thread-2 (]: Began compiling node model.olist_ecommerce.mart_payment_analysis
[0m03:05:21.335246 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_ecommerce.mart_payment_analysis"
[0m03:05:21.370574 [debug] [Thread-2 (]: Timing info for model.olist_ecommerce.mart_payment_analysis (compile): 03:05:21.324702 => 03:05:21.370086
[0m03:05:21.371972 [debug] [Thread-2 (]: Began executing node model.olist_ecommerce.mart_payment_analysis
[0m03:05:21.382209 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_ecommerce.mart_payment_analysis"
[0m03:05:21.401041 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m03:05:21.402708 [debug] [Thread-2 (]: On model.olist_ecommerce.mart_payment_analysis: BEGIN
[0m03:05:21.404039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:05:21.426142 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:21.427765 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m03:05:21.429449 [debug] [Thread-2 (]: On model.olist_ecommerce.mart_payment_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_payment_analysis"} */

  
    

  create  table "warehouse"."public"."mart_payment_analysis__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    fp.payment_type_clean as payment_method,
    fp.installment_category,
    COUNT(*) as transaction_count,
    COUNT(DISTINCT fp.order_id) as unique_orders,
    SUM(fp.payment_value) as total_payment_value,
    AVG(fp.payment_value) as avg_payment_value,
    AVG(fp.payment_installments) as avg_installments,
    
    -- Participação por método (com conversão ::numeric)
    ROUND((COUNT(*) * 100.0 / SUM(COUNT(*)) OVER ())::numeric, 2) as transaction_share_pct,
    ROUND((SUM(fp.payment_value) * 100.0 / SUM(SUM(fp.payment_value)) OVER ())::numeric, 2) as value_share_pct,
    
    -- Análise temporal
    DATE_TRUNC('month', fo.order_purchase_timestamp) as month_year,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."fact_payments" fp
JOIN "warehouse"."public"."fact_orders" fo ON fp.order_id = fo.order_id
WHERE fo.order_status = 'delivered'
    AND fo.order_purchase_timestamp IS NOT NULL
GROUP BY fp.payment_type_clean, fp.installment_category, DATE_TRUNC('month', fo.order_purchase_timestamp)
ORDER BY month_year DESC, total_payment_value DESC
  );
  
[0m03:05:21.633274 [debug] [Thread-1 (]: SQL status: SELECT 54 in 1.0 seconds
[0m03:05:21.642077 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m03:05:21.643748 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_delivery_performance"} */
alter table "warehouse"."public"."mart_delivery_performance" rename to "mart_delivery_performance__dbt_backup"
[0m03:05:21.645649 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:21.652171 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m03:05:21.653810 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_delivery_performance"} */
alter table "warehouse"."public"."mart_delivery_performance__dbt_tmp" rename to "mart_delivery_performance"
[0m03:05:21.656080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:21.660508 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: COMMIT
[0m03:05:21.662083 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m03:05:21.663502 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: COMMIT
[0m03:05:21.675178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:21.681178 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_delivery_performance"
[0m03:05:21.682612 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_delivery_performance"} */
drop table if exists "warehouse"."public"."mart_delivery_performance__dbt_backup" cascade
[0m03:05:21.693321 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:21.696859 [debug] [Thread-1 (]: Timing info for model.olist_ecommerce.mart_delivery_performance (execute): 03:05:20.800380 => 03:05:21.696470
[0m03:05:21.698271 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_delivery_performance: Close
[0m03:05:21.698991 [debug] [Thread-4 (]: SQL status: SELECT 105 in 1.0 seconds
[0m03:05:21.700638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941771c90>]}
[0m03:05:21.707387 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m03:05:21.709312 [info ] [Thread-1 (]: 9 of 13 OK created sql table model public.mart_delivery_performance ............ [[32mSELECT 54[0m in 0.96s]
[0m03:05:21.711541 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_customer_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_customer_analysis"} */
alter table "warehouse"."public"."mart_customer_analysis" rename to "mart_customer_analysis__dbt_backup"
[0m03:05:21.713386 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_delivery_performance
[0m03:05:21.715598 [debug] [Thread-1 (]: Began running node model.olist_ecommerce.mart_product_performance
[0m03:05:21.717239 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:21.722814 [info ] [Thread-1 (]: 12 of 13 START sql table model public.mart_product_performance ................. [RUN]
[0m03:05:21.731844 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m03:05:21.741596 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_customer_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_customer_analysis"} */
alter table "warehouse"."public"."mart_customer_analysis__dbt_tmp" rename to "mart_customer_analysis"
[0m03:05:21.743571 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:21.739595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_ecommerce.mart_delivery_performance, now model.olist_ecommerce.mart_product_performance)
[0m03:05:21.748417 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_customer_analysis: COMMIT
[0m03:05:21.750312 [debug] [Thread-1 (]: Began compiling node model.olist_ecommerce.mart_product_performance
[0m03:05:21.751762 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m03:05:21.761718 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_customer_analysis: COMMIT
[0m03:05:21.760446 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_ecommerce.mart_product_performance"
[0m03:05:21.765427 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:21.775965 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_customer_analysis"
[0m03:05:21.776877 [debug] [Thread-3 (]: SQL status: SELECT 928 in 1.0 seconds
[0m03:05:21.778521 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_customer_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_customer_analysis"} */
drop table if exists "warehouse"."public"."mart_customer_analysis__dbt_backup" cascade
[0m03:05:21.786287 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m03:05:21.789806 [debug] [Thread-3 (]: On model.olist_ecommerce.mart_geographic_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_geographic_analysis"} */
alter table "warehouse"."public"."mart_geographic_analysis" rename to "mart_geographic_analysis__dbt_backup"
[0m03:05:21.791238 [debug] [Thread-1 (]: Timing info for model.olist_ecommerce.mart_product_performance (compile): 03:05:21.753166 => 03:05:21.790512
[0m03:05:21.792178 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:21.793904 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:21.795033 [debug] [Thread-1 (]: Began executing node model.olist_ecommerce.mart_product_performance
[0m03:05:21.798621 [debug] [Thread-4 (]: Timing info for model.olist_ecommerce.mart_customer_analysis (execute): 03:05:20.789859 => 03:05:21.798205
[0m03:05:21.805175 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m03:05:21.815522 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_ecommerce.mart_product_performance"
[0m03:05:21.816749 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_customer_analysis: Close
[0m03:05:21.817991 [debug] [Thread-3 (]: On model.olist_ecommerce.mart_geographic_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_geographic_analysis"} */
alter table "warehouse"."public"."mart_geographic_analysis__dbt_tmp" rename to "mart_geographic_analysis"
[0m03:05:21.820996 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f494132a170>]}
[0m03:05:21.822980 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:21.824925 [info ] [Thread-4 (]: 8 of 13 OK created sql table model public.mart_customer_analysis ............... [[32mSELECT 105[0m in 1.09s]
[0m03:05:21.831606 [debug] [Thread-3 (]: On model.olist_ecommerce.mart_geographic_analysis: COMMIT
[0m03:05:21.833900 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m03:05:21.835479 [debug] [Thread-4 (]: Finished running node model.olist_ecommerce.mart_customer_analysis
[0m03:05:21.836806 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m03:05:21.838342 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: BEGIN
[0m03:05:21.839959 [debug] [Thread-4 (]: Began running node model.olist_ecommerce.mart_sales_summary
[0m03:05:21.841643 [debug] [Thread-3 (]: On model.olist_ecommerce.mart_geographic_analysis: COMMIT
[0m03:05:21.843029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:21.844828 [info ] [Thread-4 (]: 13 of 13 START sql table model public.mart_sales_summary ....................... [RUN]
[0m03:05:21.850275 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_ecommerce.mart_customer_analysis, now model.olist_ecommerce.mart_sales_summary)
[0m03:05:21.851127 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:21.852258 [debug] [Thread-4 (]: Began compiling node model.olist_ecommerce.mart_sales_summary
[0m03:05:21.858529 [debug] [Thread-3 (]: Using postgres connection "model.olist_ecommerce.mart_geographic_analysis"
[0m03:05:21.865984 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_ecommerce.mart_sales_summary"
[0m03:05:21.866761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:21.868022 [debug] [Thread-3 (]: On model.olist_ecommerce.mart_geographic_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_geographic_analysis"} */
drop table if exists "warehouse"."public"."mart_geographic_analysis__dbt_backup" cascade
[0m03:05:21.870278 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m03:05:21.873279 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_product_performance"} */

  
    

  create  table "warehouse"."public"."mart_product_performance__dbt_tmp"
  
  
    as
  
  (
    

WITH product_sales AS (
    SELECT 
        p.product_id,
        p.category_en as product_category,
        p.category_pt as product_category_pt,
        COUNT(foi.order_item_id) as total_sales,
        SUM(foi.price) as total_revenue,
        SUM(foi.freight_value) as total_freight,
        AVG(foi.price) as avg_price,
        AVG(p.product_weight_g) as avg_weight,
        AVG(p.product_volume_cm3) as avg_volume
    FROM "warehouse"."public"."fact_order_items" foi
    JOIN "warehouse"."public"."dim_products" p ON foi.product_id = p.product_id
    JOIN "warehouse"."public"."fact_orders" o ON foi.order_id = o.order_id
    WHERE o.order_status = 'delivered'
    GROUP BY p.product_id, p.category_en, p.category_pt
)

SELECT 
    ps.product_category,
    COUNT(ps.product_id) as unique_products,
    SUM(ps.total_sales) as total_units_sold,
    SUM(ps.total_revenue) as category_revenue,
    AVG(ps.avg_price) as avg_product_price,
    AVG(ps.avg_weight) as avg_product_weight,
    AVG(ps.avg_volume) as avg_product_volume,
    
    -- Ranking de categorias
    RANK() OVER (ORDER BY SUM(ps.total_revenue) DESC) as revenue_rank,
    RANK() OVER (ORDER BY SUM(ps.total_sales) DESC) as volume_rank,
    
    -- Participação no total (com conversão ::numeric)
    ROUND((SUM(ps.total_revenue) * 100.0 / SUM(SUM(ps.total_revenue)) OVER ())::numeric, 2) as revenue_share_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM product_sales ps
GROUP BY ps.product_category
ORDER BY category_revenue DESC
  );
  
[0m03:05:21.875177 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:21.878598 [debug] [Thread-4 (]: Timing info for model.olist_ecommerce.mart_sales_summary (compile): 03:05:21.859508 => 03:05:21.878054
[0m03:05:21.881802 [debug] [Thread-3 (]: Timing info for model.olist_ecommerce.mart_geographic_analysis (execute): 03:05:20.779973 => 03:05:21.881515
[0m03:05:21.883187 [debug] [Thread-4 (]: Began executing node model.olist_ecommerce.mart_sales_summary
[0m03:05:21.884691 [debug] [Thread-3 (]: On model.olist_ecommerce.mart_geographic_analysis: Close
[0m03:05:21.896106 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_ecommerce.mart_sales_summary"
[0m03:05:21.898044 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49417dc610>]}
[0m03:05:21.900894 [info ] [Thread-3 (]: 10 of 13 OK created sql table model public.mart_geographic_analysis ............ [[32mSELECT 928[0m in 1.16s]
[0m03:05:21.904343 [debug] [Thread-3 (]: Finished running node model.olist_ecommerce.mart_geographic_analysis
[0m03:05:21.914082 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m03:05:21.915468 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_sales_summary: BEGIN
[0m03:05:21.916739 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:05:21.930879 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m03:05:21.933069 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m03:05:21.934731 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_sales_summary"} */

  
    

  create  table "warehouse"."public"."mart_sales_summary__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    DATE_TRUNC('month', order_purchase_timestamp) as month_year,
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT customer_id) as unique_customers,
    SUM(total_order_value) as total_revenue,
    AVG(total_order_value) as avg_order_value,
    SUM(total_items) as total_items_sold,
    AVG(delivery_days_actual) as avg_delivery_days,
    
    -- Métricas de crescimento
    LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) as prev_month_orders,
    LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) as prev_month_revenue,
    
    -- Calcular crescimento percentual (com conversão ::numeric)
    CASE 
        WHEN LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) > 0
        THEN ROUND(((COUNT(DISTINCT order_id) - LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))) * 100.0 / LAG(COUNT(DISTINCT order_id)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)))::numeric, 2)
        ELSE NULL
    END as orders_growth_pct,
    
    CASE 
        WHEN LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)) > 0
        THEN ROUND(((SUM(total_order_value) - LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp))) * 100.0 / LAG(SUM(total_order_value)) OVER (ORDER BY DATE_TRUNC('month', order_purchase_timestamp)))::numeric, 2)
        ELSE NULL
    END as revenue_growth_pct,
    
    CURRENT_TIMESTAMP as created_at
FROM "warehouse"."public"."fact_orders"
WHERE order_status = 'delivered'
    AND order_purchase_timestamp IS NOT NULL
GROUP BY DATE_TRUNC('month', order_purchase_timestamp)
ORDER BY month_year
  );
  
[0m03:05:22.200080 [debug] [Thread-2 (]: SQL status: SELECT 148 in 1.0 seconds
[0m03:05:22.207360 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m03:05:22.209043 [debug] [Thread-2 (]: On model.olist_ecommerce.mart_payment_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_payment_analysis"} */
alter table "warehouse"."public"."mart_payment_analysis" rename to "mart_payment_analysis__dbt_backup"
[0m03:05:22.211559 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:22.218391 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m03:05:22.220206 [debug] [Thread-2 (]: On model.olist_ecommerce.mart_payment_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_payment_analysis"} */
alter table "warehouse"."public"."mart_payment_analysis__dbt_tmp" rename to "mart_payment_analysis"
[0m03:05:22.222349 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:22.227016 [debug] [Thread-2 (]: On model.olist_ecommerce.mart_payment_analysis: COMMIT
[0m03:05:22.228837 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m03:05:22.230733 [debug] [Thread-2 (]: On model.olist_ecommerce.mart_payment_analysis: COMMIT
[0m03:05:22.233895 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:22.240618 [debug] [Thread-2 (]: Using postgres connection "model.olist_ecommerce.mart_payment_analysis"
[0m03:05:22.242334 [debug] [Thread-2 (]: On model.olist_ecommerce.mart_payment_analysis: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_payment_analysis"} */
drop table if exists "warehouse"."public"."mart_payment_analysis__dbt_backup" cascade
[0m03:05:22.246112 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:22.249767 [debug] [Thread-2 (]: Timing info for model.olist_ecommerce.mart_payment_analysis (execute): 03:05:21.373292 => 03:05:22.249347
[0m03:05:22.251461 [debug] [Thread-2 (]: On model.olist_ecommerce.mart_payment_analysis: Close
[0m03:05:22.253860 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941bb3fa0>]}
[0m03:05:22.259791 [info ] [Thread-2 (]: 11 of 13 OK created sql table model public.mart_payment_analysis ............... [[32mSELECT 148[0m in 0.94s]
[0m03:05:22.262098 [debug] [Thread-2 (]: Finished running node model.olist_ecommerce.mart_payment_analysis
[0m03:05:22.589526 [debug] [Thread-4 (]: SQL status: SELECT 23 in 1.0 seconds
[0m03:05:22.594895 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m03:05:22.596216 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_sales_summary"} */
alter table "warehouse"."public"."mart_sales_summary" rename to "mart_sales_summary__dbt_backup"
[0m03:05:22.597886 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:22.605145 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m03:05:22.606519 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_sales_summary"} */
alter table "warehouse"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m03:05:22.608192 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:22.611717 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_sales_summary: COMMIT
[0m03:05:22.613046 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m03:05:22.614229 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_sales_summary: COMMIT
[0m03:05:22.616865 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:22.677418 [debug] [Thread-4 (]: Using postgres connection "model.olist_ecommerce.mart_sales_summary"
[0m03:05:22.678858 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_sales_summary"} */
drop table if exists "warehouse"."public"."mart_sales_summary__dbt_backup" cascade
[0m03:05:22.682399 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:22.685007 [debug] [Thread-4 (]: Timing info for model.olist_ecommerce.mart_sales_summary (execute): 03:05:21.885757 => 03:05:22.684754
[0m03:05:22.686238 [debug] [Thread-4 (]: On model.olist_ecommerce.mart_sales_summary: Close
[0m03:05:22.688188 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f494135dae0>]}
[0m03:05:22.690408 [info ] [Thread-4 (]: 13 of 13 OK created sql table model public.mart_sales_summary .................. [[32mSELECT 23[0m in 0.84s]
[0m03:05:22.692753 [debug] [Thread-4 (]: Finished running node model.olist_ecommerce.mart_sales_summary
[0m03:05:23.458081 [debug] [Thread-1 (]: SQL status: SELECT 72 in 2.0 seconds
[0m03:05:23.462864 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m03:05:23.464295 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_product_performance"} */
alter table "warehouse"."public"."mart_product_performance" rename to "mart_product_performance__dbt_backup"
[0m03:05:23.466076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:23.470871 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m03:05:23.472244 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_product_performance"} */
alter table "warehouse"."public"."mart_product_performance__dbt_tmp" rename to "mart_product_performance"
[0m03:05:23.474168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:05:23.477741 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: COMMIT
[0m03:05:23.479029 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m03:05:23.480188 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: COMMIT
[0m03:05:23.482739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:05:23.487168 [debug] [Thread-1 (]: Using postgres connection "model.olist_ecommerce.mart_product_performance"
[0m03:05:23.488415 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "olist_ecommerce", "target_name": "dev", "node_id": "model.olist_ecommerce.mart_product_performance"} */
drop table if exists "warehouse"."public"."mart_product_performance__dbt_backup" cascade
[0m03:05:23.491957 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:05:23.494565 [debug] [Thread-1 (]: Timing info for model.olist_ecommerce.mart_product_performance (execute): 03:05:21.806113 => 03:05:23.494289
[0m03:05:23.495773 [debug] [Thread-1 (]: On model.olist_ecommerce.mart_product_performance: Close
[0m03:05:23.497414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f75ac31-5363-4ef0-995d-66110a686395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941762500>]}
[0m03:05:23.498989 [info ] [Thread-1 (]: 12 of 13 OK created sql table model public.mart_product_performance ............ [[32mSELECT 72[0m in 1.76s]
[0m03:05:23.501345 [debug] [Thread-1 (]: Finished running node model.olist_ecommerce.mart_product_performance
[0m03:05:23.510679 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:23.511920 [debug] [MainThread]: On master: BEGIN
[0m03:05:23.515344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:05:23.531326 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:05:23.532815 [debug] [MainThread]: On master: COMMIT
[0m03:05:23.534035 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:23.535333 [debug] [MainThread]: On master: COMMIT
[0m03:05:23.537056 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:05:23.539053 [debug] [MainThread]: On master: Close
[0m03:05:23.541211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:23.543058 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_product_performance' was properly closed.
[0m03:05:23.544592 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_payment_analysis' was properly closed.
[0m03:05:23.546002 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_geographic_analysis' was properly closed.
[0m03:05:23.548549 [debug] [MainThread]: Connection 'model.olist_ecommerce.mart_sales_summary' was properly closed.
[0m03:05:23.549938 [info ] [MainThread]: 
[0m03:05:23.552174 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 6.20 seconds (6.20s).
[0m03:05:23.559960 [debug] [MainThread]: Command end result
[0m03:05:23.620429 [info ] [MainThread]: 
[0m03:05:23.624577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:05:23.627453 [info ] [MainThread]: 
[0m03:05:23.629545 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m03:05:23.632011 [debug] [MainThread]: Command `dbt run` succeeded at 03:05:23.631734 after 8.43 seconds
[0m03:05:23.633717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49457f9720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4941762500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f494170aef0>]}
[0m03:05:23.635450 [debug] [MainThread]: Flushing usage events
[0m03:23:59.951336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe673ec9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6708ff1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6708ff160>]}


============================== 03:23:59.958180 | a846316d-8dc0-4609-8d0b-df1f3b3066fa ==============================
[0m03:23:59.958180 [info ] [MainThread]: Running with dbt=1.6.0
[0m03:23:59.959680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models silver', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:24:00.181112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a846316d-8dc0-4609-8d0b-df1f3b3066fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6708f9000>]}
[0m03:24:00.209174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a846316d-8dc0-4609-8d0b-df1f3b3066fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6708db310>]}
[0m03:24:00.211457 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m03:24:00.230284 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m03:24:00.454414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:24:00.456537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:24:00.459336 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
[0m03:24:00.471575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a846316d-8dc0-4609-8d0b-df1f3b3066fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66eed8220>]}
[0m03:24:00.507463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a846316d-8dc0-4609-8d0b-df1f3b3066fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66ee8ebc0>]}
[0m03:24:00.508682 [info ] [MainThread]: Found 13 models, 9 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m03:24:00.509860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a846316d-8dc0-4609-8d0b-df1f3b3066fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66eea00d0>]}
[0m03:24:00.511354 [warn ] [MainThread]: The selection criterion 'silver' does not match any nodes
[0m03:24:00.513509 [info ] [MainThread]: 
[0m03:24:00.514846 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:24:00.516265 [debug] [MainThread]: Command end result
[0m03:24:00.535873 [debug] [MainThread]: Command `dbt run` succeeded at 03:24:00.535620 after 0.61 seconds
[0m03:24:00.537100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe673ec9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66eea0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe66eea00a0>]}
[0m03:24:00.538356 [debug] [MainThread]: Flushing usage events
[0m03:24:07.283994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08939e1420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f089048b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f089048b160>]}


============================== 03:24:07.291186 | d2b6d89d-8fbe-4401-a8c0-f26c834a5e4c ==============================
[0m03:24:07.291186 [info ] [MainThread]: Running with dbt=1.6.0
[0m03:24:07.293332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models gold', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:24:07.511537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2b6d89d-8fbe-4401-a8c0-f26c834a5e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08924683d0>]}
[0m03:24:07.558049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2b6d89d-8fbe-4401-a8c0-f26c834a5e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0890486800>]}
[0m03:24:07.562364 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m03:24:07.583771 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m03:24:07.776775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:24:07.779449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:24:07.781614 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.silver
- models.olist_ecommerce.bronze
[0m03:24:07.791701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2b6d89d-8fbe-4401-a8c0-f26c834a5e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088ea64130>]}
[0m03:24:07.825429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2b6d89d-8fbe-4401-a8c0-f26c834a5e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088ea1afb0>]}
[0m03:24:07.826654 [info ] [MainThread]: Found 13 models, 9 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m03:24:07.827838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b6d89d-8fbe-4401-a8c0-f26c834a5e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088ea2c160>]}
[0m03:24:07.829246 [warn ] [MainThread]: The selection criterion 'gold' does not match any nodes
[0m03:24:07.831269 [info ] [MainThread]: 
[0m03:24:07.832610 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:24:07.834066 [debug] [MainThread]: Command end result
[0m03:24:07.855102 [debug] [MainThread]: Command `dbt run` succeeded at 03:24:07.854847 after 0.60 seconds
[0m03:24:07.856284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08939e1420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088ea2c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f088ea2c1f0>]}
[0m03:24:07.857506 [debug] [MainThread]: Flushing usage events
[0m06:00:08.925105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edf6eb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edc0cc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edc0cc970>]}


============================== 06:00:08.931604 | 757a4c03-d454-42da-ab6f-7ac6d5296304 ==============================
[0m06:00:08.931604 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:00:08.933486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models silver', 'send_anonymous_usage_stats': 'True'}
[0m06:00:09.090085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '757a4c03-d454-42da-ab6f-7ac6d5296304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eddbe12d0>]}
[0m06:00:09.121926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '757a4c03-d454-42da-ab6f-7ac6d5296304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edc113670>]}
[0m06:00:09.123836 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m06:00:09.147337 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:00:09.377522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:09.378683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:09.380868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.gold
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
[0m06:00:09.393363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '757a4c03-d454-42da-ab6f-7ac6d5296304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda6e81f0>]}
[0m06:00:09.425406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '757a4c03-d454-42da-ab6f-7ac6d5296304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda69f070>]}
[0m06:00:09.426919 [info ] [MainThread]: Found 13 models, 9 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m06:00:09.428241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '757a4c03-d454-42da-ab6f-7ac6d5296304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda6b00a0>]}
[0m06:00:09.429725 [warn ] [MainThread]: The selection criterion 'silver' does not match any nodes
[0m06:00:09.431990 [info ] [MainThread]: 
[0m06:00:09.433297 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:00:09.434868 [debug] [MainThread]: Command end result
[0m06:00:09.454759 [debug] [MainThread]: Command `dbt run` succeeded at 06:00:09.454490 after 0.55 seconds
[0m06:00:09.456213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edf6eb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda6b01c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eda6b0280>]}
[0m06:00:09.457579 [debug] [MainThread]: Flushing usage events
[0m06:00:16.416564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ceb759cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce82031f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce8203160>]}


============================== 06:00:16.422848 | 0e1477a2-11a2-46ba-9008-3a56c0986a3b ==============================
[0m06:00:16.422848 [info ] [MainThread]: Running with dbt=1.6.0
[0m06:00:16.424470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models gold', 'send_anonymous_usage_stats': 'True'}
[0m06:00:16.564361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e1477a2-11a2-46ba-9008-3a56c0986a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce81fd000>]}
[0m06:00:16.591109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e1477a2-11a2-46ba-9008-3a56c0986a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce81df310>]}
[0m06:00:16.592718 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m06:00:16.611152 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m06:00:16.804330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:00:16.805834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:00:16.807922 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.olist_ecommerce.bronze
- models.olist_ecommerce.silver
- models.olist_ecommerce.gold
[0m06:00:16.817171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e1477a2-11a2-46ba-9008-3a56c0986a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce67d8220>]}
[0m06:00:16.858483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e1477a2-11a2-46ba-9008-3a56c0986a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce678ebc0>]}
[0m06:00:16.860449 [info ] [MainThread]: Found 13 models, 9 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m06:00:16.862341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1477a2-11a2-46ba-9008-3a56c0986a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce67a00d0>]}
[0m06:00:16.865024 [warn ] [MainThread]: The selection criterion 'gold' does not match any nodes
[0m06:00:16.869937 [info ] [MainThread]: 
[0m06:00:16.875916 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:00:16.881000 [debug] [MainThread]: Command end result
[0m06:00:16.972958 [debug] [MainThread]: Command `dbt run` succeeded at 06:00:16.972667 after 0.58 seconds
[0m06:00:16.979396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ceb759cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce67a0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ce67a00a0>]}
[0m06:00:16.981556 [debug] [MainThread]: Flushing usage events
